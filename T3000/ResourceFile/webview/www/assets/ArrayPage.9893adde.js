import{j as e}from"./react.1acd1a13.js";import{r as s,R as r}from"./client.58f92968.js";import{l as t,M as a,n as l,T as i,y as o,N as n,z as d,P as x,Q as c,I as p,S as h}from"./App.3fe38e41.js";import{c as j,D as m,a as f,b as u,d as _,e as g,f as v}from"./DataGridHeaderCell.f7016832.js";import{T as b}from"./TableCellLayout.9e29eb07.js";import"./index.2479820c.js";import"./Serializer.f6a5f515.js";import"./T3Data.5fdf3c76.js";import"./_commonjsHelpers.a5007c1f.js";var y="_container_jieqz_18",C="_bladeContentContainer_jieqz_30",z="_bladeContentWrapper_jieqz_38",N="_bladeContent_jieqz_30",S="_partContent_jieqz_54",q="_toolbar_jieqz_63",I="_toolbarContainer_jieqz_72",w="_toolbarButton_jieqz_80",W="_toolbarSeparator_jieqz_119",k="_searchInputWrapper_jieqz_127",H="_searchIcon_jieqz_134",D="_searchInput_jieqz_127",E="_overviewHr_jieqz_194",R="_dockingBody_jieqz_202",T="_noData_jieqz_212",A="_loadingBar_jieqz_221";var $=()=>{const{selectedDevice:$,treeData:B,selectDevice:F}=t(),[L,V]=s.exports.useState([]),[M,O]=s.exports.useState(!1),[P,G]=s.exports.useState(null);s.exports.useEffect((()=>{if(!$&&B.length>0){const e=s=>{for(const r of s){if(r.data)return r;if(r.children&&r.children.length>0){const s=e(r.children);if(s)return s}}return null},s=e(B);(null==s?void 0:s.data)&&F(s.data)}}),[$,B,F]);const Q=s.exports.useCallback((async()=>{if($){O(!0),G(null);try{const e=await fetch(`${a}/api/t3_device/devices/${$.serialNumber}/table/ARRAYS`);if(!e.ok)throw new Error(`Failed to fetch arrays: ${e.statusText}`);const s=await e.json();V(s.data||[])}catch(e){const s=e instanceof Error?e.message:"Failed to load arrays";G(s)}finally{O(!1)}}else V([])}),[$]);s.exports.useEffect((()=>{Q()}),[Q]);const[Y,J]=s.exports.useState(""),K=r.useMemo((()=>0===L.length?Array(10).fill(null).map(((e,s)=>({item:"",array_name:"",length:"",value:""}))):L),[L]),U=e=>!e.item&&0===L.length,X=s.exports.useMemo((()=>[j({columnId:"item",renderHeaderCell:()=>e.exports.jsx("span",{children:"Item#"}),renderCell:s=>e.exports.jsx(b,{children:!U(s)&&s.item})}),j({columnId:"array_name",renderHeaderCell:()=>e.exports.jsx("span",{children:"Array Name"}),renderCell:s=>e.exports.jsx(b,{children:!U(s)&&s.array_name})}),j({columnId:"length",renderHeaderCell:()=>e.exports.jsx("span",{children:"Length"}),renderCell:s=>e.exports.jsx(b,{children:!U(s)&&s.length})}),j({columnId:"value",renderHeaderCell:()=>e.exports.jsx("span",{children:"Value"}),renderCell:s=>e.exports.jsx(b,{children:!U(s)&&s.value})})]),[]);return e.exports.jsx("div",{className:y,children:e.exports.jsx("div",{className:C,children:e.exports.jsx("div",{className:z,children:e.exports.jsx("div",{className:N,children:e.exports.jsxs("div",{className:S,children:[P&&e.exports.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",backgroundColor:"#fef6f6",borderRadius:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.exports.jsx(l,{style:{color:"#d13438",fontSize:"16px",flexShrink:0}}),e.exports.jsx(i,{style:{color:"#d13438",fontWeight:500,fontSize:"13px"},children:P})]}),$&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:q,children:e.exports.jsxs("div",{className:I,children:[e.exports.jsxs("button",{className:w,onClick:()=>{Q()},disabled:M,title:"Refresh","aria-label":"Refresh",children:[e.exports.jsx(o,{}),e.exports.jsx("span",{children:"Refresh"})]}),e.exports.jsxs("button",{className:w,onClick:()=>{},title:"Export to CSV","aria-label":"Export to CSV",children:[e.exports.jsx(n,{}),e.exports.jsx("span",{children:"Export to CSV"})]}),e.exports.jsx("div",{className:W,role:"separator"}),e.exports.jsxs("button",{className:w,onClick:()=>{},title:"Settings","aria-label":"Settings",children:[e.exports.jsx(d,{}),e.exports.jsx("span",{children:"Settings"})]}),e.exports.jsxs("div",{className:k,children:[e.exports.jsx(x,{className:H}),e.exports.jsx("input",{className:D,type:"text",placeholder:"Search arrays...",value:Y,onChange:e=>{J(e.target.value)},spellCheck:"false",role:"searchbox","aria-label":"Search arrays"})]}),$&&e.exports.jsx(c,{content:`Showing arrays for ${$.nameShowOnTree} (SN: ${$.serialNumber}). This table displays all configured array variables for the device.`,relationship:"description",children:e.exports.jsx("button",{className:w,style:{marginLeft:"8px"},title:"Information","aria-label":"Information about this page",children:e.exports.jsx(p,{})})})]})}),e.exports.jsx("div",{style:{padding:"0"},children:e.exports.jsx("hr",{className:E})})]}),e.exports.jsxs("div",{className:R,children:[M&&0===L.length&&e.exports.jsxs("div",{className:A,children:[e.exports.jsx(h,{size:"tiny"}),e.exports.jsx(i,{size:200,weight:"regular",children:"Loading arrays..."})]}),!$&&!M&&e.exports.jsx("div",{className:T,children:e.exports.jsxs("div",{style:{textAlign:"center"},children:[e.exports.jsx(i,{size:400,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(i,{size:200,children:"Please select a device from the tree to view arrays"})]})}),$&&!M&&e.exports.jsx(e.exports.Fragment,{children:e.exports.jsxs(m,{items:K,columns:X,sortable:!0,resizableColumns:!0,columnSizingOptions:{item:{minWidth:60,defaultWidth:80},array_name:{minWidth:180,defaultWidth:250},length:{minWidth:80,defaultWidth:100},value:{minWidth:120,defaultWidth:180}},children:[e.exports.jsx(f,{children:e.exports.jsx(u,{children:({renderHeaderCell:s})=>e.exports.jsx(_,{children:s()})})}),e.exports.jsx(g,{children:({item:s,rowId:r})=>e.exports.jsx(u,{children:({renderCell:r})=>e.exports.jsx(v,{children:r(s)})},r)})]})})]})]})})})})})};export{$ as default};

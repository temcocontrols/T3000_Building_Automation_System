import{j as e}from"./react.2da10d74.js";import{r as s}from"./client.b9d1bbf8.js";import{w as r,A as t,x as a,T as l,y as o,z as i,S as n,C as d,D as x,I as c,F as p}from"./App.2c62e2d1.js";import{c as h,D as m,a as j,b as u,d as f,e as _,f as g,T as v}from"./DataGridHeaderCell.34491fc4.js";import"./index.5672de35.js";import"./Serializer.f6a5f515.js";import"./useFocusableGroup.6d334b5b.js";var b="_container_1642z_35",y="_bladeContentContainer_1642z_59",z="_bladeContentWrapper_1642z_75",C="_bladeContent_1642z_59",N="_partContent_1642z_107",S="_toolbar_1642z_125",w="_toolbarContainer_1642z_143",I="_toolbarButton_1642z_159",W="_toolbarSeparator_1642z_237",k="_searchInputWrapper_1642z_253",A="_searchIcon_1642z_267",H="_searchInput_1642z_253",B="_overviewHr_1642z_387",E="_dockingBody_1642z_403",T="_noData_1642z_423",D="_loadingBar_1642z_441";var R=()=>{const{selectedDevice:R,treeData:V,selectDevice:F}=r(),[$,L]=s.exports.useState([]),[M,G]=s.exports.useState(!1),[O,P]=s.exports.useState(null);s.exports.useEffect((()=>{if(!R&&V.length>0){const e=s=>{for(const r of s){if(r.data)return r;if(r.children&&r.children.length>0){const s=e(r.children);if(s)return s}}return null},s=e(V);(null==s?void 0:s.data)&&F(s.data)}}),[R,V,F]);const Y=s.exports.useCallback((async()=>{if(R){G(!0),P(null);try{const e=await fetch(`${t}/api/t3_device/devices/${R.serialNumber}/table/ARRAY_TABLE`);if(!e.ok)throw new Error(`Failed to fetch arrays: ${e.statusText}`);const s=await e.json();L(s.data||[])}catch(e){const s=e instanceof Error?e.message:"Failed to load arrays";P(s)}finally{G(!1)}}else L([])}),[R]);s.exports.useEffect((()=>{Y()}),[Y]);const[q,J]=s.exports.useState(""),K=s.exports.useMemo((()=>[h({columnId:"item",renderHeaderCell:()=>e.exports.jsx("span",{children:"Item#"}),renderCell:s=>e.exports.jsx(v,{children:s.item})}),h({columnId:"array_name",renderHeaderCell:()=>e.exports.jsx("span",{children:"Array Name"}),renderCell:s=>e.exports.jsx(v,{children:s.array_name})}),h({columnId:"length",renderHeaderCell:()=>e.exports.jsx("span",{children:"Length"}),renderCell:s=>e.exports.jsx(v,{children:s.length})}),h({columnId:"value",renderHeaderCell:()=>e.exports.jsx("span",{children:"Value"}),renderCell:s=>e.exports.jsx(v,{children:s.value})})]),[]);return e.exports.jsx("div",{className:b,children:e.exports.jsx("div",{className:y,children:e.exports.jsx("div",{className:z,children:e.exports.jsx("div",{className:C,children:e.exports.jsxs("div",{className:N,children:[O&&e.exports.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",backgroundColor:"#fef6f6",borderRadius:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.exports.jsx(a,{style:{color:"#d13438",fontSize:"16px",flexShrink:0}}),e.exports.jsx(l,{style:{color:"#d13438",fontWeight:500,fontSize:"13px"},children:O})]}),R&&e.exports.jsx("div",{className:S,children:e.exports.jsxs("div",{className:w,children:[e.exports.jsxs("button",{className:I,onClick:()=>{Y()},disabled:M,title:"Refresh","aria-label":"Refresh",children:[e.exports.jsx(o,{}),e.exports.jsx("span",{children:"Refresh"})]}),e.exports.jsxs("button",{className:I,onClick:()=>{},title:"Export to CSV","aria-label":"Export to CSV",children:[e.exports.jsx(i,{}),e.exports.jsx("span",{children:"Export to CSV"})]}),e.exports.jsx("div",{className:W,role:"separator"}),e.exports.jsxs("button",{className:I,onClick:()=>{},title:"Settings","aria-label":"Settings",children:[e.exports.jsx(n,{}),e.exports.jsx("span",{children:"Settings"})]}),e.exports.jsxs("div",{className:k,children:[e.exports.jsx(d,{className:A}),e.exports.jsx("input",{className:H,type:"text",placeholder:"Search arrays...",value:q,onChange:e=>{J(e.target.value)},spellCheck:"false",role:"searchbox","aria-label":"Search arrays"})]}),R&&e.exports.jsx(x,{content:`Showing arrays for ${R.nameShowOnTree} (SN: ${R.serialNumber}). This table displays all configured array variables for the device.`,relationship:"description",children:e.exports.jsx("button",{className:I,style:{marginLeft:"8px"},title:"Information","aria-label":"Information about this page",children:e.exports.jsx(c,{})})})]})}),e.exports.jsx("div",{style:{padding:"0"},children:e.exports.jsx("hr",{className:B})}),e.exports.jsxs("div",{className:E,children:[M&&0===$.length&&e.exports.jsxs("div",{className:D,children:[e.exports.jsx(p,{size:"tiny"}),e.exports.jsx(l,{size:200,weight:"regular",children:"Loading arrays..."})]}),!R&&!M&&e.exports.jsx("div",{className:T,children:e.exports.jsxs("div",{style:{textAlign:"center"},children:[e.exports.jsx(l,{size:500,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(l,{size:300,children:"Please select a device from the tree to view arrays"})]})}),R&&!M&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsxs(m,{items:$,columns:K,sortable:!0,resizableColumns:!0,columnSizingOptions:{item:{minWidth:60,defaultWidth:80},array_name:{minWidth:180,defaultWidth:250},length:{minWidth:80,defaultWidth:100},value:{minWidth:120,defaultWidth:180}},children:[e.exports.jsx(j,{children:e.exports.jsx(u,{children:({renderHeaderCell:s})=>e.exports.jsx(f,{children:s()})})}),e.exports.jsx(_,{children:({item:s,rowId:r})=>e.exports.jsx(u,{children:({renderCell:r})=>e.exports.jsx(g,{children:r(s)})},r)})]}),0===$.length&&e.exports.jsxs("div",{style:{marginTop:"24px",textAlign:"center",padding:"0 20px"},children:[e.exports.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginBottom:"8px"},children:[e.exports.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{opacity:.5},children:e.exports.jsx("path",{d:"M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8z",fill:"currentColor"})}),e.exports.jsx(l,{size:400,weight:"semibold",children:"No arrays found"})]}),e.exports.jsx(l,{size:300,style:{display:"block",marginBottom:"16px",color:"#605e5c",textAlign:"center"},children:"This device has no configured array variables"})]})]})]})]})})})})})};export{R as default};

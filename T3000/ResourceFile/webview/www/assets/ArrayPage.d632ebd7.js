import{j as e}from"./react.3bc90b5d.js";import{r as s,R as r}from"./client.58f92968.js";import{u as t,M as a,E as l,T as o,h as i,N as n,i as d,P as x,Q as p,I as c,S as h}from"./App.4ea21eda.js";import{c as m,D as j,a as u,b as f,d as _,e as g,f as b}from"./DataGridHeaderCell.c083631d.js";import{T as v}from"./TableCellLayout.777c5080.js";import"./index.f111124c.js";import"./Serializer.f6a5f515.js";import"./axios.65f6a2c9.js";import"./T3Data.f6c34e59.js";import"./_commonjsHelpers.a5007c1f.js";var y="_container_74p6w_35",C="_bladeContentContainer_74p6w_59",w="_bladeContentWrapper_74p6w_75",N="_bladeContent_74p6w_59",S="_partContent_74p6w_107",I="_toolbar_74p6w_125",W="_toolbarContainer_74p6w_143",k="_toolbarButton_74p6w_159",z="_toolbarSeparator_74p6w_237",E="_searchInputWrapper_74p6w_253",H="_searchIcon_74p6w_267",D="_searchInput_74p6w_253",R="_overviewHr_74p6w_387",T="_dockingBody_74p6w_403",A="_noData_74p6w_423",$="_loadingBar_74p6w_441";var B=()=>{const{selectedDevice:B,treeData:F,selectDevice:L}=t(),[V,M]=s.exports.useState([]),[O,P]=s.exports.useState(!1),[G,Q]=s.exports.useState(null);s.exports.useEffect((()=>{if(!B&&F.length>0){const e=s=>{for(const r of s){if(r.data)return r;if(r.children&&r.children.length>0){const s=e(r.children);if(s)return s}}return null},s=e(F);(null==s?void 0:s.data)&&L(s.data)}}),[B,F,L]);const Y=s.exports.useCallback((async()=>{if(B){P(!0),Q(null);try{const e=await fetch(`${a}/api/t3_device/devices/${B.serialNumber}/table/ARRAYS`);if(!e.ok)throw new Error(`Failed to fetch arrays: ${e.statusText}`);const s=await e.json();M(s.data||[])}catch(e){const s=e instanceof Error?e.message:"Failed to load arrays";Q(s)}finally{P(!1)}}else M([])}),[B]);s.exports.useEffect((()=>{Y()}),[Y]);const[q,J]=s.exports.useState(""),K=r.useMemo((()=>0===V.length?Array(10).fill(null).map(((e,s)=>({item:"",array_name:"",length:"",value:""}))):V),[V]),U=e=>!e.item&&0===V.length,X=s.exports.useMemo((()=>[m({columnId:"item",renderHeaderCell:()=>e.exports.jsx("span",{children:"Item#"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.item})}),m({columnId:"array_name",renderHeaderCell:()=>e.exports.jsx("span",{children:"Array Name"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.array_name})}),m({columnId:"length",renderHeaderCell:()=>e.exports.jsx("span",{children:"Length"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.length})}),m({columnId:"value",renderHeaderCell:()=>e.exports.jsx("span",{children:"Value"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.value})})]),[]);return e.exports.jsx("div",{className:y,children:e.exports.jsx("div",{className:C,children:e.exports.jsx("div",{className:w,children:e.exports.jsx("div",{className:N,children:e.exports.jsxs("div",{className:S,children:[G&&e.exports.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",backgroundColor:"#fef6f6",borderRadius:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.exports.jsx(l,{style:{color:"#d13438",fontSize:"16px",flexShrink:0}}),e.exports.jsx(o,{style:{color:"#d13438",fontWeight:500,fontSize:"13px"},children:G})]}),B&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:I,children:e.exports.jsxs("div",{className:W,children:[e.exports.jsxs("button",{className:k,onClick:()=>{Y()},disabled:O,title:"Refresh","aria-label":"Refresh",children:[e.exports.jsx(i,{}),e.exports.jsx("span",{children:"Refresh"})]}),e.exports.jsxs("button",{className:k,onClick:()=>{},title:"Export to CSV","aria-label":"Export to CSV",children:[e.exports.jsx(n,{}),e.exports.jsx("span",{children:"Export to CSV"})]}),e.exports.jsx("div",{className:z,role:"separator"}),e.exports.jsxs("button",{className:k,onClick:()=>{},title:"Settings","aria-label":"Settings",children:[e.exports.jsx(d,{}),e.exports.jsx("span",{children:"Settings"})]}),e.exports.jsxs("div",{className:E,children:[e.exports.jsx(x,{className:H}),e.exports.jsx("input",{className:D,type:"text",placeholder:"Search arrays...",value:q,onChange:e=>{J(e.target.value)},spellCheck:"false",role:"searchbox","aria-label":"Search arrays"})]}),B&&e.exports.jsx(p,{content:`Showing arrays for ${B.nameShowOnTree} (SN: ${B.serialNumber}). This table displays all configured array variables for the device.`,relationship:"description",children:e.exports.jsx("button",{className:k,style:{marginLeft:"8px"},title:"Information","aria-label":"Information about this page",children:e.exports.jsx(c,{})})})]})}),e.exports.jsx("div",{style:{padding:"0"},children:e.exports.jsx("hr",{className:R})})]}),e.exports.jsxs("div",{className:T,children:[O&&0===V.length&&e.exports.jsxs("div",{className:$,children:[e.exports.jsx(h,{size:"tiny"}),e.exports.jsx(o,{size:200,weight:"regular",children:"Loading arrays..."})]}),!B&&!O&&e.exports.jsx("div",{className:A,children:e.exports.jsxs("div",{style:{textAlign:"center"},children:[e.exports.jsx(o,{size:400,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(o,{size:200,children:"Please select a device from the tree to view arrays"})]})}),B&&!O&&e.exports.jsx(e.exports.Fragment,{children:e.exports.jsxs(j,{items:K,columns:X,sortable:!0,resizableColumns:!0,columnSizingOptions:{item:{minWidth:60,defaultWidth:80},array_name:{minWidth:180,defaultWidth:250},length:{minWidth:80,defaultWidth:100},value:{minWidth:120,defaultWidth:180}},children:[e.exports.jsx(u,{children:e.exports.jsx(f,{children:({renderHeaderCell:s})=>e.exports.jsx(_,{children:s()})})}),e.exports.jsx(g,{children:({item:s,rowId:r})=>e.exports.jsx(f,{children:({renderCell:r})=>e.exports.jsx(b,{children:r(s)})},r)})]})})]})]})})})})})};export{B as default};

import{j as e}from"./react.8639cc86.js";import{r as s,R as r}from"./client.58f92968.js";import{l as t,M as a,n as l,T as o,y as i,N as n,z as d,P as c,Q as x,I as p,S as h}from"./App.7c34790a.js";import{c as j,D as m,a as f,b as u,d as _,e as g,f as b}from"./DataGridHeaderCell.ec45a911.js";import{T as v}from"./TableCellLayout.d4b0b796.js";import"./index.3bd6c859.js";import"./Serializer.f6a5f515.js";import"./axios.65f6a2c9.js";import"./T3Data.63f93fe7.js";import"./_commonjsHelpers.a5007c1f.js";var y="_container_jieqz_18",C="_bladeContentContainer_jieqz_30",z="_bladeContentWrapper_jieqz_38",N="_bladeContent_jieqz_30",S="_partContent_jieqz_54",q="_toolbar_jieqz_63",I="_toolbarContainer_jieqz_72",w="_toolbarButton_jieqz_80",W="_toolbarSeparator_jieqz_119",k="_searchInputWrapper_jieqz_127",E="_searchIcon_jieqz_134",H="_searchInput_jieqz_127",D="_overviewHr_jieqz_194",R="_dockingBody_jieqz_202",T="_noData_jieqz_212",A="_loadingBar_jieqz_221";var V=()=>{const{selectedDevice:V,treeData:$,selectDevice:B}=t(),[F,L]=s.exports.useState([]),[M,O]=s.exports.useState(!1),[P,G]=s.exports.useState(null);s.exports.useEffect((()=>{if(!V&&$.length>0){const e=s=>{for(const r of s){if(r.data)return r;if(r.children&&r.children.length>0){const s=e(r.children);if(s)return s}}return null},s=e($);(null==s?void 0:s.data)&&B(s.data)}}),[V,$,B]);const Q=s.exports.useCallback((async()=>{if(V){O(!0),G(null);try{const e=await fetch(`${a}/api/t3_device/devices/${V.serialNumber}/table/ARRAYS`);if(!e.ok)throw new Error(`Failed to fetch arrays: ${e.statusText}`);const s=await e.json();L(s.data||[])}catch(e){const s=e instanceof Error?e.message:"Failed to load arrays";G(s),console.error("Error fetching arrays:",e)}finally{O(!1)}}else L([])}),[V]);s.exports.useEffect((()=>{Q()}),[Q]);const[Y,J]=s.exports.useState(""),K=r.useMemo((()=>0===F.length?Array(10).fill(null).map(((e,s)=>({item:"",array_name:"",length:"",value:""}))):F),[F]),U=e=>!e.item&&0===F.length,X=s.exports.useMemo((()=>[j({columnId:"item",renderHeaderCell:()=>e.exports.jsx("span",{children:"Item#"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.item})}),j({columnId:"array_name",renderHeaderCell:()=>e.exports.jsx("span",{children:"Array Name"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.array_name})}),j({columnId:"length",renderHeaderCell:()=>e.exports.jsx("span",{children:"Length"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.length})}),j({columnId:"value",renderHeaderCell:()=>e.exports.jsx("span",{children:"Value"}),renderCell:s=>e.exports.jsx(v,{children:!U(s)&&s.value})})]),[]);return e.exports.jsx("div",{className:y,children:e.exports.jsx("div",{className:C,children:e.exports.jsx("div",{className:z,children:e.exports.jsx("div",{className:N,children:e.exports.jsxs("div",{className:S,children:[P&&e.exports.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",backgroundColor:"#fef6f6",borderRadius:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.exports.jsx(l,{style:{color:"#d13438",fontSize:"16px",flexShrink:0}}),e.exports.jsx(o,{style:{color:"#d13438",fontWeight:500,fontSize:"13px"},children:P})]}),V&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:q,children:e.exports.jsxs("div",{className:I,children:[e.exports.jsxs("button",{className:w,onClick:()=>{Q()},disabled:M,title:"Refresh","aria-label":"Refresh",children:[e.exports.jsx(i,{}),e.exports.jsx("span",{children:"Refresh"})]}),e.exports.jsxs("button",{className:w,onClick:()=>{console.log("Export arrays to CSV")},title:"Export to CSV","aria-label":"Export to CSV",children:[e.exports.jsx(n,{}),e.exports.jsx("span",{children:"Export to CSV"})]}),e.exports.jsx("div",{className:W,role:"separator"}),e.exports.jsxs("button",{className:w,onClick:()=>{console.log("Settings clicked")},title:"Settings","aria-label":"Settings",children:[e.exports.jsx(d,{}),e.exports.jsx("span",{children:"Settings"})]}),e.exports.jsxs("div",{className:k,children:[e.exports.jsx(c,{className:E}),e.exports.jsx("input",{className:H,type:"text",placeholder:"Search arrays...",value:Y,onChange:e=>{J(e.target.value)},spellCheck:"false",role:"searchbox","aria-label":"Search arrays"})]}),V&&e.exports.jsx(x,{content:`Showing arrays for ${V.nameShowOnTree} (SN: ${V.serialNumber}). This table displays all configured array variables for the device.`,relationship:"description",children:e.exports.jsx("button",{className:w,style:{marginLeft:"8px"},title:"Information","aria-label":"Information about this page",children:e.exports.jsx(p,{})})})]})}),e.exports.jsx("div",{style:{padding:"0"},children:e.exports.jsx("hr",{className:D})})]}),e.exports.jsxs("div",{className:R,children:[M&&0===F.length&&e.exports.jsxs("div",{className:A,children:[e.exports.jsx(h,{size:"tiny"}),e.exports.jsx(o,{size:200,weight:"regular",children:"Loading arrays..."})]}),!V&&!M&&e.exports.jsx("div",{className:T,children:e.exports.jsxs("div",{style:{textAlign:"center"},children:[e.exports.jsx(o,{size:400,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(o,{size:200,children:"Please select a device from the tree to view arrays"})]})}),V&&!M&&e.exports.jsx(e.exports.Fragment,{children:e.exports.jsxs(m,{items:K,columns:X,sortable:!0,resizableColumns:!0,columnSizingOptions:{item:{minWidth:60,defaultWidth:80},array_name:{minWidth:180,defaultWidth:250},length:{minWidth:80,defaultWidth:100},value:{minWidth:120,defaultWidth:180}},children:[e.exports.jsx(f,{children:e.exports.jsx(u,{children:({renderHeaderCell:s})=>e.exports.jsx(_,{children:s()})})}),e.exports.jsx(g,{children:({item:s,rowId:r})=>e.exports.jsx(u,{children:({renderCell:r})=>e.exports.jsx(b,{children:r(s)})},r)})]})})]})]})})})})})};export{V as default};

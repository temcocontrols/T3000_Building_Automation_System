import{h as e,o as a,Y as t,Z as l,$ as i,c as o,a5 as n,ao as r,ap as s,an as d,C as p,a0 as c,ar as u,ay as m,au as _,av as b}from"./index.5672de35.js";import{Q as f}from"./QBadge.95c1d7cf.js";import{Q as y,a as g}from"./QTable.85ca610a.js";import{Q as C}from"./QSelect.31b83c34.js";import{u as v}from"./use-quasar.d6dfc755.js";import{_ as h}from"./plugin-vue_export-helper.21dcd24c.js";import"./QMenu.1f130ae9.js";import"./position-engine.14c13ebf.js";import"./QMarkupTable.8932d602.js";import"./QChip.1450761f.js";import"./QItem.5b50a114.js";import"./QItemLabel.1e9b0b8a.js";import"./format.b9446fb2.js";const D={class:"database-partitions-panel"},w={class:"controls-row"};var P=h({name:"DatabasePartitionsPanel",setup(){const t=v(),l=e([]),i=e(!1),o=e(!1),n=e({table_name:"TRENDLOG_DATA",partition_type:"DAILY",retention_days:30,auto_cleanup_enabled:!0}),r=async()=>{i.value=!0;try{l.value=[{id:1,table_name:"TRENDLOG_DATA",partition_type:"DAILY",partition_identifier:"2025-09-26",record_count:15420,size_bytes:2048e3,retention_days:30,is_active:!0},{id:2,table_name:"TRENDLOG_DATA",partition_type:"DAILY",partition_identifier:"2025-09-25",record_count:12850,size_bytes:1756e3,retention_days:30,is_active:!0}]}catch(e){t.notify({type:"negative",message:"Failed to load partitions"})}finally{i.value=!1}};return a((()=>{r()})),{partitions:l,loading:i,showCreateDialog:o,partitionForm:n,columns:[{name:"table_name",label:"Table Name",field:"table_name",sortable:!0,align:"left"},{name:"partition_type",label:"Type",field:"partition_type",sortable:!0,align:"center"},{name:"partition_identifier",label:"Identifier",field:"partition_identifier",sortable:!0,align:"left"},{name:"record_count",label:"Records",field:"record_count",sortable:!0,align:"right"},{name:"size",label:"Size",field:"size_bytes",sortable:!0,align:"right"},{name:"retention_days",label:"Retention",field:"retention_days",sortable:!0,align:"right"},{name:"status",label:"Status",field:"is_active",sortable:!0,align:"center"},{name:"actions",label:"Actions",field:"actions",sortable:!1,align:"center"}],loadPartitions:r,formatBytes:e=>{if(0===e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["B","KB","MB","GB"][a]},createPartition:()=>{t.notify({type:"positive",message:"Partition created successfully"}),o.value=!1,r()},cleanupPartition:e=>{t.notify({type:"info",message:`Cleanup started for ${e.partition_identifier}`})},deletePartition:e=>{t.dialog({title:"Confirm Delete",message:`Delete partition ${e.partition_identifier}?`,cancel:!0}).onOk((()=>{t.notify({type:"positive",message:"Partition deleted"}),r()}))},runCleanup:()=>{t.notify({type:"info",message:"Global cleanup started"})}}}},[["render",function(e,a,v,h,P,k){return t(),l("div",D,[a[8]||(a[8]=i("div",{class:"page-header"},[i("h2",null,"Database Partitions Management"),i("p",null,"Manage database partitioning strategies and cleanup policies")],-1)),o(d,{flat:"",bordered:"",class:"q-mb-md"},{default:n((()=>[o(r,null,{default:n((()=>[i("div",w,[o(s,{color:"primary",icon:"add",label:"Create Partition",onClick:a[0]||(a[0]=e=>h.showCreateDialog=!0)}),o(s,{color:"secondary",icon:"cleaning_services",label:"Run Cleanup",onClick:h.runCleanup},null,8,["onClick"]),o(s,{color:"info",icon:"refresh",label:"Refresh",onClick:h.loadPartitions},null,8,["onClick"])])])),_:1})])),_:1}),o(d,{flat:"",bordered:""},{default:n((()=>[o(r,null,{default:n((()=>[o(y,{rows:h.partitions,columns:h.columns,"row-key":"id",loading:h.loading},{"body-cell-status":n((e=>[o(g,{props:e},{default:n((()=>[o(f,{color:e.row.is_active?"positive":"grey",label:e.row.is_active?"Active":"Inactive"},null,8,["color","label"])])),_:2},1032,["props"])])),"body-cell-size":n((e=>[o(g,{props:e},{default:n((()=>[p(c(h.formatBytes(e.row.size_bytes)),1)])),_:2},1032,["props"])])),"body-cell-actions":n((e=>[o(g,{props:e},{default:n((()=>[o(s,{flat:"",round:"",dense:"",color:"warning",icon:"cleaning_services",onClick:a=>h.cleanupPartition(e.row),disable:!e.row.is_active},null,8,["onClick","disable"]),o(s,{flat:"",round:"",dense:"",color:"negative",icon:"delete",onClick:a=>h.deletePartition(e.row)},null,8,["onClick"])])),_:2},1032,["props"])])),_:1},8,["rows","columns","loading"])])),_:1})])),_:1}),o(b,{modelValue:h.showCreateDialog,"onUpdate:modelValue":a[6]||(a[6]=e=>h.showCreateDialog=e),persistent:""},{default:n((()=>[o(d,{style:{width:"400px"}},{default:n((()=>[o(r,null,{default:n((()=>[...a[7]||(a[7]=[i("div",{class:"text-h6"},"Create New Partition",-1)])])),_:1}),o(r,null,{default:n((()=>[o(u,{modelValue:h.partitionForm.table_name,"onUpdate:modelValue":a[1]||(a[1]=e=>h.partitionForm.table_name=e),label:"Table Name",outlined:""},null,8,["modelValue"]),o(C,{modelValue:h.partitionForm.partition_type,"onUpdate:modelValue":a[2]||(a[2]=e=>h.partitionForm.partition_type=e),options:["DAILY","WEEKLY","MONTHLY"],label:"Partition Type",outlined:"",class:"q-mt-md"},null,8,["modelValue"]),o(u,{modelValue:h.partitionForm.retention_days,"onUpdate:modelValue":a[3]||(a[3]=e=>h.partitionForm.retention_days=e),label:"Retention Days",type:"number",outlined:"",class:"q-mt-md"},null,8,["modelValue"]),o(m,{modelValue:h.partitionForm.auto_cleanup_enabled,"onUpdate:modelValue":a[4]||(a[4]=e=>h.partitionForm.auto_cleanup_enabled=e),label:"Enable Auto Cleanup",class:"q-mt-md"},null,8,["modelValue"])])),_:1}),o(_,{align:"right"},{default:n((()=>[o(s,{flat:"",label:"Cancel",onClick:a[5]||(a[5]=e=>h.showCreateDialog=!1)}),o(s,{color:"primary",label:"Create",onClick:h.createPartition},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}],["__scopeId","data-v-4a3192f6"]]);export{P as default};

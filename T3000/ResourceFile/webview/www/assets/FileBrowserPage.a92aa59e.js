import{j as e}from"./react.8639cc86.js";import{r as s,R as i}from"./client.58f92968.js";import{c as r,D as t,a as l,b as o,d as n,e as a,f as d}from"./DataGridHeaderCell.ec45a911.js";import{B as c,bX as x,K as p,cs as h,aH as m,T as j,ct as f,Q as u,y as v,S as z,n as _,b4 as g,cu as w,I as y,b0 as b}from"./App.7c34790a.js";import"./index.3bd6c859.js";import"./Serializer.f6a5f515.js";import"./axios.65f6a2c9.js";import"./T3Data.63f93fe7.js";import"./_commonjsHelpers.a5007c1f.js";var S="_container_2f0zv_5",C="_navigationBar_2f0zv_17",N="_navDivider_2f0zv_32",k="_headerRight_2f0zv_40",I="_navButtons_2f0zv_47",B="_breadcrumb_2f0zv_54",D="_breadcrumbButton_2f0zv_63",F="_breadcrumbSeparator_2f0zv_73",H="_content_2f0zv_80",T="_splitView_2f0zv_88",W="_fileGrid_2f0zv_95",$="_loadingBar_2f0zv_154",R="_detailsPanel_2f0zv_167",A="_detailsHeader_2f0zv_177",P="_detailsContent_2f0zv_190",E="_detailRow_2f0zv_198",O="_detailDivider_2f0zv_204",U="_previewSection_2f0zv_210",L="_previewText_2f0zv_216",M="_drawerOverlay_2f0zv_233",G="_drawerPanel_2f0zv_244",K="_drawerHeader_2f0zv_268",V="_drawerBody_2f0zv_279";const Q=()=>{const[Q,X]=s.exports.useState([]),[q,J]=s.exports.useState(""),[Y,Z]=s.exports.useState("Runtime Folder"),[ee,se]=s.exports.useState([""]),[ie,re]=s.exports.useState(0),[te,le]=s.exports.useState(null),[oe,ne]=s.exports.useState(""),[ae,de]=s.exports.useState(!1),[ce,xe]=s.exports.useState(null),[pe,he]=s.exports.useState(!1),[me,je]=s.exports.useState(null),[fe,ue]=s.exports.useState({column:null,direction:null}),ve=async(e,s=!0)=>{de(!0),xe(null);try{const i=e?`${API_BASE_URL}/list?path=${encodeURIComponent(e)}`:`${API_BASE_URL}/list`,r=await fetch(i);if(!r.ok)throw new Error(`Failed to load files: ${r.statusText}`);const t=await r.json();t.files&&t.runtimeFolder?(X(t.files),e||Z(t.runtimeFolder)):X(Array.isArray(t)?t:[]);const l=e||"";if(J(l),s){const e=ee.slice(0,ie+1);e.push(l),se(e),re(e.length-1)}}catch(i){xe(i instanceof Error?i.message:"Failed to load files"),X([])}finally{de(!1)}},ze=e=>{fe.column===e?"asc"===fe.direction?ue({column:e,direction:"desc"}):"desc"===fe.direction&&ue({column:null,direction:null}):ue({column:e,direction:"asc"})},_e=async e=>{try{const s=e.replace(/\\/g,"/"),i=await fetch(`${API_BASE_URL}/read?path=${encodeURIComponent(s)}`);if(!i.ok)throw new Error("Failed to load file content");const r=await i.json();ne(r.isBinary?"<Binary file>":r.content)}catch(s){ne("Error loading file content")}};s.exports.useEffect((()=>{ve()}),[]);const ge=e=>e?e<1024?`${e} bytes`:e<1048576?`${(e/1024).toFixed(1)} KB`:e<1073741824?`${(e/1048576).toFixed(1)} MB`:`${(e/1073741824).toFixed(1)} GB`:"",we=e=>{if(!e)return"";try{return new Date(e).toLocaleString()}catch{return""}},ye=s=>fe.column!==s?null:"asc"===fe.direction?e.exports.jsx(h,{fontSize:12}):e.exports.jsx(b,{fontSize:12}),be=[r({columnId:"name",compare:(e,s)=>e.name.localeCompare(s.name),renderHeaderCell:()=>e.exports.jsxs("div",{onClick:()=>ze("name"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"4px",width:"100%",height:"100%"},children:[e.exports.jsx("span",{children:"Name"}),ye("name")]}),renderCell:s=>e.exports.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",overflow:"hidden"},children:[s.isDirectory?e.exports.jsx(f,{style:{flexShrink:0}}):e.exports.jsx(w,{style:{flexShrink:0}}),e.exports.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name})]})}),r({columnId:"modified",compare:(e,s)=>(e.modified||"").localeCompare(s.modified||""),renderHeaderCell:()=>e.exports.jsxs("div",{onClick:()=>ze("modified"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"4px",width:"100%",height:"100%"},children:[e.exports.jsx("span",{children:"Date Modified"}),ye("modified")]}),renderCell:s=>e.exports.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:we(s.modified)})}),r({columnId:"type",compare:(e,s)=>e.fileType.localeCompare(s.fileType),renderHeaderCell:()=>e.exports.jsxs("div",{onClick:()=>ze("type"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"4px",width:"100%",height:"100%"},children:[e.exports.jsx("span",{children:"Type"}),ye("type")]}),renderCell:s=>e.exports.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.fileType})}),r({columnId:"size",compare:(e,s)=>(e.size||0)-(s.size||0),renderHeaderCell:()=>e.exports.jsxs("div",{onClick:()=>ze("size"),style:{cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",gap:"4px",width:"100%",height:"100%"},children:[e.exports.jsx("span",{children:"Size"}),ye("size")]}),renderCell:s=>e.exports.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ge(s.size)})}),r({columnId:"actions",renderHeaderCell:()=>"Actions",renderCell:s=>e.exports.jsx(c,{appearance:"subtle",size:"small",icon:e.exports.jsx(y,{}),onClick:e=>((e,s)=>{s.stopPropagation(),je(e),he(!0),e.isDirectory||_e(e.path)})(s,e),title:"View details"})})],Se=q?q.split("\\").filter((e=>e)):[];return e.exports.jsxs("div",{className:S,children:[e.exports.jsxs("div",{className:C,children:[e.exports.jsxs("div",{className:I,children:[e.exports.jsx(c,{appearance:"subtle",size:"small",icon:e.exports.jsx(x,{}),onClick:()=>{if(ie>0){const e=ie-1;re(e),J(ee[e]),ve(ee[e],!1)}},disabled:ae||0===ie,title:"Back"}),e.exports.jsx(c,{appearance:"subtle",size:"small",icon:e.exports.jsx(p,{}),onClick:()=>{if(ie<ee.length-1){const e=ie+1;re(e),J(ee[e]),ve(ee[e],!1)}},disabled:ae||ie>=ee.length-1,title:"Forward"}),e.exports.jsx(c,{appearance:"subtle",size:"small",icon:e.exports.jsx(h,{}),onClick:()=>{if(q){const e=q.split("\\");e.pop();const s=e.join("\\");ve(s,!0)}},disabled:ae||!q,title:"Up"})]}),e.exports.jsxs("div",{className:B,children:[e.exports.jsx(c,{appearance:"subtle",size:"small",icon:e.exports.jsx(m,{fontSize:16}),onClick:()=>{ve("",!0)},className:D,title:"Home"}),Se.map(((s,r)=>e.exports.jsxs(i.Fragment,{children:[e.exports.jsx("span",{className:F,children:"â€º"}),e.exports.jsx(c,{appearance:"subtle",size:"small",onClick:()=>(e=>{const s=q.split("\\").filter((e=>e)).slice(0,e+1).join("\\");ve(s,!0)})(r),className:D,children:s})]},r)))]}),e.exports.jsx("div",{className:N}),e.exports.jsxs("div",{className:k,children:[e.exports.jsxs(j,{size:200,children:[e.exports.jsx(f,{fontSize:12})," ",Y]}),e.exports.jsx(u,{content:"Refresh current folder",relationship:"label",children:e.exports.jsx(c,{appearance:"subtle",size:"small",icon:e.exports.jsx(v,{fontSize:14}),onClick:()=>ve(q,!1),disabled:ae})})]})]}),e.exports.jsx("div",{className:H,children:e.exports.jsxs("div",{className:T,children:[e.exports.jsxs("div",{className:W,children:[ae&&e.exports.jsxs("div",{className:$,children:[e.exports.jsx(z,{size:"tiny"}),e.exports.jsx(j,{size:200,weight:"regular",children:"Loading files..."})]}),ce&&e.exports.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",backgroundColor:"#fef6f6",borderRadius:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[e.exports.jsx(_,{style:{color:"#d13438",fontSize:"16px",flexShrink:0}}),e.exports.jsx(j,{style:{color:"#d13438",fontWeight:500,fontSize:"13px"},children:ce})]}),!ae&&!ce&&e.exports.jsxs(t,{items:fe.column&&fe.direction?[...Q].sort(((e,s)=>{let i=e[fe.column],r=s[fe.column];if("size"===fe.column)return i=i||0,r=r||0,"asc"===fe.direction?i-r:r-i;i=i||"",r=r||"";const t=i.toString().localeCompare(r.toString());return"asc"===fe.direction?t:-t})):Q,columns:be,sortable:!1,resizableColumns:!0,focusMode:"composite",size:"small",style:{minWidth:"100%"},columnSizingOptions:{name:{minWidth:250,idealWidth:"43%"},modified:{minWidth:150,idealWidth:"25%"},type:{minWidth:80,idealWidth:"14%"},size:{minWidth:60,idealWidth:"10%"},actions:{minWidth:70,idealWidth:"8%"}},children:[e.exports.jsx(l,{children:e.exports.jsx(o,{children:({renderHeaderCell:s})=>e.exports.jsx(n,{children:s()})})}),e.exports.jsx(a,{children:({item:s,rowId:i})=>e.exports.jsx(o,{onClick:()=>{return le(e=s),void(e.isDirectory?ne(""):_e(e.path));var e},onDoubleClick:()=>(e=>{if(e.isDirectory){const s=q?`${q}\\${e.name}`:e.name;ve(s,!0)}})(s),style:{cursor:"pointer",backgroundColor:(null==te?void 0:te.path)===s.path?"#e1dfdd":void 0},children:({renderCell:i})=>e.exports.jsx(d,{children:i(s)})},i)})]})]}),te&&e.exports.jsxs("div",{className:R,children:[e.exports.jsxs("div",{className:A,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Details"}),e.exports.jsx(c,{appearance:"subtle",icon:e.exports.jsx(g,{}),size:"small",onClick:()=>le(null)})]}),e.exports.jsxs("div",{className:P,children:[e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Name:"}),e.exports.jsx(j,{size:200,children:te.name})]}),e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Type:"}),e.exports.jsx(j,{size:200,children:te.fileType})]}),void 0!==te.size&&e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Size:"}),e.exports.jsx(j,{size:200,children:ge(te.size)})]}),te.modified&&e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Modified:"}),e.exports.jsx(j,{size:200,children:we(te.modified)})]}),e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Path:"}),e.exports.jsx(j,{size:200,children:te.path})]}),!te.isDirectory&&oe&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:O}),e.exports.jsxs("div",{className:U,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Preview:"}),e.exports.jsx("div",{className:L,children:e.exports.jsxs("pre",{children:[oe.substring(0,5e3),oe.length>5e3?"\n...(truncated)":""]})})]})]})]})]})]})}),pe&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:M,onClick:()=>he(!1)}),e.exports.jsxs("div",{className:G,children:[e.exports.jsxs("div",{className:K,children:[e.exports.jsx(j,{size:300,weight:"semibold",children:null==me?void 0:me.name}),e.exports.jsx(c,{appearance:"subtle",icon:e.exports.jsx(g,{}),onClick:()=>he(!1)})]}),e.exports.jsx("div",{className:V,children:me&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Name:"}),e.exports.jsx(j,{size:200,children:me.name})]}),e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Type:"}),e.exports.jsx(j,{size:200,children:me.fileType})]}),void 0!==me.size&&e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Size:"}),e.exports.jsx(j,{size:200,children:ge(me.size)})]}),me.modified&&e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Modified:"}),e.exports.jsx(j,{size:200,children:we(me.modified)})]}),e.exports.jsxs("div",{className:E,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Path:"}),e.exports.jsx(j,{size:200,children:me.path})]}),!me.isDirectory&&oe&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:O}),e.exports.jsxs("div",{className:U,children:[e.exports.jsx(j,{size:200,weight:"semibold",children:"Preview:"}),e.exports.jsx("div",{className:L,children:e.exports.jsxs("pre",{children:[oe.substring(0,1e4),oe.length>1e4?"\n...(truncated)":""]})})]})]})]})})]})]})]})};export{Q as FileBrowserPage,Q as default};

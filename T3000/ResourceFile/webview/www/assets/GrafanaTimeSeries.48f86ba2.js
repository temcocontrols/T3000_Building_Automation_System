import{d as a,h as e,a as t,o,n as l,e as s,a1 as n,a2 as i,a3 as r,a4 as d,aH as u,k as v,bT as m,bI as c,aJ as p}from"./index.1af70167.js";import{C as f}from"./auto.4ae97206.js";import"./chartjs-adapter-date-fns.esm.6cd07d05.js";import{_ as b}from"./plugin-vue_export-helper.21dcd24c.js";const h={class:"grafana-timeseries-container"},g={class:"grafana-panel-header"},C={class:"panel-title"},y={class:"panel-controls"},E={class:"grafana-panel-footer"},B={class:"footer-text"},x={class:"footer-text"};var D=b(a({__name:"GrafanaTimeSeries",props:{title:{default:"Time Series Chart"},height:{default:400},updateInterval:{default:3e4},maxDataPoints:{default:200},timeRange:{default:"15m"}},setup(a){const b=a,D=e(),M=e(),w=e(!0),I=e(b.timeRange),P=e(""),F=e();let R=null;const k=e([{name:"BMC01E1E-1P1B",color:"#FF6B6B",data:[],visible:!0},{name:"BMC01E1E-2P1B",color:"#4ECDC4",data:[],visible:!0},{name:"BMC01E1E-3P1B",color:"#45B7D1",data:[],visible:!0},{name:"BMC01E1E-4P1B",color:"#96CEB4",data:[],visible:!0},{name:"BMC01E1E-5P1B",color:"#FECA57",data:[],visible:!0},{name:"BMC01E1E-6P1B",color:"#FF9FF3",data:[],visible:!0},{name:"BMC01E1E-7P1B",color:"#54A0FF",data:[],visible:!0}]),H=t((()=>k.value.reduce(((a,e)=>a+e.data.length),0))),L=t((()=>{const a={"5m":3e5,"15m":9e5,"30m":18e5,"1h":36e5,"6h":216e5,"24h":864e5};return a[I.value]||a["15m"]}));t((()=>{const a=Date.now(),e=a-L.value;return{from:new Date(e),to:new Date(a),raw:{from:new Date(e),to:new Date(a)}}}));const _=()=>{const a=65+5*Math.sin(Date.now()/1e5),e=8*(Math.random()-.5),t=Math.random()<.05?20*(Math.random()-.5):0;return Math.max(60,Math.min(70,a+e+t))},S=()=>{const a=Date.now(),e=a-L.value;k.value.forEach((t=>{const o=_();t.data.push({timestamp:a,value:o}),t.data=t.data.filter((a=>a.timestamp>=e)),t.data.length>b.maxDataPoints&&(t.data=t.data.slice(-b.maxDataPoints))})),P.value=(new Date).toLocaleTimeString(),j()},A=()=>{if(!M.value)return;const a=M.value.getContext("2d");if(!a)return;R&&R.destroy();const e=k.value.filter((a=>a.visible)).map((a=>({label:a.name,data:a.data.map((a=>({x:a.timestamp,y:a.value}))),borderColor:a.color,backgroundColor:a.color+"20",borderWidth:2,fill:!1,tension:.1,pointRadius:0,pointHoverRadius:4})));R=new f(a,{type:"line",data:{datasets:e},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"bottom",labels:{color:"#d9d9d9",font:{size:12,family:"Inter, Helvetica, Arial, sans-serif"},usePointStyle:!0,pointStyle:"line"}},tooltip:{backgroundColor:"#2d3748",titleColor:"#d9d9d9",bodyColor:"#d9d9d9",borderColor:"#4a5568",borderWidth:1,cornerRadius:4,displayColors:!0,callbacks:{title:a=>new Date(a[0].parsed.x).toLocaleString(),label:a=>`${a.dataset.label}: ${a.parsed.y.toFixed(2)}`}}},scales:{x:{type:"time",time:{displayFormats:{minute:"HH:mm",hour:"HH:mm"}},grid:{color:"#36414b",display:!0},ticks:{color:"#8e8e8e",font:{size:11,family:"Inter, Helvetica, Arial, sans-serif"}}},y:{grid:{color:"#36414b",display:!0},ticks:{color:"#8e8e8e",font:{size:11,family:"Inter, Helvetica, Arial, sans-serif"}}}},elements:{line:{borderWidth:2},point:{radius:0,hoverRadius:4}}}})},j=()=>{R?(R.data.datasets=k.value.filter((a=>a.visible)).map((a=>({label:a.name,data:a.data.map((a=>({x:a.timestamp,y:a.value}))),borderColor:a.color,backgroundColor:a.color+"20",borderWidth:2,fill:!1,tension:.1,pointRadius:0,pointHoverRadius:4}))),R.update("none")):A()},T=()=>{w.value=!w.value,w.value?z():$()},W=()=>{A()},z=()=>{F.value&&clearInterval(F.value),F.value=setInterval(S,b.updateInterval)},$=()=>{F.value&&(clearInterval(F.value),F.value=void 0)};return o((async()=>{(()=>{const a=Date.now(),e=Math.floor(L.value/b.updateInterval);k.value.forEach((t=>{t.data=[];for(let o=e;o>=0;o--){const e=a-o*b.updateInterval,l=_();t.data.push({timestamp:e,value:l})}}))})(),await l(),A(),w.value&&z()})),s((()=>{$(),R&&(R.destroy(),R=null)})),(a,e)=>(n(),i("div",h,[r("div",g,[r("div",C,d(a.title),1),r("div",y,[r("button",{class:u(["grafana-button",{"grafana-button--primary":w.value}]),onClick:T},d(w.value?"Pause":"Resume"),3),v(r("select",{class:"grafana-select","onUpdate:modelValue":e[0]||(e[0]=a=>I.value=a),onChange:W},[...e[1]||(e[1]=[c('<option value="5m" data-v-b59d6f36>Last 5 minutes</option><option value="15m" data-v-b59d6f36>Last 15 minutes</option><option value="30m" data-v-b59d6f36>Last 30 minutes</option><option value="1h" data-v-b59d6f36>Last 1 hour</option><option value="6h" data-v-b59d6f36>Last 6 hours</option><option value="24h" data-v-b59d6f36>Last 24 hours</option>',6)])],544),[[m,I.value]])])]),r("div",{ref_key:"timeSeriesContainer",ref:D,class:"grafana-timeseries-panel",style:p({height:`${a.height}px`})},[r("canvas",{ref_key:"canvasRef",ref:M,class:"chart-canvas"},null,512)],4),r("div",E,[r("span",B,"Last update: "+d(P.value),1),r("span",x,d(H.value)+" data points",1)])]))}}),[["__scopeId","data-v-b59d6f36"]]);export{D as G};

import{Q as ge,a as na,b as Me,c as aa}from"./QExpansionItem.b7a91c01.js";import{J as zn,o as D,K as de,L as ka,M as y,y as ne,k as Ln,N as Ct,O as Dt,c as X,w as l,a as t,P as ue,Q as $,R as Oe,S as Yt,T as la,U as Tt,V as _e,W as g,X as J,Y as vt,Z as $n,_ as Rn,$ as jn,m as An,n as Ca,a0 as cl,a1 as ul,r as dl,a2 as ke,a3 as we,a4 as Vt,a5 as fl,d as vl,C as pl,a6 as Rt,a7 as nn,a8 as oa,a9 as ia,aa as sa,ab as an,ac as jt,ad as ra}from"./index.b8957d33.js";import{Q as lt,a as oe,b as P,c as xt,C as ve,d as nt}from"./ClosePopup.4e63524f.js";import{Q as gl}from"./QPage.7f410c7e.js";import{M as hl,P as Pn,i as xa,a as ml,E as bl,s as yl,D as _l,g as ln,c as kl,b as Cl,d as ca,e as xl,f as _t,h as Sn,j as ua,k as Bt,r as wl,l as Sl,m as Il,K as wa,G as El,n as Dl,o as Tl,p as $l,q as da,t as Pl,u as Ml,v as Ol,w as zl,x as fa,y as Ll,z as In,A as Rl,B as va,C as jl,F as Al,Q as Sa,H as Lt,I as Mn,J as $t,L as Z,T as At,N as pa,O as En,R as ga,S as Wl,U as Gl,V as at,W as Qe,X as Fl,Y as Dn,Z as Vl,_ as Bl}from"./QTree.5744d4b3.js";import{u as Wn,l as Wt}from"./api.5c0d92ff.js";import{u as Yl}from"./use-meta.d1353e98.js";import{u as kt,d as Xl,T as Be,g as Gt,a as r,m as dt,l as G,b as Ge,r as ft,c as We,i as Ye,v as Ul,e as Ft,f as mt,h as bt,j as Te,s as on,k as Ie,n as yt,o as Nl}from"./T3Data.8df31f71.js";import{p as De,T as ql,H as Hl,V as Ql,a as Kl,O as Jl,D as Zl,W as eo}from"./DeviceInfo.a186a54e.js";import{F as to}from"./FileUploadS3.3c9a40f7.js";import{t as Xe,a as no}from"./common.92de8209.js";import{_ as rn}from"./plugin-vue_export-helper.21dcd24c.js";import"./AntdIcon.7afdc7d4.js";import"./QToolbar.206a539a.js";const Ia={};hl.forEach(i=>{Ia[i]=function(...u){return this.$_moveable[i](...u)}});const Ea={};Pn.forEach(i=>{Ea[i]=function(u){this.$_moveable[i]=u}});const ao=zn({name:"moveable",methods:Ia,props:Pn,watch:Ea,mounted(){const i={},u=this.$props;Pn.forEach(c=>{const b=u[c];xa(b)||(i[c]=u[c])});const o=this.$refs.moveableElement,a=new ml(o,{...i,warpSelf:!0});bl.forEach(c=>{a.on(c,b=>{this.$emit(c,{...b})})}),this.$_moveable=a},beforeUnmount(){this.$_moveable.destroy()}}),lo=ao,oo=(i,u)=>{const h=i.__vccOpts||i;for(const[o,a]of u)h[o]=a;return h},io={ref:"moveableElement"};function so(i,u,h,o,a,c){return D(),de("div",io,null,512)}const ro=oo(lo,[["render",so]]);var On=function(i,u){return On=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,o){h.__proto__=o}||function(h,o){for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(h[a]=o[a])},On(i,u)};function Da(i,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");On(i,u);function h(){this.constructor=i}i.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}var $e=function(){return $e=Object.assign||function(u){for(var h,o=1,a=arguments.length;o<a;o++){h=arguments[o];for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&(u[c]=h[c])}return u},$e.apply(this,arguments)};function co(i,u){var h={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&u.indexOf(o)<0&&(h[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,o=Object.getOwnPropertySymbols(i);a<o.length;a++)u.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(i,o[a])&&(h[o[a]]=i[o[a]]);return h}function uo(i,u,h,o){var a=arguments.length,c=a<3?u:o===null?o=Object.getOwnPropertyDescriptor(u,h):o,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,u,h,o);else for(var v=i.length-1;v>=0;v--)(b=i[v])&&(c=(a<3?b(c):a>3?b(u,h,c):b(u,h))||c);return a>3&&c&&Object.defineProperty(u,h,c),c}function Xt(i,u,h){if(h||arguments.length===2)for(var o=0,a=u.length,c;o<a;o++)(c||!(o in u))&&(c||(c=Array.prototype.slice.call(u,0,o)),c[o]=u[o]);return i.concat(c||Array.prototype.slice.call(u))}function fo(i){if("touches"in i){var u=i.touches[0]||i.changedTouches[0];return{clientX:u.clientX,clientY:u.clientY}}else return{clientX:i.clientX,clientY:i.clientY}}function vo(i){if(typeof Map=="undefined")return i.filter(function(h,o){return i.indexOf(h)===o});var u=new Map;return i.filter(function(h){return u.has(h)?!1:(u.set(h,!0),!0)})}function po(i,u,h){var o=_t(i);return o.elementFromPoint&&o.elementFromPoint(u,h)||null}function Ta(i,u,h){var o=i.tag,a=i.children,c=i.attributes,b=i.className,v=i.style,d=u||_t(h).createElement(o);for(var p in c)d.setAttribute(p,c[p]);var S=d.children;if(a.forEach(function(M,O){Ta(M,S[O],d)}),b&&b.split(/\s+/g).forEach(function(M){M&&!Ml(d,M)&&Ol(d,M)}),v){var R=d.style;for(var p in v)R[p]=v[p]}return!u&&h&&h.appendChild(d),d}function go(i,u){for(var h=[],o=2;o<arguments.length;o++)h[o-2]=arguments[o];var a=u||{},c=a.className,b=c===void 0?"":c,v=a.style,d=v===void 0?{}:v,p=co(a,["className","style"]);return{tag:i,className:b,style:d,attributes:p,children:h}}function Tn(i,u,h){i!==u&&h(i,u)}function ha(i,u,h){var o;h===void 0&&(h=i.data.boundArea);var a=i.distX,c=a===void 0?0:a,b=i.distY,v=b===void 0?0:b,d=i.data,p=d.startX,S=d.startY;if(u>0){var R=Math.sqrt((c*c+v*v)/(1+u*u)),M=u*R;c=(c>=0?1:-1)*M,v=(v>=0?1:-1)*R}var O=Math.abs(c),N=Math.abs(v),q=c<0?p-h.left:h.right-p,K=v<0?S-h.top:h.bottom-S;o=zl([O,N],[0,0],[q,K],!!u),O=o[0],N=o[1],c=(c>=0?1:-1)*O,v=(v>=0?1:-1)*N;var U=Math.min(0,c),se=Math.min(0,v),V=p+U,B=S+se;return{left:V,top:B,right:V+O,bottom:B+N,width:O,height:N}}function sn(i){var u=i.getBoundingClientRect(),h=u.left,o=u.top,a=u.width,c=u.height;return{pos1:[h,o],pos2:[h+a,o],pos3:[h,o+c],pos4:[h+a,o+c]}}function ma(i,u,h){var o=Bt(i,u),a=o.list,c=o.prevList,b=o.added,v=o.removed,d=o.maintained;return Xt(Xt(Xt([],b.map(function(p){return a[p]}),!0),v.map(function(p){return c[p]}),!0),h?d.map(function(p){var S=p[1];return a[S]}):[],!0)}function ba(i){for(var u=0,h=i.length,o=1;o<h;++o)u=Math.max(jl(i[o],i[o-1]),u);return u}var $a=yl(`
:host {
    position: fixed;
    display: none;
    border: 1px solid #4af;
    background: rgba(68, 170, 255, 0.5);
    pointer-events: none;
    will-change: transform;
    z-index: 100;
}
`),ya="selecto-selection ".concat($a.className),Gn=["className","boundContainer","selectableTargets","selectByClick","selectFromInside","continueSelect","continueSelectWithoutDeselect","toggleContinueSelect","toggleContinueSelectWithoutDeselect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio","getElementRect","preventDragFromInside","rootContainer","dragCondition","clickBySelectEnd","checkOverflow","innerScrollOptions"],_a=Xt(["dragContainer","cspNonce","preventClickEventOnDrag","preventClickEventOnDragStart","preventRightClick"],Gn,!0),ho=["dragStart","drag","dragEnd","selectStart","select","selectEnd","keydown","keyup","scroll","innerScroll"],mo=["clickTarget","getSelectableElements","setSelectedTargets","getElementPoints","getSelectedTargets","findSelectableTargets","triggerDragStart","checkScroll","selectTargetsByPoints","setSelectedTargetsByPoints"],bo=function(i){Da(u,i);function u(o){o===void 0&&(o={});var a=i.call(this)||this;a.selectedTargets=[],a.dragScroll=new _l,a._onDragStart=function(v,d){var p=v.data,S=v.clientX,R=v.clientY,M=v.inputEvent,O=a.options,N=O.selectFromInside,q=O.selectByClick,K=O.rootContainer,U=O.boundContainer,se=O.preventDragFromInside,V=se===void 0?!0:se,B=O.clickBySelectEnd,ce=O.dragCondition;if(ce&&!ce(v)){v.stop();return}p.data={};var ae=ln(a.container);p.innerWidth=ae.innerWidth,p.innerHeight=ae.innerHeight,a.findSelectableTargets(p),p.startSelectedTargets=a.selectedTargets,p.scaleMatrix=kl(),p.containerX=0,p.containerY=0;var be=a.container,Ve={left:-1/0,top:-1/0,right:1/0,bottom:1/0};if(K){var je=a.container.getBoundingClientRect();p.containerX=je.left,p.containerY=je.top,p.scaleMatrix=Cl(a.container,K)}if(U){var ie=ca(U)&&"element"in U?$e({left:!0,top:!0,bottom:!0,right:!0},U):{element:U,left:!0,top:!0,bottom:!0,right:!0},Ue=ie.element,Ke=void 0;if(Ue){xl(Ue)?Ke=_t(be).querySelector(Ue):Ue===!0?Ke=a.container:Ke=Ue;var Je=Ke.getBoundingClientRect();ie.left&&(Ve.left=Je.left),ie.top&&(Ve.top=Je.top),ie.right&&(Ve.right=Je.right),ie.bottom&&(Ve.bottom=Je.bottom)}}p.boundArea=Ve;var Ze={left:S,top:R,right:S,bottom:R,width:0,height:0},Ne=[],et=q&&!B,ot=!1;if(!N||et){var Pe=a._findElement(d||M.target,p.selectableTargets);ot=!!Pe,et&&(Ne=Pe?[Pe]:[])}var Ae=!N&&ot;if(Ae&&!q)return v.stop(),!1;var C=M.type,k=C==="mousedown"||C==="touchstart",m=!v.isClick&&k?a.emit("dragStart",$e($e({},v),{data:p.data})):!0;if(!m)return v.stop(),!1;if(a.continueSelect?(Ne=ma(a.selectedTargets,Ne,a.continueSelectWithoutDeselect),p.startPassedTargets=a.selectedTargets):p.startPassedTargets=[],a._select(Ne,Ze,v,!0,Ae&&q&&!B&&V),p.startX=S,p.startY=R,p.selectFlag=!1,p.preventDragFromInside=!1,M.target){var E=Sn(p.scaleMatrix,[S-p.containerX,R-p.containerY]);a.target.style.cssText+="position: ".concat(K?"absolute":"fixed",";")+"left:0px;top:0px;"+"transform: translate(".concat(E[0],"px, ").concat(E[1],"px)")}if(Ae&&q&&!B)M.preventDefault(),V&&(a._selectEnd(p.startSelectedTargets,p.startPassedTargets,Ze,v,!0),p.preventDragFromInside=!0);else{p.selectFlag=!0;var T=a.options,I=T.scrollOptions,w=T.innerScrollOptions,j=!1;if(w){for(var W=v.inputEvent,z=W.target,F=null,le=z;le&&le!==_t(be).body;){var A=getComputedStyle(le).overflow!=="visible";if(A){F=le;break}le=le.parentElement}F&&(p.innerScrollOptions=$e({container:F,checkScrollEvent:!0},w===!0?{}:w),a.dragScroll.dragStart(v,p.innerScrollOptions),j=!0)}!j&&I&&I.container&&a.dragScroll.dragStart(v,I),Ae&&q&&B&&(p.selectFlag=!1,v.preventDrag())}return!0},a._onDrag=function(v){if(v.data.selectFlag){var d=a.scrollOptions,p=v.data.innerScrollOptions,S=p||(d==null?void 0:d.container);if(S&&!v.isScroll&&a.dragScroll.drag(v,p||d))return}a._checkSelected(v)},a._onDragEnd=function(v){var d=v.data,p=v.inputEvent,S=ha(v,a.options.ratio),R=d.selectFlag,M=a.container;if(p&&a.emit("dragEnd",$e($e({isDouble:!!v.isDouble,isClick:!!v.isClick,isDrag:!1,isSelect:R},v),{data:d.data,rect:S})),a.target.style.cssText+="display: none;",R)d.selectFlag=!1,a.dragScroll.dragEnd();else if(a.selectByClick&&a.clickBySelectEnd){var O=a._findElement((p==null?void 0:p.target)||po(M,v.clientX,v.clientY),d.selectableTargets);a._select(O?[O]:[],S,v)}d.preventDragFromInside||a._selectEnd(d.startSelectedTargets,d.startPassedTargets,S,v)},a._onKeyDown=function(v){var d=a.options,p=!1;if(!a._keydownContinueSelect){var S=a._sameCombiKey(v,d.toggleContinueSelect);a._keydownContinueSelect=S,p||(p=S)}if(!a._keydownContinueSelectWithoutDeselection){var S=a._sameCombiKey(v,d.toggleContinueSelectWithoutDeselect);a._keydownContinueSelectWithoutDeselection=S,p||(p=S)}!p||a.emit("keydown",{keydownContinueSelect:a._keydownContinueSelect,keydownContinueSelectWithoutDeselection:a._keydownContinueSelectWithoutDeselection})},a._onKeyUp=function(v){var d=a.options,p=!1;if(a._keydownContinueSelect){var S=a._sameCombiKey(v,d.toggleContinueSelect,!0);a._keydownContinueSelect=!S,p||(p=S)}if(a._keydownContinueSelectWithoutDeselection){var S=a._sameCombiKey(v,d.toggleContinueSelectWithoutDeselect,!0);a._keydownContinueSelectWithoutDeselection=!S,p||(p=S)}!p||a.emit("keyup",{keydownContinueSelect:a._keydownContinueSelect,keydownContinueSelectWithoutDeselection:a._keydownContinueSelectWithoutDeselection})},a._onBlur=function(){(a._keydownContinueSelect||a._keydownContinueSelectWithoutDeselection)&&(a._keydownContinueSelect=!1,a._keydownContinueSelectWithoutDeselection=!1,a.emit("keyup",{keydownContinueSelect:a._keydownContinueSelect,keydownContinueSelectWithoutDeselection:a._keydownContinueSelectWithoutDeselection}))},a._onDocumentSelectStart=function(v){var d=_t(a.container);if(!!a.gesto.isFlag()){var p=a.dragContainer;p===ln(a.container)&&(p=d.documentElement);var S=ua(p)?[p]:[].slice.call(p),R=v.target;S.some(function(M){if(M===R||M.contains(R))return v.preventDefault(),!0})}},a.target=o.portalContainer;var c=o.container;a.options=$e({className:"",portalContainer:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,clickBySelectEnd:!1,hitRate:100,continueSelect:!1,continueSelectWithoutDeselect:!1,toggleContinueSelect:null,toggleContinueSelectWithoutDeselect:null,keyContainer:null,scrollOptions:null,checkInput:!1,preventDefault:!1,boundContainer:!1,preventDragFromInside:!0,dragCondition:null,rootContainer:null,checkOverflow:!1,innerScrollOptions:!1,getElementRect:sn,cspNonce:"",ratio:0},o);var b=a.options.portalContainer;return b&&(c=b.parentElement),a.container=c||document.body,a.initElement(),a.initDragScroll(),a.setKeyController(),a}var h=u.prototype;return h.setSelectedTargets=function(o){var a=this.selectedTargets,c=Bt(a,o),b=c.added,v=c.removed,d=c.prevList,p=c.list;return this.selectedTargets=o,{added:b.map(function(S){return p[S]}),removed:v.map(function(S){return d[S]}),beforeSelected:a,selected:o}},h.setSelectedTargetsByPoints=function(o,a){var c=Math.min(o[0],a[0]),b=Math.min(o[1],a[1]),v=Math.max(o[0],a[0]),d=Math.max(o[1],a[1]),p={left:c,top:b,right:v,bottom:d,width:v-c,height:d-b},S={ignoreClick:!0};this.findSelectableTargets(S);var R=this.hitTest(p,S,!0,null),M=this.setSelectedTargets(R);return $e($e({},M),{rect:p})},h.selectTargetsByPoints=function(o,a){var c=new MouseEvent("mousedown",{clientX:o[0],clientY:o[1],cancelable:!0,bubbles:!0}),b=new MouseEvent("mousemove",{clientX:a[0],clientY:a[1],cancelable:!0,bubbles:!0}),v=new MouseEvent("mousemove",{clientX:a[0],clientY:a[1],cancelable:!0,bubbles:!0}),d=this.gesto,p=d.onDragStart(c);p!==!1&&(d.onDrag(b),d.onDragEnd(v))},h.getSelectedTargets=function(){return this.selectedTargets},h.triggerDragStart=function(o){return this.gesto.triggerDragStart(o),this},h.destroy=function(){var o;this.off(),this.keycon&&this.keycon.destroy(),this.gesto.unset(),this.injectResult.destroy(),this.dragScroll.dragEnd(),wl(document,"selectstart",this._onDocumentSelectStart),this.options.portalContainer||(o=this.target.parentElement)===null||o===void 0||o.removeChild(this.target),this.keycon=null,this.gesto=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},h.getElementPoints=function(o){var a=this.getElementRect||sn,c=a(o),b=[c.pos1,c.pos2,c.pos4,c.pos3];if(a!==sn){var v=o.getBoundingClientRect();return Sl(b,v)}return b},h.getSelectableElements=function(){var o=this.container,a=[];return this.options.selectableTargets.forEach(function(c){if(Il(c)){var b=c();b&&a.push.apply(a,[].slice.call(b))}else if(ua(c))a.push(c);else if(ca(c))a.push(c.value||c.current);else{var v=[].slice.call(_t(o).querySelectorAll(c));a.push.apply(a,v)}}),a},h.checkScroll=function(){if(!!this.gesto.isFlag()){var o=this.scrollOptions,a=this.gesto.getEventData().innerScrollOptions,c=a||(o==null?void 0:o.container);c&&this.dragScroll.checkScroll($e({inputEvent:this.gesto.getCurrentEvent()},a||o))}},h.findSelectableTargets=function(o){var a=this;o===void 0&&(o=this.gesto.getEventData());var c=this.getSelectableElements(),b=c.map(function(R){return a.getElementPoints(R)});o.selectableTargets=c,o.selectablePoints=b,o.selectableParentMap=null;var v=this.options,d=v.checkOverflow||v.innerScrollOptions,p=_t(this.container);if(d){var S=new Map;o.selectableInnerScrollParentMap=S,o.selectableInnerScrollPathsList=c.map(function(R,M){for(var O=R.parentElement,N=[],q=[],K=function(){var U=S.get(O);if(!U){var se=getComputedStyle(O).overflow!=="visible";if(se){var V=sn(O);U={parentElement:O,indexes:[],points:[V.pos1,V.pos2,V.pos4,V.pos3],paths:Xt([],q,!0)},N.push(O),N.forEach(function(B){S.set(B,U)}),N=[]}}U?(O=U.parentElement,S.get(O).indexes.push(M),q.push(O)):N.push(O),O=O.parentElement};O&&O!==p.body;)K();return q})}return v.checkOverflow||(o.selectableInners=c.map(function(){return!0})),this._refreshGroups(o),c},h.clickTarget=function(o,a){var c=fo(o),b=c.clientX,v=c.clientY,d={data:{selectFlag:!1},clientX:b,clientY:v,inputEvent:o,isClick:!0,isTrusted:!1,stop:function(){return!1}};return this._onDragStart(d,a)&&this._onDragEnd(d),this},h.setKeyController=function(){var o=this.options,a=o.keyContainer,c=o.toggleContinueSelect,b=o.toggleContinueSelectWithoutDeselect;this.keycon&&(this.keycon.destroy(),this.keycon=null),(c||b)&&(this.keycon=new wa(a||ln(this.container)),this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on("blur",this._onBlur))},h.setClassName=function(o){this.options.className=o,this.target.setAttribute("class","".concat(ya," ").concat(o||""))},h.setKeyEvent=function(){var o=this.options,a=o.toggleContinueSelect,c=o.toggleContinueSelectWithoutDeselect;!a&&!c||this.keycon||this.setKeyController()},h.setKeyContainer=function(o){var a=this,c=this.options;Tn(c.keyContainer,o,function(){c.keyContainer=o,a.setKeyController()})},h.getContinueSelect=function(){var o=this.options,a=o.continueSelect,c=o.toggleContinueSelect;return!c||!this._keydownContinueSelect?a:!a},h.getContinueSelectWithoutDeselect=function(){var o=this.options,a=o.continueSelectWithoutDeselect,c=o.toggleContinueSelectWithoutDeselect;return!c||!this._keydownContinueSelectWithoutDeselection?a:!a},h.setToggleContinueSelect=function(o){var a=this,c=this.options;Tn(c.toggleContinueSelect,o,function(){c.toggleContinueSelect=o,a.setKeyEvent()})},h.setToggleContinueSelectWithoutDeselect=function(o){var a=this,c=this.options;Tn(c.toggleContinueSelectWithoutDeselect,o,function(){c.toggleContinueSelectWithoutDeselect=o,a.setKeyEvent()})},h.setPreventDefault=function(o){this.gesto.options.preventDefault=o},h.setCheckInput=function(o){this.gesto.options.checkInput=o},h.initElement=function(){var o=this.options,a=o.dragContainer,c=o.checkInput,b=o.preventDefault,v=o.preventClickEventOnDragStart,d=o.preventClickEventOnDrag,p=o.preventClickEventByCondition,S=o.preventRightClick,R=S===void 0?!0:S,M=o.className,O=this.container;this.target=Ta(go("div",{className:"".concat(ya," ").concat(M||"")}),this.target,O);var N=this.target;this.dragContainer=typeof a=="string"?[].slice.call(_t(O).querySelectorAll(a)):a||this.target.parentNode,this.gesto=new El(this.dragContainer,{checkWindowBlur:!0,container:ln(O),checkInput:c,preventDefault:b,preventClickEventOnDragStart:v,preventClickEventOnDrag:d,preventClickEventByCondition:p,preventRightClick:R}).on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd}),Dl(document,"selectstart",this._onDocumentSelectStart),this.injectResult=$a.inject(N,{nonce:this.options.cspNonce})},h.hitTest=function(o,a,c,b){var v=this.options,d=v.hitRate,p=v.selectByClick,S=o.left,R=o.top,M=o.right,O=o.bottom,N=a.innerGroups,q=a.innerWidth,K=a.innerHeight,U=b==null?void 0:b.clientX,se=b==null?void 0:b.clientY,V=a.ignoreClick,B=[[S,R],[M,R],[M,O],[S,O]],ce=function(Pe,Ae){var C=typeof d=="function"?fa("".concat(d(Ae))):fa("".concat(d)),k=V?!1:Ll([U,se],Pe);if(!c&&p&&k)return!0;var m=da(B,Pe);if(!m.length)return!1;var E=In(m),T=0;if(E===0&&In(Pe)===0?(T=ba(Pe),E=ba(m)):T=In(Pe),C.unit==="px")return E>=C.value;var I=Al(Math.round(E/T*100),0,100);return I>=Math.min(100,C.value)},ae=a.selectableTargets,be=a.selectablePoints,Ve=a.selectableInners;if(!N)return ae.filter(function(Pe,Ae){return Ve[Ae]?ce(be[Ae],ae[Ae]):!1});for(var je=[],ie=Math.floor(S/q),Ue=Math.floor(M/q),Ke=Math.floor(R/K),Je=Math.floor(O/K),Ze=ie;Ze<=Ue;++Ze){var Ne=N[Ze];if(!!Ne)for(var et=Ke;et<=Je;++et){var ot=Ne[et];!ot||ot.forEach(function(Pe){var Ae=be[Pe],C=Ve[Pe],k=ae[Pe];C&&ce(Ae,k)&&je.push(k)})}}return vo(je)},h.initDragScroll=function(){var o=this;this.dragScroll.on("scrollDrag",function(a){var c=a.next;c(o.gesto.getCurrentEvent())}).on("scroll",function(a){var c=a.container,b=a.direction,v=o.gesto.getEventData().innerScrollOptions;v?o.emit("innerScroll",{container:c,direction:b}):o.emit("scroll",{container:c,direction:b})}).on("move",function(a){var c=a.offsetX,b=a.offsetY,v=a.inputEvent,d=o.gesto;if(!(!d||!d.isFlag())){var p=o.gesto.getEventData(),S=p.boundArea;p.startX-=c,p.startY-=b;var R=o.gesto.getEventData().innerScrollOptions,M=R==null?void 0:R.container,O=!1;if(M){var N=p.selectableInnerScrollParentMap,q=N.get(M);q&&(q.paths.forEach(function(K){var U=N.get(K);U.points.forEach(function(se){se[0]-=c,se[1]-=b})}),q.indexes.forEach(function(K){p.selectablePoints[K].forEach(function(U){U[0]-=c,U[1]-=b})}),O=!0)}O||p.selectablePoints.forEach(function(K){K.forEach(function(U){U[0]-=c,U[1]-=b})}),o._refreshGroups(p),S.left-=c,S.right-=c,S.top-=b,S.bottom-=b,o.gesto.scrollBy(c,b,v.inputEvent),o._checkSelected(o.gesto.getCurrentEvent())}})},h._select=function(o,a,c,b,v){v===void 0&&(v=!1);var d=c.inputEvent,p=c.data,S=this.setSelectedTargets(o),R=Bt(p.startSelectedTargets,o),M=R.added,O=R.removed,N=R.prevList,q=R.list,K={startSelected:N,startAdded:M.map(function(U){return q[U]}),startRemoved:O.map(function(U){return N[U]})};b&&this.emit("selectStart",$e($e($e({},S),K),{rect:a,inputEvent:d,data:p.data,isTrusted:c.isTrusted,isDragStartEnd:v})),(S.added.length||S.removed.length)&&this.emit("select",$e($e($e({},S),K),{rect:a,inputEvent:d,data:p.data,isTrusted:c.isTrusted,isDragStartEnd:v}))},h._selectEnd=function(o,a,c,b,v){v===void 0&&(v=!1);var d=b.inputEvent,p=b.isDouble,S=b.data,R=d&&d.type,M=R==="mousedown"||R==="touchstart",O=Bt(o,this.selectedTargets),N=O.added,q=O.removed,K=O.prevList,U=O.list,se=Bt(a,this.selectedTargets),V=se.added,B=se.removed,ce=se.prevList,ae=se.list;this.emit("selectEnd",{startSelected:o,beforeSelected:a,selected:this.selectedTargets,added:N.map(function(be){return U[be]}),removed:q.map(function(be){return K[be]}),afterAdded:V.map(function(be){return ae[be]}),afterRemoved:B.map(function(be){return ce[be]}),isDragStart:M&&v,isDragStartEnd:M&&v,isClick:!!b.isClick,isDouble:!!p,rect:c,inputEvent:d,data:S.data,isTrusted:b.isTrusted})},h._checkSelected=function(o,a){a===void 0&&(a=ha(o,this.options.ratio));var c=o.data,b=a.top,v=a.left,d=a.width,p=a.height,S=c.selectFlag,R=c.containerX,M=c.containerY,O=c.scaleMatrix,N=Sn(O,[v-R,b-M]),q=Sn(O,[d,p]),K=[];if(S){this.target.style.cssText+="display: block;left:0px;top:0px;"+"transform: translate(".concat(N[0],"px, ").concat(N[1],"px);")+"width:".concat(q[0],"px;height:").concat(q[1],"px;");var U=this.hitTest(a,c,!0,o);K=ma(c.startPassedTargets,U,this.continueSelect&&this.continueSelectWithoutDeselect)}var se=this.emit("drag",$e($e({},o),{data:c.data,isSelect:S,rect:a}));if(se===!1){this.target.style.cssText+="display: none;",o.stop();return}S&&this._select(K,a,o)},h._sameCombiKey=function(o,a,c){if(!a)return!1;var b=Tl(o.inputEvent,o.key),v=[].concat(a),d=$l(v[0])?v:[v];if(c){var p=o.key;return d.some(function(S){return S.some(function(R){return R===p})})}return d.some(function(S){return S.every(function(R){return b.indexOf(R)>-1})})},h._findElement=function(o,a){for(var c=o;c&&!(a.indexOf(c)>-1);)c=c.parentElement;return c},h._refreshGroups=function(o){var a,c=o.innerWidth,b=o.innerHeight,v=o.selectablePoints;if(this.options.checkOverflow){var d=(a=this.gesto.getEventData().innerScrollOptions)===null||a===void 0?void 0:a.container,p=o.selectableInnerScrollParentMap,S=o.selectableInnerScrollPathsList;o.selectableInners=S.map(function(O,N){var q=!1;return O.every(function(K){if(q)return!0;if(K===d)return q=!0,!0;var U=p.get(K);if(U){var se=v[N],V=U.points,B=da(se,V);if(!B.length)return!1}return!0})})}if(!c||!b)o.innerGroups=null;else{var R=o.selectablePoints,M={};R.forEach(function(O,N){var q=1/0,K=-1/0,U=1/0,se=-1/0;O.forEach(function(ce){var ae=Math.floor(ce[0]/c),be=Math.floor(ce[1]/b);q=Math.min(ae,q),K=Math.max(ae,K),U=Math.min(be,U),se=Math.max(be,se)});for(var V=q;V<=K;++V)for(var B=U;B<=se;++B)M[V]=M[V]||{},M[V][B]=M[V][B]||[],M[V][B].push(N)}),o.innerGroups=M}},u=uo([Rl(Gn,function(o,a){var c={enumerable:!0,configurable:!0,get:function(){return this.options[a]}},b=va("get ".concat(a));o[b]?c.get=function(){return this[b]()}:c.get=function(){return this.options[a]};var v=va("set ".concat(a));o[v]?c.set=function(d){this[v](d)}:c.set=function(d){this.options[a]=d},Object.defineProperty(o,a,c)})],u),u}(Pl),yo=function(i){Da(u,i);function u(){return i!==null&&i.apply(this,arguments)||this}return u}(bo),_o=yo,Ut=function(){return Ut=Object.assign||function(u){for(var h,o=1,a=arguments.length;o<a;o++){h=arguments[o];for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&(u[c]=h[c])}return u},Ut.apply(this,arguments)},Pa={};mo.forEach(function(i){Pa[i]=function(){for(var u,h=[],o=0;o<arguments.length;o++)h[o]=arguments[o];return(u=this.$_selecto)[i].apply(u,h)}});var Ma={};Gn.forEach(function(i){Ma[i]=function(u){return this.$_selecto[i]=u}});var Fn=zn({name:"selecto",methods:Pa,props:_a,watch:Ma,mounted:function(){var i=this,u=this.$props,h={};_a.forEach(function(a){var c=u[a];xa(c)||(h[a]=c)});var o=new _o(Ut(Ut({},h),{portalContainer:this.$refs.selectoElement}));this.$_selecto=o,ho.forEach(function(a){o.on(a,function(c){i.$emit(a,Ut({},c))})})},beforeUnmount:function(){this.$_selecto.destroy()}});const ko={ref:"selectoElement"};function Co(i,u,h,o,a,c){return D(),de("div",ko,null,512)}Fn.render=Co;Fn.__file="src/Selecto.vue";const Oa=i=>(Rn("data-v-dcfbc98a"),i=i(),jn(),i),xo={class:"tools flex column"},wo={key:0,class:"grid gap-4 grid-cols-4 grid-flow-row auto-rows-max p-4"},So={class:"tool-wrapper"},Io=["onClick"],Eo={class:"flex flex-col flex-nowrap items-center justify-center h-full"},Do={class:"grow leading-4 text-black text-center text-ellipsis overflow-hidden flex items-center"},To={key:1,class:"flex p-4 items-center justify-center"},$o=Oa(()=>g("p",{class:"text-center"},[$(" The library is empty. "),g("br"),g("br"),$(" You can select some objects and save them"),g("br"),$(" to the library to easily reuse them. ")],-1)),Po=[$o],Mo={key:0,class:"grid gap-4 grid-cols-4 grid-flow-row auto-rows-max p-4"},Oo={class:"tool-wrapper"},zo=["onClick"],Lo={class:"flex flex-col items-center justify-center h-full"},Ro=["src"],jo={key:1,class:"flex p-4 items-center justify-center"},Ao=Oa(()=>g("div",{class:"text-h6"},"Upload image",-1)),Wo={__name:"ToolsSidebar",props:{selectedTool:{type:Object,required:!0},images:{type:Array,default:()=>[]},objectLib:{type:Array,default:()=>[]},isBuiltInEdge:{type:Boolean}},emits:["selectTool","saveLibImage","deleteLibItem","renameLibItem","deleteLibImage","toolDropped"],setup(i,{emit:u}){ka(V=>({"4215c46a":y(se)}));const h=i,o=u,a=Wn(),c=ne(null),b=ne("lib");function v(V,B="default"){o("selectTool",V,B)}function d(V){a.dialog({title:"Confirm",message:"Are you sure you want to delete this library item?",cancel:!0}).onOk(()=>{o("deleteLibItem",V)}).onCancel(()=>{}).onDismiss(()=>{})}function p(V){a.dialog({title:"Confirm",message:"Are you sure you want to delete this image?",cancel:!0}).onOk(()=>{o("deleteLibImage",V)}).onCancel(()=>{}).onDismiss(()=>{})}function S(V){a.dialog({title:"Rename",message:"Type the new name",prompt:{model:V.label,type:"text"},cancel:!0,persistent:!0}).onOk(B=>{!B||o("renameLibItem",V,B)}).onCancel(()=>{}).onDismiss(()=>{})}const R=ne("list"),M=ne({uploadBtnDisabled:!0,uploadBtnLoading:!1,file:null});function O(V){console.log("file",V),M.value.uploadBtnDisabled=!1,M.value.file=V}function N(){kt.value?c.value.upload():K(M.value.file)}function q(V){K(V.body)}function K(V){o("saveLibImage",V),R.value="list",M.value.file=null}function U(V,B){o("toolDropped",V,B)}let se=ne("37px");return se.value=h.isBuiltInEdge?"37px":"93px",Ln(()=>h.isBuiltInEdge,V=>{se.value=V?"37px":"93px"}),(V,B)=>(D(),de("div",xo,[(D(!0),de(Ct,null,Dt(y(no),ce=>(D(),X(na,{key:ce,class:"mb-2 border border-solid border-gray-700",dark:"","default-opened":"",label:ce,"header-class":"p-2 min-h-0","expand-icon-class":"!pl-2"},{default:l(()=>[t(lt,{class:"rounded-borders text-primary grid grid-cols-2 gap-1 p-1"},{default:l(()=>[(D(!0),de(Ct,null,Dt(y(Xe).filter(ae=>ae.cat.includes(ce)),ae=>ue((D(),X(oe,{key:ae.name,onClick:be=>v(ae),onDragend:be=>U(be,ae),clickable:"",active:i.selectedTool.name===ae.name,"active-class":"active-tool",draggable:"true",class:"p-2 min-h-0"},{default:l(()=>[t(ge,{anchor:"center right",self:"center left"},{default:l(()=>[$(Oe(ae.label),1)]),_:2},1024),t(P,null,{default:l(()=>[t(Yt,{name:ae.icon,size:"sm"},null,8,["name"])]),_:2},1024)]),_:2},1032,["onClick","onDragend","active"])),[[la]])),128))]),_:2},1024)]),_:2},1032,["label"]))),128)),t(na,{class:"mb-2 border border-solid border-gray-700",dark:"","default-opened":"",label:"User","header-class":"p-2 min-h-0","expand-icon-class":"!pl-2"},{default:l(()=>[t(lt,{class:"rounded-borders text-primary grid grid-cols-2 gap-1 p-1"},{default:l(()=>[ue((D(),X(oe,{clickable:"","active-class":"active-tool",active:i.selectedTool.type!=="default",class:"p-2 min-h-0"},{default:l(()=>[t(ge,{anchor:"center right",self:"center left"},{default:l(()=>[$(" User objects library ")]),_:1}),t(xt,{"separate-close-popup":"",anchor:"bottom right",self:"bottom left","max-height":"650px",onHide:B[7]||(B[7]=ce=>R.value="list")},{default:l(()=>[t(Tt,{dark:"",style:{"min-width":"500px",height:"400px"}},{default:l(()=>[t(Sa,{modelValue:b.value,"onUpdate:modelValue":B[0]||(B[0]=ce=>b.value=ce),"inline-label":"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(Lt,{name:"lib",icon:"library_books",label:"Library"}),t(Lt,{name:"imgs",icon:"collections",label:"Images"})]),_:1},8,["modelValue"]),t(_e),t(Mn,{modelValue:b.value,"onUpdate:modelValue":B[6]||(B[6]=ce=>b.value=ce),animated:"",dark:"",style:{"max-height":"350px"},class:"scroll"},{default:l(()=>[t($t,{name:"lib"},{default:l(()=>{var ce;return[((ce=i.objectLib)==null?void 0:ce.length)>0?(D(),de("div",wo,[(D(!0),de(Ct,null,Dt(i.objectLib,ae=>(D(),de("div",{key:ae.id,class:"relative"},[g("div",So,[t(J,{round:"",dense:"",color:"grey-7",icon:"more_vert",size:"sm"},{default:l(()=>[t(xt,{"separate-close-popup":""},{default:l(()=>[t(lt,{style:{"min-width":"100px"}},{default:l(()=>[ue((D(),X(oe,{clickable:"",onClick:be=>S(ae)},{default:l(()=>[t(P,null,{default:l(()=>[$("Rename")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),ue((D(),X(oe,{clickable:"",onClick:be=>d(ae)},{default:l(()=>[t(P,null,{default:l(()=>[$("Delete")]),_:1})]),_:2},1032,["onClick"])),[[ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024),ue((D(),de("div",{class:"w-24 h-24 bg-slate-200 hover:bg-slate-500 p-2 rounded-lg cursor-pointer",onClick:be=>v(ae,"libItem")},[g("div",Eo,[g("div",null,[t(Yt,{color:"blue-10",name:"library_books",size:"xl"})]),g("div",Do,Oe(ae.label),1)])],8,Io)),[[ve]])])]))),128))])):(D(),de("div",To,Po))]}),_:1}),t($t,{name:"imgs",class:"py-1"},{default:l(()=>[t(Mn,{modelValue:R.value,"onUpdate:modelValue":B[5]||(B[5]=ce=>R.value=ce),animated:"",dark:""},{default:l(()=>[t($t,{name:"list",class:"p-0"},{default:l(()=>{var ce;return[t(J,{dense:"",onClick:B[1]||(B[1]=ae=>R.value="upload"),icon:"library_add",color:"white","text-color":"black",label:"Add Image"}),((ce=i.images)==null?void 0:ce.length)>0?(D(),de("div",Mo,[(D(!0),de(Ct,null,Dt(i.images,ae=>(D(),de("div",{key:ae.id,class:"relative"},[g("div",Oo,[t(J,{round:"",dense:"",color:"grey-7",icon:"more_vert",size:"sm"},{default:l(()=>[t(xt,null,{default:l(()=>[t(lt,{style:{"min-width":"100px"}},{default:l(()=>[ue((D(),X(oe,{clickable:"",onClick:be=>p(ae)},{default:l(()=>[t(P,null,{default:l(()=>[$("Delete")]),_:1})]),_:2},1032,["onClick"])),[[ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024),ue((D(),de("div",{class:"w-24 h-24 bg-slate-200 hover:bg-slate-500 p-2 rounded-lg cursor-pointer",onClick:be=>v(ae,"Image")},[g("div",Lo,[g("img",{src:ae.path+"?w=95&h=95"},null,8,Ro)])],8,zo)),[[ve]])])]))),128))])):(D(),de("div",jo," No images yet. "))]}),_:1}),t($t,{name:"upload",class:"p-0"},{default:l(()=>[t(Tt,{dark:"",style:{"max-width":"468px"}},{default:l(()=>[t(vt,{class:"py-1"},{default:l(()=>[Ao]),_:1}),t(vt,{class:"q-pt-none"},{default:l(()=>[t(to,{ref_key:"fileUploaderRef",ref:c,path:"lib-images",types:["image/*"],height:240,onFileAdded:O,onFileRemoved:B[2]||(B[2]=ce=>M.value.uploadBtnDisabled=!0),onUploaded:q},null,512)]),_:1}),t($n,{align:"right",class:"text-primary pb-0"},{default:l(()=>[t(J,{flat:"",label:"Cancel",onClick:B[3]||(B[3]=ce=>R.value="list")}),t(J,{disabled:M.value.uploadBtnDisabled,loading:M.value.uploadBtnLoading,flat:"",label:"Save",onClick:B[4]||(B[4]=ce=>N())},null,8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(P,null,{default:l(()=>[t(Yt,{name:"add_circle_outline",size:"sm"})]),_:1})]),_:1},8,["active"])),[[la]])]),_:1})]),_:1})]))}};var Go=rn(Wo,[["__scopeId","data-v-dcfbc98a"]]);const Fo={name:"CanvasShape",props:{item:{type:Object,required:!0}},emits:["updateWeldModel"],setup(i,{emit:u}){const h=ne(null),o=ne(null),a=ne(null),c=()=>{var k;const C=document.getElementById(`canvas${i.item.id}`);a.value=new De.Project(C),(k=a==null?void 0:a.value)==null||k.clear(),De.settings.insertItems=!1,b()},b=()=>{const C=o.value;if(C){const{width:k,height:m}=i.item;C.width=k,C.height=m,C.style.width=`${k}px`,C.style.height=`${m}px`,a.value.view.viewSize=new De.Size(C.width,C.height),Ae()}},v=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=C=="weld"?8:4,W=new De.Path.Rectangle({point:T,size:[m-j,E-j],strokeColor:I.bgColor||"#000",strokeWidth:2,fillColor:I.fillColor});return C=="weld"&&w&&W.rotate(w),W},d=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=C=="weld"?8:4,W=m/2+T[0],z=E/2+T[1];return new De.Path.Circle({center:[W,z],radius:Math.min(m-j,E-j)/2,strokeColor:I.bgColor||"#000",strokeWidth:2,fillColor:I.fillColor})},p=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=1,W=`<svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 32 32"
            height="${E}"
            width="${m}"
            version="1.1">
            <path d="M 1.6 5.4 L 25.6 5.4 L 30.4 15 L 25.6 24.6 L 1.6 24.6 L 6.4 15 Z" fill="${I.fillColor}" stroke="${I.bgColor||"#000"}"
              stroke-width="${j}" stroke-miterlimit="10"></path>
          </svg>
          `;return M(W)},S=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=1,W=`<svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 32 32"
            height="${E}"
            width="${m}"
            version="1.1">
            <path d="M 6.4 5.4 L 25.6 5.4 L 30.4 15 L 25.6 24.6 L 6.4 24.6 L 1.6 15 Z" fill="${I.fillColor}" stroke="${I.bgColor||"#000"}"
              stroke-width="${j}" stroke-miterlimit="10">
            </path>
         </svg>
        `;return M(W)},R=(C,k,m,E,T,I)=>{const{settings:w,rotate:j}=k,W=new De.Path({segments:m,closed:!0,strokeColor:"#000",strokeWidth:2,fillColor:"#659dc5"});return j&&W.rotate(j),W},M=C=>De.project.importSVG(C,{applyMatrix:!1}),O=C=>{C==null||C.map((k,m)=>{const{width:E,height:T,weldModel:I,cat:w,type:j,settings:W}=k,z=[];switch(j){case"G_Rectangle":z.push(v("",k,E,T,[2,2]));break;case"G_Circle":z.push(d("",k,E,T,[2,2]));break;case"G_Step":z.push(p("",k,E,T));break;case"G_Hexagon":z.push(S("",k,E,T));break}z==null||z.map((F,le)=>{a.value.activeLayer.addChild(F)})})},N=ne(i.item.width),q=ne(i.item.height);ne(i.item.settings.fillColor);const K=()=>{const C=i.item.width/N.value,k=i.item.height/q.value,m=i.item.translate[0]/N.value,E=i.item.translate[1]/q.value;return{widthScale:C,heightScale:k,trsXScale:m,trsYScale:E}},U=ne(0),se=ne(0),V=(C,k)=>{U.value=Math.min(...C.map(A=>A.translate[0])),se.value=Math.min(...C.map(A=>A.translate[1]));const m=K();let{width:E,height:T,cat:I,type:w,translate:j}=k,[W,z]=j,F=W-U.value+4,le=z-se.value+4;return E=E*m.widthScale,T=T*m.heightScale,W*=m.widthScale,z*=m.heightScale,W-=U.value*m.widthScale,z-=se.value*m.heightScale,F=W+4,le=z+4,{width:E,height:T,trsx:F,trsy:le}},B=(C,k)=>{let{width:m,height:E,cat:T,type:I,translate:w,rotate:j,overlap:W}=k,[z,F]=w;const{isStartOverlap:le,isEndOverlap:A}=W,Ce=()=>{let xe=25,he=25,te=0;return m>50&&(m<80?xe=he=m/2:(xe=40,he=40,te=m-80)),{startW:xe,middle:te,endW:he}},qe=(xe,he)=>{const te=[],pt=Ce(),wt=[xe,he];te.push(wt);const cn=[xe+pt.startW,he+E/2],Nt=[xe,he+E];le||te.push(cn),te.push(Nt);const st=[xe+pt.startW+pt.middle,he+E],un=[xe+m,he+E];A?te.push(un):te.push(st);const dn=[xe+m,he+E/2];A||te.push(dn);const fn=[xe+m,he],qt=[xe+pt.startW+pt.middle,he];return A?te.push(fn):te.push(qt),te.push(wt),te},L=Math.min(...C.map(xe=>xe.translate[0])),H=Math.min(...C.map(xe=>xe.translate[1])),fe=K();let ze=z-L+4,Le=F-H+4;return m=m*fe.widthScale,E=E*fe.heightScale,z*=fe.widthScale,F*=fe.heightScale,z-=L*fe.widthScale,F-=H*fe.heightScale,ze=z+4,Le=F+4,{pathPoints:qe(ze,Le),width:m,height:E,trsx:ze,trsy:Le}},ce=C=>C==null?void 0:C.map((m,E)=>{let T=null;const I=V(C,m);switch(m.type){case"G_Rectangle":T=v("weld",m,I.width,I.height,[I.trsx,I.trsy]);break;case"G_Circle":T=d("weld",m,I.width,I.height,[I.trsx,I.trsy]);break;case"G_Step":T=p("weld",m,I.width,I.height);break;case"G_Hexagon":T=S("weld",m,I.width,I.height);break;case"Duct":const w=B(C,m);T=R("weld",m,w.pathPoints);break}return{type:m.type,pathItem:T,item:m,newPos:{width:I.width,height:I.height,trsx:I.trsx-4,trsy:I.trsy-4}}}),ae=C=>{let k=[];return C instanceof De.Path||C instanceof De.CompoundPath||C instanceof De.Path.Circle?k.push(C):C instanceof De.Group?C.children.forEach(m=>{k=k.concat(ae(m))}):C!=null&&C.children&&(C==null||C.children.forEach(m=>{k=k.concat(ae(m))})),k},be=C=>C.flatMap(m=>{const I=ae(m.pathItem).flatMap(w=>w.segments.map(j=>j.point)).map(w=>new De.Point(w));return I.push(I[0]),{type:m.type,points:I}}),Ve=C=>{let k=[];return C.slice(0,-1).map((m,E)=>{const T=m,I=C[E+1],w=4,j=2,W=new De.Path.Circle({center:T,radius:w,fillColor:"#4af"}),z=new De.Path.Circle({center:I,radius:w,fillColor:"#4af"}),F=new De.Path.Line({from:T,to:I,strokeColor:"#000",strokeWidth:j,fillColor:"#f36dc5"});k.push({name:`Path Line ${E+1}`,path:F,startPoint:W,endPoint:z})}),k},je=(C,k,m,E,T)=>{const I=C.startPoint,w=C.endPoint,j=C.path;function W(){if(m>0){const L=k[m-1];L.endPoint.position=I.position,L.path.segments[1].point=I.position}else{const L=k[k.length-1];L.endPoint.position=I.position,L.path.segments[1].point=I.position}}function z(){if(m===k.length-1){const L=k[0];L.startPoint.position=w.position,L.path.segments[0].point=w.position}else{const L=k[m+1];L.startPoint.position=w.position,L.path.segments[0].point=w.position}}function F(L){E!==null&&(E.segments[m].point=I.position,E.segments[m+1].point=w.position,m+2==E.segments.length&&(E.segments[0].point=w.position),m==0&&(E.segments[E.segments.length-1].point=I.position))}function le(){j.segments[0].point=I.position,j.segments[1].point=w.position}function A(L){if(m>0){const H=k[m-1];H.endPoint.position=L,H.path.segments[1].point=L}else{const H=k[k.length-1];H.endPoint.position=L,H.path.segments[1].point=L}}function Ce(L){if(m===k.length-1){const H=k[0];H.startPoint.position=L,H.path.segments[0].point=L}else{const H=k[m+1];H.startPoint.position=L,H.path.segments[0].point=L}}function qe(L){if(T===null)return;const{crossStartIndex:H,crossEndIndex:fe}=C.crossPathIndex,{crossedStartIndex:ze,crossedEndIndex:Le}=C.crossedPathIndex;T.forEach((it,xe)=>{const{crossPath:he,crossLinePoints:te}=it;he.segments[H]!==null&&he.segments[H]!==void 0&&(he.segments[H].point=I.position),he.segments[fe]!==null&&he.segments[fe]!==void 0&&(he.segments[fe].point=w.position),he.segments[he.segments.length-1].point=he.segments[0].point,te[ze]!==null&&te[ze]!==void 0&&(te[ze].startPoint.position=I.position,te[ze].path.segments[0].point=I.position),te[Le]!==null&&te[Le]!==void 0&&(te[Le].endPoint.position=w.position,te[Le].path.segments[1].point=w.position),te[ze-1]!=null&&te[ze-1]!=null&&(te[ze-1].endPoint.position=I.position,te[ze-1].path.segments[1].point=I.position),fe!==-1&&te[Le+1]!=null&&te[Le+1]!=null&&(te[Le+1].startPoint.position=w.position),te[te.length-1]!==null&&te[te.length-1]!==void 0&&(te[te.length-1].endPoint.position=te[0].startPoint.position)})}I.onMouseDrag=function(L){this.position=this.position.add(L.delta),le(),F(`startCircle=>[x=${this.position.x},y=${this.position.y}]`),W(),qe()},w.onMouseDrag=function(L){this.position=this.position.add(L.delta),le(),F(`endCircle=>[x=${this.position.x},y=${this.position.y}]`),z(),qe()},j.onMouseDrag=function(L){const H=L.delta;I.position=I.position.add(H),w.position=w.position.add(H),le(),F(`line=>[x=${I.position.x},y=${I.position.y}], [x=${w.position.x},y=${w.position.y}]`),A(I.position),Ce(w.position),qe()}},ie=(C,k,m,E,T,I)=>{function w(){if(m>0){const L=k[m-1];L.endPoint.position=A.position,L.path.segments[1].point=A.position}else{const L=k[k.length-1];L.endPoint.position=A.position,L.path.segments[1].point=A.position}}function j(){if(m===k.length-1){const L=k[0];L.startPoint.position=Ce.position,L.path.segments[0].point=Ce.position}else{const L=k[m+1];L.startPoint.position=Ce.position,L.path.segments[0].point=Ce.position}}function W(L){T!==null&&(T.segments[m].point=A.position,T.segments[m+1].point=Ce.position,m+2==T.segments.length&&(T.segments[0].point=Ce.position),m==0&&(T.segments[T.segments.length-1].point=A.position))}function z(){qe.segments[0].point=A.position,qe.segments[1].point=Ce.position}function F(L){if(m>0){const H=k[m-1];H.endPoint.position=L,H.path.segments[1].point=L}else{const H=k[k.length-1];H.endPoint.position=L,H.path.segments[1].point=L}}function le(L){if(m===k.length-1){const H=k[0];H.startPoint.position=L,H.path.segments[0].point=L}else{const H=k[m+1];H.startPoint.position=L,H.path.segments[0].point=L}}const A=C.startPoint,Ce=C.endPoint,qe=C.path;A.onMouseDrag=function(L){this.position=this.position.add(L.delta),z(),W(`startCircle=>[x=${this.position.x},y=${this.position.y}]`),w()},Ce.onMouseDrag=function(L){this.position=this.position.add(L.delta),z(),W(`endCircle=>[x=${this.position.x},y=${this.position.y}]`),j()},qe.onMouseDrag=function(L){const H=L.delta;A.position=A.position.add(H),Ce.position=Ce.position.add(H),z(),W(`line=>[x=${A.position.x},y=${A.position.y}], [x=${Ce.position.x},y=${Ce.position.y}]`),F(A.position),le(Ce.position)},T.onMouseDrag=function(L){const H=L.delta;T.position.x+=H.x,k.map((fe,ze)=>{fe.startPoint.position.x+=H.x,fe.endPoint.position.x+=H.x,fe.path.segments[0].point.x=fe.startPoint.position.x,fe.path.segments[1].point.x=fe.endPoint.position.x;const{weldStartIndex:Le,weldEndIndex:it}=fe.weldPathIndex,{weldedStartIndex:xe,weldedEndIndex:he}=fe.weldedPathIndex;E.segments[Le]!==null&&E.segments[Le]!==void 0&&(E.segments[Le].point=fe.startPoint.position),E.segments[it]!==null&&E.segments[it]!==void 0&&(E.segments[it].point=fe.endPoint.position),I[xe]!==null&&I[xe]!==void 0&&(I[xe].startPoint.position=fe.startPoint.position,I[xe].path.segments[0].point=fe.startPoint.position),I[he]!==null&&I[he]!==void 0&&(I[he].endPoint.position=fe.endPoint.position,I[he].path.segments[1].point=fe.endPoint.position)})}},Ue=(C,k,m,E)=>{C.map((T,I)=>{const w=T.startPoint,j=T.endPoint,W=m.segments.findIndex(A=>A.point.x.toFixed(4)===w.position.x.toFixed(4)&&A.point.y.toFixed(4)===w.position.y.toFixed(4)),z=m.segments.findIndex(A=>A.point.x.toFixed(4)===j.position.x.toFixed(4)&&A.point.y.toFixed(4)===j.position.y.toFixed(4)),F=k.findIndex(A=>A.startPoint.position.x.toFixed(4)===w.position.x.toFixed(4)&&A.startPoint.position.y.toFixed(4)===w.position.y.toFixed(4)),le=k.findIndex(A=>A.endPoint.position.x.toFixed(4)===j.position.x.toFixed(4)&&A.endPoint.position.y.toFixed(4)===j.position.y.toFixed(4));T.weldPathIndex={weldStartIndex:W,weldEndIndex:z},T.weldedPathIndex={weldedStartIndex:F,weldedEndIndex:le}}),k.map((T,I)=>{const w=T.startPoint,j=T.endPoint,W=E.segments.findIndex(A=>A.point.x.toFixed(4)===w.position.x.toFixed(4)&&A.point.y.toFixed(4)===w.position.y.toFixed(4)),z=E.segments.findIndex(A=>A.point.x.toFixed(4)===j.position.x.toFixed(4)&&A.point.y.toFixed(4)===j.position.y.toFixed(4)),F=C.findIndex(A=>A.startPoint.position.x.toFixed(4)===w.position.x.toFixed(4)&&A.startPoint.position.y.toFixed(4)===w.position.y.toFixed(4)),le=C.findIndex(A=>A.endPoint.position.x.toFixed(4)===j.position.x.toFixed(4)&&A.endPoint.position.y.toFixed(4)===j.position.y.toFixed(4));T.crossPathIndex={crossStartIndex:W,crossEndIndex:z},T.crossedPathIndex={crossedStartIndex:F,crossedEndIndex:le}})},Ke=C=>{let k=[];return C.slice(0,-1).map((m,E)=>{const T=m,I=C[E+1],w=4,j=2,W=new De.Path.Circle({center:T,radius:w,fillColor:"#4af"}),z=new De.Path.Circle({center:I,radius:w,fillColor:"#4af"}),F=new De.Path.Line({from:T,to:I,strokeColor:"#000",strokeWidth:j,fillColor:"green"});k.push({name:`Cross Path Line ${E+1}`,path:F,startPoint:W,endPoint:z})}),k},Je=C=>C.map((m,E)=>new De.Path({segments:m.points,closed:!0,strokeColor:"#000",fillColor:"#f36dc5"})),Ze=(C,k)=>{if(!(C!==null&&C!=null&&C.length>0))return;const E=new De.Path({segments:C,closed:!0,fillColor:"#659dc5"}),T=Ve(C),I=k.map((w,j)=>{const W=new De.Path({segments:w.pts,closed:!0,fillColor:"#659dc5"}),z=Ke(w.pts);return Ue(z,T,E,W),z.map((F,le)=>{ie(F,z,le,E,W,T)}),{crossPath:W,crossLinePoints:z}});T.map((w,j)=>{je(w,T,j,E,I)}),a.value.activeLayer.addChild(E),I.map((w,j)=>{var W,z;(z=(W=a==null?void 0:a.value)==null?void 0:W.activeLayer)==null||z.addChild(w.crossPath)}),T.map((w,j)=>{var W,z,F,le,A,Ce;(z=(W=a==null?void 0:a.value)==null?void 0:W.activeLayer)==null||z.addChild(w.path),(le=(F=a==null?void 0:a.value)==null?void 0:F.activeLayer)==null||le.addChild(w.startPoint),(Ce=(A=a==null?void 0:a.value)==null?void 0:A.activeLayer)==null||Ce.addChild(w.endPoint)})},Ne=C=>{let k=-1/0,m=-1/0;for(const E of C){const T=Math.min(...E.points.map(w=>w==null?void 0:w.x)),I=Math.min(...E.points.map(w=>w==null?void 0:w.y));if(T>k||I>m)k=Math.max(...E.points.map(w=>w==null?void 0:w.x)),m=Math.max(...E.points.map(w=>w==null?void 0:w.y));else return!0}return!1},et=()=>{var W;const{weldItems:C}=i.item,k=ce(C);u("updateWeldModel",i.item,k),N.value=i.item.width,q.value=i.item.height,U.value=Math.min(...i.item.weldItems.map(z=>z.translate[0])),se.value=Math.min(...i.item.weldItems.map(z=>z.translate[1]));const m=be(k);if(!Ne(m)){k.map((z,F)=>{a.value.activeLayer.addChild(z.pathItem)});return}const T=Je(m),I=Pe("union",T),w=(W=I==null?void 0:I.segments)==null?void 0:W.map(z=>z.point);w==null||w.push(w[0]);const j=ot(T,w);Ze(w,j)},ot=(C,k)=>{const E=(j=>{const W=[];for(let z=0;z<j.length;z++)for(let F=z+1;F<j.length;F++)j[z].getIntersections(j[F]).forEach(A=>{W.push(A.point)});return W})(C),I=((j,W)=>j.map(F=>{const le=W.findIndex(A=>(A==null?void 0:A.x.toFixed(4))===(F==null?void 0:F.x.toFixed(4))&&(A==null?void 0:A.y.toFixed(4))===(F==null?void 0:F.y.toFixed(4)));return{crossPoint:F,index:le}}).sort((F,le)=>le.index-F.index))(E,k),w=[];for(let j=I.length-1;j>0;j-=2){const W=I[j].index,z=I[j-1].index,F=[];for(let le=W;le<=z;le++)F.push(k[le]);F.push(F[0]),w.push({idx:`${W}-${z}`,pts:F})}return w},Pe=(C,k)=>{if(k.length===0)return[];if(k.length<2)return k[0];let m=k[0];for(let E=1;E<k.length;E++)switch(C){case"union":m=m.unite(k[E]);break;case"difference":m=m.subtract(k[E]);break;case"xor":m=m.exclude(k[E]);break;case"intersection":m=m.intersect(k[E]);break;default:throw new Error("Invalid boolean operation")}return m},Ae=()=>{var w;const{width:C,height:k,weldModel:m,cat:E,type:T,settings:I}=i.item;(w=a==null?void 0:a.value)==null||w.clear(),T==="Weld_General"||T==="Weld_Duct"?et():O([i.item])};return An(()=>{c(),Ln(()=>[i.item.width,i.item.height,i.item.settings],b,{deep:!0}),window.addEventListener("resize",b)}),Ca(()=>{var C;(C=a.value)==null||C.clear(),window.removeEventListener("resize",b)}),{canvasContainer:h,canvas:o,initCanvas:c,resizeCanvas:b,draw:Ae,loadSvgString:M,booleanOperation:Pe}}},Vo={ref:"canvasContainer",class:"canvas-container"},Bo=["id"];function Yo(i,u,h,o,a,c){return D(),de("div",Vo,[g("canvas",{id:`canvas${h.item.id}`,ref:"canvas",resize:"",stats:"",class:"canvas-normal"},null,8,Bo)],512)}var Xo=rn(Fo,[["render",Yo],["__scopeId","data-v-083c08a3"]]);const Uo=zn({name:"NewTopToolBar",props:{locked:{type:Boolean,default:!1},grpNav:{type:Array,default:()=>[]},object:{type:Object,required:!1},selectedCount:{type:Number,required:!0},disableUndo:{type:Boolean,required:!1},disableRedo:{type:Boolean,required:!1},disablePaste:{type:Boolean,required:!1},zoom:{type:Number,required:!0},rulersGridVisible:{type:Boolean,required:!1},deviceModel:{type:Object,required:!1}},emits:["navGoBack","lockToggle","menuAction","showMoreDevices"],setup(i,{emit:u}){const h=ne(null),o=ne("Device (-)"),a=cl(),c=ul(),b=q=>{a.push({path:q})},v=()=>{a.push({path:"/login",query:{redirect:c.path}})},d=Wn();function p(q,K=null){u("menuAction",q,K)}function S(){d.cookies.remove("token"),kt.value=null,localStorage.removeItem("user")}const R=ne(i.rulersGridVisible?"Enable":"Disable");Ln(()=>i.rulersGridVisible,q=>{R.value=q?"Enable":"Disable"});const M=()=>{u("navGoBack")},O=()=>{u("lockToggle")},N=()=>{u("showMoreDevices")};return An(()=>{h.value=i.deviceModel,o.value=`Device (${i.deviceModel.data.device})`}),{tab:ne("home"),navGoBack:M,lockToggle:O,menuActionEmit:p,logout:S,tools:Xe,user:kt,showRulersGrid:R,showMoreDevices:N,currentDevice:h,deviceTabTitle:o,devVersion:Xl,navigateTo:b,navigateToLogin:v}}}),pe=i=>(Rn("data-v-72bff07c"),i=i(),jn(),i),No={class:"tool-bar-container"},qo={class:"left-panel"},Ho={class:"tool-title"},Qo=pe(()=>g("p",{style:{"font-size":"12px"}},"T3000 Havc",-1)),Ko={style:{"margin-left":"0px","font-size":"10px",color:"gray","z-index":"99",position:"absolute","margin-top":"0px"}},Jo={class:"tool-btns"},Zo={key:0},ei={key:1},ti=pe(()=>g("strong",null,"Go back",-1)),ni={class:"right-panel"},ai={style:{"margin-left":"auto"}},li={class:"container"},oi={class:"sub-div"},ii={class:"button-row"},si=pe(()=>g("strong",null,"Copy",-1)),ri=pe(()=>g("em",null," (Ctrl + C)",-1)),ci={class:"button-row"},ui=pe(()=>g("strong",null,"Copy",-1)),di=pe(()=>g("em",null," (Ctrl + V)",-1)),fi={class:"sub-div"},vi={class:"button-row"},pi=pe(()=>g("strong",null,"Undo",-1)),gi=pe(()=>g("em",null," (Ctrl + Z)",-1)),hi={class:"button-row"},mi=pe(()=>g("strong",null,"Redo",-1)),bi=pe(()=>g("em",null," (Ctrl + Y)",-1)),yi={class:"sub-div"},_i={class:"button-row"},ki=pe(()=>g("strong",null,"Delete selected",-1)),Ci=pe(()=>g("em",null," (Delete)",-1)),xi={class:"sub-div"},wi={class:"button-row"},Si=pe(()=>g("strong",null,"Group selected",-1)),Ii=pe(()=>g("em",null," (Ctrl + G)",-1)),Ei={class:"button-row"},Di=pe(()=>g("strong",null,"Ungroup selected",-1)),Ti=pe(()=>g("em",null," (Ctrl + Shift + G)",-1)),$i={class:"sub-div"},Pi={class:"button-row"},Mi=pe(()=>g("strong",null,"Add selected to library",-1)),Oi=pe(()=>g("em",null," (Ctrl + L)",-1)),zi={class:"button-row"},Li=pe(()=>g("strong",null,"Duplicate selected",-1)),Ri=pe(()=>g("em",null," (Ctrl + D)",-1)),ji={class:"sub-div"},Ai={class:"button-row"},Wi=pe(()=>g("strong",null,"Weld selected",-1)),Gi=pe(()=>g("em",null," (Ctrl + B)",-1)),Fi={class:"sub-div"},Vi={class:"button-row"},Bi=pe(()=>g("strong",null,"Link",-1)),Yi={class:"button-row"},Xi=pe(()=>g("strong",null,"Convert to",-1)),Ui={class:"sub-div"},Ni={class:"button-row"},qi=pe(()=>g("strong",null,"Rotate 90\xB0",-1)),Hi={class:"button-row"},Qi=pe(()=>g("strong",null,"Rotate -90\xB0",-1)),Ki={class:"sub-div"},Ji={class:"button-row"},Zi=pe(()=>g("strong",null,"Flip horizontal",-1)),es={class:"button-row"},ts=pe(()=>g("strong",null,"Flip vertical",-1)),ns={class:"sub-div"},as={class:"button-row"},ls=pe(()=>g("strong",null,"Bring to front",-1)),os={class:"button-row"},is=pe(()=>g("strong",null,"Send to Back",-1)),ss={class:"sub-div"},rs={class:"button-row"},cs=pe(()=>g("span",{style:{"font-size":"11px"}},"Rulers & Grid",-1)),us={class:"button-row",style:{"margin-top":"-3px"}},ds={class:"flex items-center px-1",style:{"font-size":"12px"}},fs=["value"],vs={class:"container"},ps={class:"sub-div"},gs={class:"button-row"},hs=pe(()=>g("span",{class:"file-short-cut"},"(Ctrl + R)",-1)),ms={class:"sub-div"},bs={class:"button-row"},ys={class:"sub-div"},_s={class:"button-row"},ks={class:"row device-row"},Cs={class:"text-weight-medium select-text"},xs={class:"text-weight-medium select-text"},ws={class:"text-weight-medium select-text"},Ss={class:"text-weight-medium select-text"};function Is(i,u,h,o,a,c){var v;const b=dl("q-link");return D(),de("div",No,[g("div",qo,[g("div",Ho,[Qo,g("span",Ko,Oe(i.devVersion),1)]),g("div",Jo,[t(J,{dense:"",flat:"",round:"",icon:"menu",size:"sm",onClick:i.lockToggle},null,8,["onClick"]),t(J,{icon:i.locked?"lock_outline":"lock_open",class:"lock-btn",flat:"",round:"",dense:"",size:"sm",color:i.locked?"primary":"normal",onClick:i.lockToggle},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[i.locked?(D(),de("strong",ei,"Unlock")):(D(),de("strong",Zo,"Lock"))]),_:1})]),_:1},8,["icon","color","onClick"]),((v=i.grpNav)==null?void 0:v.length)>=0?(D(),X(J,{key:0,icon:"arrow_back",class:"back-btn mr-2",dense:"",round:"",size:"sm",onClick:i.navGoBack},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[ti]),_:1})]),_:1},8,["onClick"])):ke("",!0)])]),g("div",ni,[t(Tt,{class:"right-panel-card"},{default:l(()=>[t(Sa,{modelValue:i.tab,"onUpdate:modelValue":u[1]||(u[1]=d=>i.tab=d),dense:"",class:"right-tab text-white","active-color":"#fff","indicator-color":"#fff",align:"left","narrow-indicator":""},{default:l(()=>[t(Lt,{name:"home","no-caps":"",label:"Home"}),t(Lt,{name:"file","no-caps":"",label:"File"}),t(Lt,{name:"device","no-caps":"",label:`Device (${i.deviceModel.data.device===void 0?"-":i.deviceModel.data.device})`},null,8,["label"]),t(Lt,{name:"newui","no-caps":"",label:"New UI",onClick:u[0]||(u[0]=d=>i.navigateTo("hvac/t2"))}),g("div",ai,[t(J,{flat:"",color:"primary",label:"Login",onClick:i.navigateToLogin},null,8,["onClick"])])]),_:1},8,["modelValue"]),t(_e),t(Mn,{modelValue:i.tab,"onUpdate:modelValue":u[27]||(u[27]=d=>i.tab=d),class:"tab-panel"},{default:l(()=>[t($t,{name:"home",class:"home-panel"},{default:l(()=>[g("div",li,[g("div",oi,[g("div",ii,[t(J,{flat:"",size:"sm",icon:"content_copy","no-caps":"",onClick:u[2]||(u[2]=d=>i.menuActionEmit("copy")),disable:i.selectedCount<1},{default:l(()=>[$("Copy "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[si,ri]),_:1})]),_:1},8,["disable"])]),g("div",ci,[t(J,{flat:"",size:"sm",icon:"content_paste","no-caps":"",onClick:u[3]||(u[3]=d=>i.menuActionEmit("paste")),disable:i.disablePaste},{default:l(()=>[$("Paste "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ui,di]),_:1})]),_:1},8,["disable"])])]),g("div",fi,[g("div",vi,[t(J,{flat:"",size:"sm",icon:"undo","no-caps":"",onClick:u[4]||(u[4]=d=>i.menuActionEmit("undoAction")),disable:i.disableUndo},{default:l(()=>[$("Undo "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[pi,gi]),_:1})]),_:1},8,["disable"])]),g("div",hi,[t(J,{flat:"",size:"sm",icon:"redo","no-caps":"",onClick:u[5]||(u[5]=d=>i.menuActionEmit("redoAction")),disable:i.disableRedo},{default:l(()=>[$("Redo "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[mi,bi]),_:1})]),_:1},8,["disable"])])]),g("div",yi,[g("div",_i,[t(J,{flat:"",size:"sm",icon:"delete","no-caps":"",onClick:u[6]||(u[6]=d=>i.menuActionEmit("deleteSelected")),disable:i.selectedCount<1},{default:l(()=>[$("Delete "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ki,Ci]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",xi,[g("div",wi,[t(J,{flat:"",size:"sm",icon:"join_full","no-caps":"",onClick:u[7]||(u[7]=d=>i.menuActionEmit("groupSelected")),disable:i.selectedCount<2},{default:l(()=>[$("Group "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Si,Ii]),_:1})]),_:1},8,["disable"])]),g("div",Ei,[t(J,{flat:"",size:"sm",icon:"join_inner","no-caps":"",onClick:u[8]||(u[8]=d=>i.menuActionEmit("ungroupSelected")),disable:i.selectedCount<2},{default:l(()=>[$("Ungroup "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Di,Ti]),_:1})]),_:1},8,["disable"])])]),g("div",$i,[g("div",Pi,[t(J,{flat:"",size:"sm",icon:"library_books","no-caps":"",onClick:u[9]||(u[9]=d=>i.menuActionEmit("addToLibrary")),disable:i.selectedCount<2},{default:l(()=>[$("Add to library "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Mi,Oi]),_:1})]),_:1},8,["disable"])]),g("div",zi,[t(J,{flat:"",size:"sm",icon:"file_copy","no-caps":"",onClick:u[10]||(u[10]=d=>i.menuActionEmit("duplicateSelected")),disable:i.selectedCount<1},{default:l(()=>[$("Duplicate "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Li,Ri]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",ji,[g("div",Ai,[t(J,{flat:"",size:"sm",icon:"splitscreen","no-caps":"",onClick:u[11]||(u[11]=d=>i.menuActionEmit("weldSelected")),disable:!(i.selectedCount>=2)},{default:l(()=>[$("Weld "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Wi,Gi]),_:1})]),_:1},8,["disable"])])]),g("div",Fi,[g("div",Vi,[t(J,{flat:"",size:"sm",icon:"link","no-caps":"",onClick:u[12]||(u[12]=d=>i.menuActionEmit("link")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Link "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Bi]),_:1})]),_:1},8,["disable"])]),g("div",Yi,[t(J,{flat:"",size:"sm",icon:"transform","no-caps":"",disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Convert to "),t(xt,{anchor:"top end",self:"top start","auto-close":""},{default:l(()=>[t(lt,null,{default:l(()=>[(D(!0),de(Ct,null,Dt(i.tools.filter(d=>d.name!==i.object.type&&!["Duct","Pointer","Text"].includes(d.name)),d=>ue((D(),X(oe,{key:d.name,dense:"",clickable:"",onClick:p=>i.menuActionEmit("convertObjectType",d.name)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:d.icon,color:"grey-7","text-color":"white"},null,8,["icon"])]),_:2},1024),t(P,null,{default:l(()=>[$(Oe(d.name),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[ve]])),128))]),_:1})]),_:1}),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Xi]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",Ui,[g("div",Ni,[t(J,{flat:"",size:"sm",icon:"autorenew","no-caps":"",onClick:u[13]||(u[13]=d=>i.menuActionEmit("rotate90")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Rotate 90\xB0 "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[qi]),_:1})]),_:1},8,["disable"])]),g("div",Hi,[t(J,{flat:"",size:"sm",icon:"sync","no-caps":"",onClick:u[14]||(u[14]=d=>i.menuActionEmit("rotate-90")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Rotate -90\xB0 "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Qi]),_:1})]),_:1},8,["disable"])])]),g("div",Ki,[g("div",Ji,[t(J,{flat:"",size:"sm",icon:"flip","no-caps":"",onClick:u[15]||(u[15]=d=>i.menuActionEmit("flipH")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Flip horizontal "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Zi]),_:1})]),_:1},8,["disable"])]),g("div",es,[t(J,{flat:"",size:"sm",icon:"flip","no-caps":"",onClick:u[16]||(u[16]=d=>i.menuActionEmit("flipV")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Flip vertical "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ts]),_:1})]),_:1},8,["disable"])])]),g("div",ns,[g("div",as,[t(J,{flat:"",size:"sm",icon:"flip_to_front","no-caps":"",onClick:u[17]||(u[17]=d=>i.menuActionEmit("bringToFront")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Bring to front "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ls]),_:1})]),_:1},8,["disable"])]),g("div",os,[t(J,{flat:"",size:"sm",icon:"flip_to_back","no-caps":"",onClick:u[18]||(u[18]=d=>i.menuActionEmit("sendToBack")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Send to back "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[is]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",ss,[g("div",rs,[t(Vt,{color:"blue","false-value":"Disable","true-value":"Enable",modelValue:i.showRulersGrid,"onUpdate:modelValue":[u[19]||(u[19]=d=>i.showRulersGrid=d),u[20]||(u[20]=d=>i.menuActionEmit("toggleRulersGrid",i.showRulersGrid))],size:"xs",style:{"margin-top":"-3px"}},{default:l(()=>[cs,t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$(" Show rulers and grid ("+Oe(i.showRulersGrid)+") ",1)]),_:1})]),_:1},8,["modelValue"])]),g("div",us,[t(J,{onClick:u[21]||(u[21]=d=>i.menuActionEmit("zoomOut")),disable:i.zoom<=10,dense:"",flat:"",size:"sm",icon:"zoom_out"},{default:l(()=>[t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$(" Zoom out ")]),_:1})]),_:1},8,["disable"]),g("div",ds,[g("input",{class:"zoom-input",onKeydown:u[22]||(u[22]=fl(d=>i.menuActionEmit("zoomSet",d.target.value),["enter"])),value:i.zoom,type:"number"},null,40,fs),$("% ")]),t(J,{onClick:u[23]||(u[23]=d=>i.menuActionEmit("zoomIn")),disable:i.zoom>=400,dense:"",flat:"",size:"sm",icon:"zoom_in"},{default:l(()=>[t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$(" Zoom in ")]),_:1})]),_:1},8,["disable"])])])])]),_:1}),t($t,{name:"file",class:"file-panel"},{default:l(()=>[g("div",vs,[g("div",ps,[g("div",gs,[t(J,{flat:"",size:"sm",icon:"assignment","no-caps":"",label:"New Project",style:{"font-size":"11px"},onClick:u[24]||(u[24]=d=>i.menuActionEmit("newProject"))}),hs])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",ms,[g("div",bs,[t(J,{flat:"",size:"sm",icon:"file_open","no-caps":"",label:"Import",style:{"font-size":"11px"},onClick:u[25]||(u[25]=d=>i.menuActionEmit("importJsonAction"))})])]),g("div",ys,[g("div",_s,[t(J,{flat:"",size:"sm",icon:"file_open","no-caps":"",label:"Export",style:{"font-size":"11px"},onClick:u[26]||(u[26]=d=>i.menuActionEmit("exportToJsonAction"))})])])])]),_:1}),t($t,{name:"device",class:"device-panel"},{default:l(()=>[g("div",ks,[t(lt,{class:"col-8",style:{height:"50px"}},{default:l(()=>[t(oe,null,{default:l(()=>[t(P,{top:"",class:"col-3"},{default:l(()=>[t(Me,{class:"q-mt-sm"},{default:l(()=>{var d,p;return[$("Current: "+Oe((p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.device),1)]}),_:1})]),_:1}),t(P,{top:"",class:"col-1"},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Graphic ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",Cs,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.id),1)]}),_:1})]),_:1}),t(P,{top:"",class:"col-3"},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Full label ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",xs,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.fullLabel),1)]}),_:1})]),_:1}),t(P,{top:""},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Label ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",ws,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.label),1)]}),_:1})]),_:1}),t(P,{top:""},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Element Count ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",Ss,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.elementCount),1)]}),_:1})]),_:1}),t(P,{avatar:"",top:""},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Action ")]),_:1}),t(b,{class:"text-primary",style:{"font-size":"12px","margin-top":"2px",cursor:"pointer"},onClick:i.showMoreDevices},{default:l(()=>[$("Show more devices "),t(ge,{anchor:"top middle",self:"center left"},{default:l(()=>[$(" Save the current selection ")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])}var Es=rn(Uo,[["render",Is],["__scopeId","data-v-72bff07c"]]);const Fe=i=>(Rn("data-v-15846348"),i=i(),jn(),i),Ds={class:"full-area"},Ts={class:"top-area"},$s={class:"main-area"},Ps={key:0,class:"side-bar"},Ms={class:"work-area"},Os={class:"document-area"},zs={key:0,class:"c-ruler"},Ls={key:1,class:"h-ruler"},Rs={key:2,class:"v-ruler"},js={key:3,class:"hv-grid"},As=Fe(()=>g("strong",null,"Go back",-1)),Ws={key:0},Gs={key:1},Fs={key:0},Vs={key:1},Bs=["id"],Ys=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Mode:",-1)),Xs=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Us=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Ns=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Mode:",-1)),qs=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Hs=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Qs=Fe(()=>g("div",{class:"text-h6"},"Link Entry",-1)),Ks={class:"flex"},Js=Fe(()=>g("strong",null,"Reload panels data",-1)),Zs={class:"flex flex-col items-center mt-4"},er={class:"text-xl text-center"},tr=Fe(()=>g("div",{class:"text-h6"},"Insert Entry",-1)),nr={class:"flex"},ar=Fe(()=>g("strong",null,"Reload panels data",-1)),lr={class:"flex flex-col items-center mt-4"},or={class:"text-xl text-center"},ir=Fe(()=>g("div",{class:"text-h6"},"Import from a JSON file",-1)),sr=Fe(()=>g("div",{class:"text-h6"},"Devices List",-1)),rr={__name:"IndexPage",setup(i){var ta;ka(e=>({c7b1a59a:y(Ft).widthOffset,"448c16c0":y(Ft).heightOffset})),Yl({title:"HVAC Drawer"});const h=new wa,o=Wn(),a=ne(null),c=ne([]),b=ne({...Xe[0],type:"default"}),v=ne(!1),d=ne([0,0]),p=ne(!0),S=ne(!1),R=["Duct","Wall","Int_Ext_Wall"],M=ne({addedCount:0,active:!1,uploadBtnLoading:!1,data:null}),O=ne(!1),N=vl(()=>Be.value.loadingPanel===null?100:parseInt((Be.value.loadingPanel+1/Be.value.panelsList.length)*100)),q=e=>r.value.selectedTargets.some(n=>n&&n.id===`moveable-item-${e}`),K=ne(!1),U=Z.IdxPage.zoom;let se=null;const V=ne({x:0,y:0}),B=ne(null);An(()=>{Z.IdxPage.initQuasar(o),Z.IdxPage.initPage()});function ce(e,n){mt.value.active=e,mt.value.data=n}function ae(){Z.DeviceOpt.clearDirtyCurrentDevice(),mt.value.active=!0,r.value.selectedTarget=[],r.value.selectedTargets=[],r.value.activeItemIndex=null,Z.DeviceOpt.refreshGraphicPanelElementCount(mt.value.data)}Ca(()=>{}),pl(()=>{Z.IdxPage.clearAutoSaveInterval(),Z.WsClient.clearInitialDataInterval(),Z.IdxPage.clearIdx()});function be(e){V.value.x=e.clientX-bt.left,V.value.y=e.clientY-bt.top;const n=1/r.value.viewportTransform.scale;if(v.value&&R.includes(b.value.name)&&r.value.activeItemIndex!==null){const s=e.ctrlKey,_=(e.clientX-bt.left-r.value.viewportTransform.x)*n,x=(e.clientY-bt.top-r.value.viewportTransform.y)*n,f=_-d.value[0],ee=x-d.value[1];let Q=Math.atan2(ee,f)*(180/Math.PI);s&&(Q=Math.round(Q/5)*5);const Se=Math.sqrt(f*f+ee*ee);r.value.items[r.value.activeItemIndex].rotate=Q,r.value.items[r.value.activeItemIndex].width=Se,je()}}function Ve(){document.body.style.cursor="auto",document.querySelectorAll(".moveable-item").forEach(n=>{n.style.cursor=""})}function je(){if(!!B.value)for(const e of B.value)!e.refresh||e.refresh()}function ie(e){e!=="Move Object"&&setTimeout(()=>{St(!1,!1),je()},200),ft.value=[],Ge.value.unshift({title:e,state:We.exports.cloneDeep(r.value)}),Ge.value.length>20&&Ge.value.pop()}function Ue(e){a.value.clickTarget(e.inputEvent,e.inputTarget)}function Ke(e){ie("Move Object"),G.value||(document.body.style.cursor="grabbing",e.target.style.cursor="grabbing")}function Je(e){r.value.items.find(n=>`moveable-item-${n.id}`===e.target.id),e.target.style.transform=e.transform}function Ze(e){if(document.body.style.cursor="auto",e.target&&(e.target.style.cursor=""),!e.lastEvent)Ge.value.shift();else{const n=r.value.items.find(s=>`moveable-item-${s.id}`===e.target.id);n.translate=e.lastEvent.beforeTranslate,console.log("= IdxPage onDragEnd:",e,n.translate),St(!1,!1),je()}}function Ne(e){ie("Move Group"),G.value||(document.body.style.cursor="grabbing"),e.events.forEach((n,s)=>{const _=r.value.items.findIndex(x=>`moveable-item-${x.id}`===n.target.id);n.set(r.value.items[_].translate),!G.value&&n.target&&(n.target.style.cursor="grabbing")})}function et(e){e.events.forEach((n,s)=>{const _=r.value.items.findIndex(x=>`moveable-item-${x.id}`===n.target.id);r.value.items[_].translate=n.beforeTranslate})}function ot(e){var n;document.body.style.cursor="auto",(n=e.events)==null||n.forEach(s=>{s.target&&(s.target.style.cursor="")}),e.lastEvent?je():Ge.value.shift()}function Pe(e){const n=e.inputEvent.target;(dt.value.isMoveableElement(n)||r.value.selectedTargets.some(s=>s===n||s.contains(n)))&&e.stop()}function Ae(e){var n;if(r.value.selectedTargets=e.selected,(e==null?void 0:e.selected)&&!((n=e==null?void 0:e.inputEvent)!=null&&n.ctrlKey)){const s=r.value.items.filter(x=>e.selected.some(f=>f.id===`moveable-item-${x.id}`));[...new Set(s.filter(x=>x.group).map(x=>x.group))].forEach(x=>{C(x)})}r.value.selectedTargets.length===1?r.value.activeItemIndex=r.value.items.findIndex(s=>`moveable-item-${s.id}`===r.value.selectedTargets[0].id):r.value.activeItemIndex=null,e.isDragStart&&(e.inputEvent.preventDefault(),setTimeout(()=>{dt.value.dragStart(e.inputEvent)})),r.value.selectedTargets.length>1&&!G.value?setTimeout(()=>{O.value=!0},100):O.value=!1,at.refreshMoveableGuides(),setTimeout(()=>{At.Hvac.PageMain.SetWallDimensionsVisible("select",v.value,r,null)},100)}function C(e){const n=[];r.value.items.filter(s=>s.group===e&&!r.value.selectedTargets.some(_=>_.id===`moveable-item-${s.id}`)).forEach(s=>{const _=document.querySelector(`#moveable-item-${s.id}`);n.push(_)}),r.value.selectedTargets=r.value.selectedTargets.concat(n),a.value.setSelectedTargets(r.value.selectedTargets)}function k(e){ie("Resize object");const n=r.value.items.findIndex(s=>`moveable-item-${s.id}`===e.target.id);e.setOrigin(["%","%"]),e.dragStart&&e.dragStart.set(r.value.items[n].translate),document.body.style.cursor="nw-resize"}function m(e){const n=r.value.items.find(s=>`moveable-item-${s.id}`===e.target.id);e.target.style.width=`${e.width}px`,e.target.style.height=`${e.height}px`,e.target.style.transform=`translate(${e.drag.beforeTranslate[0]}px, ${e.drag.beforeTranslate[1]}px) rotate(${n.rotate}deg) scaleX(${n.scaleX}) scaleY(${n.scaleY})`}function E(e){if(e.lastEvent===null||e.lastEvent===void 0){document.body.style.cursor="auto";return}const n=r.value.items.findIndex(s=>{var _,x;return`moveable-item-${s.id}`===((x=(_=e==null?void 0:e.lastEvent)==null?void 0:_.target)==null?void 0:x.id)});r.value.items[n].width=e.lastEvent.width,r.value.items[n].height=e.lastEvent.height,r.value.items[n].translate=e.lastEvent.drag.beforeTranslate,At.Hvac.PageMain.UpdateExteriorWallStroke(r,n,e.lastEvent.height),je(),document.body.style.cursor="auto"}function T(e){ie("Rotate object"),document.body.style.cursor="grab"}function I(e){const n=r.value.items.find(s=>`moveable-item-${s.id}`===e.target.id);n.rotate=e.rotate}function w(e){je(),document.body.style.cursor="auto"}function j(e){je(),document.body.style.cursor="auto"}function W(e){S.value=!0,document.body.style.cursor="nw-resize"}function z(e){e.events.forEach((n,s)=>{n.target.style.width=`${n.width}px`,n.target.style.height=`${n.height}px`,n.target.style.transform=n.drag.transform})}function F(e){e.events.forEach(n=>{const s=r.value.items.findIndex(_=>`moveable-item-${_.id}`===n.lastEvent.target.id);r.value.items[s].width=n.lastEvent.width,r.value.items[s].height=n.lastEvent.height,r.value.items[s].translate=n.lastEvent.drag.beforeTranslate}),je(),S.value=!1,document.body.style.cursor="auto"}function le(e){ie("Rotate Group"),e.events.forEach(n=>{const s=r.value.items.findIndex(_=>`moveable-item-${_.id}`===n.target.id);n.set(r.value.items[s].rotate),n.dragStart&&n.dragStart.set(r.value.items[s].translate)}),document.body.style.cursor="grab"}function A(e){e.events.forEach((n,s)=>{const _=r.value.items.findIndex(x=>`moveable-item-${x.id}`===n.target.id);r.value.items[_].translate=n.drag.beforeTranslate,r.value.items[_].rotate=n.rotate})}function Ce(e,n=void 0,s=!0){var x;s&&ie(`Add ${(x=e==null?void 0:e.type)!=null?x:""}`),r.value.itemsCount++,e.id=r.value.itemsCount,e.group=n,e.settings.titleColor||(e.settings.titleColor="inherit"),e.settings.bgColor||(e.settings.bgColor="inherit"),e.settings.textColor||(e.settings.textColor="inherit"),e.settings.fontSize||(e.settings.fontSize=16),r.value.items.push(e);const _=document.querySelectorAll(".moveable-item");return r.value.elementGuidelines=[],Array.from(_).forEach(function(f){r.value.elementGuidelines.push(f)}),e}function qe(e,n,s){const _=[],x=[];r.value.groupCount++,e.forEach(f=>{x.push(wt(f,r.value.groupCount))}),setTimeout(()=>{x.forEach(ee=>{const Q=document.querySelector(`#moveable-item-${ee.id}`);_.push(Q)}),r.value.selectedTargets=_,a.value.setSelectedTargets(_),r.value.activeItemIndex=null;const f=1/r.value.viewportTransform.scale;setTimeout(()=>{dt.value.request("draggable",{x:(s.clientX-bt.left-r.value.viewportTransform.x)*f-n.width*f,y:(s.clientY-bt.top-r.value.viewportTransform.y)*f-n.height*f},!0),setTimeout(()=>{Z.IdxPage.refreshMoveable()},1)},10)},10)}function L(e){var x;const n={width:e.rect.width,height:e.rect.height},s={clientX:e.clientX,clientY:e.clientY,top:e.rect.top,left:e.rect.left};if((b.value.name==="Pointer"||n.width<20||n.height<20)&&!R.includes(b.value.name)){v.value=!1;return}R.includes(b.value.name)&&n.height<20&&(n.height=b.value.height);const _=H(n,s);_&&R.includes((x=_==null?void 0:_.type)!=null?x:"")&&setTimeout(()=>{v.value=!0,r.value.selectedTargets=[],r.value.items[r.value.activeItemIndex].rotate=0,d.value=We.exports.cloneDeep(_.translate)},100)}function H(e,n,s){var Se;if(s=s||b.value,s.type==="libItem"){qe(s.items,e,n);return}const _=1/r.value.viewportTransform.scale,x=We.exports.cloneDeep((Se=Xe.find(Ee=>Ee.name===s.name))==null?void 0:Se.settings)||{},f=Object.keys(x).reduce((Ee,Re)=>(Ee[Re]=x[Re].value,Ee),{});s.name==="G_Rectangle"&&(e.width=100);const ee={title:null,active:!1,type:s.name,translate:[(n.left-bt.left-r.value.viewportTransform.x)*_,(n.top-bt.top-r.value.viewportTransform.y)*_],width:e.width*_,height:e.height*_,rotate:0,scaleX:1,scaleY:1,settings:f,zindex:1,t3Entry:null,showDimensions:!0};if(s.type==="Image"&&(ee.image=s,ee.type=s.id),s.cat){const[Ee]=s.cat;ee.cat=Ee}const Q=Ce(ee);return["Value","Icon","Switch"].includes(s.name)&&(Te.value.active=!0),setTimeout(()=>{G.value||(r.value.activeItemIndex=r.value.items.findIndex(Ee=>Ee.id===Q.id))},10),setTimeout(()=>{if(G.value)return;const Ee=document.querySelector(`#moveable-item-${Q.id}`);r.value.selectedTargets=[Ee],a.value.setSelectedTargets([Ee])},100),Q}function fe(e,n="default"){b.value=e,typeof e=="string"&&(b.value=Xe.find(s=>s.name===e)),b.value.type=n}function ze(e,n=!1){!e||(ie("Rotate object"),n?e.rotate=e.rotate-90:e.rotate=e.rotate+90,Z.IdxPage.refreshMoveable())}function Le(e){ie("Flip object H"),e.scaleX===1?e.scaleX=-1:e.scaleX=1,Z.IdxPage.refreshMoveable()}function it(e){ie("Flip object V"),e.scaleY===1?e.scaleY=-1:e.scaleY=1,Z.IdxPage.refreshMoveable()}function xe(e){ie("Bring object to front"),e.zindex=e.zindex+1}function he(e){ie("Send object to back"),e.zindex=e.zindex-1}function te(e){ie("Remove object");const n=r.value.items.findIndex(s=>s.id===e.id);r.value.activeItemIndex=null,r.value.items.splice(n,1),r.value.selectedTargets=[]}function pt(e){ie(`Duplicate ${e.type}`),r.value.activeItemIndex=null;const n=wt(e);r.value.selectedTargets=[],setTimeout(()=>{cn(n)},10)}function wt(e,n=void 0){const s=We.exports.cloneDeep(e);return s.translate[0]=s.translate[0]+5,s.translate[1]=s.translate[1]+5,Ce(s,n,!1)}function cn(e){const n=document.querySelector(`#moveable-item-${e.id}`);r.value.selectedTargets=[n],r.value.activeItemIndex=r.value.items.findIndex(s=>s.id===e.id)}function Nt(e){}function st(e,n){Z.IdxPage.T3UpdateEntryField(e,n)}function un(e){St(!1,!0)}function dn(e){return!e.inputEvent.altKey}function fn(){if(ie("Link object to T3000 entry"),r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField||(r.value.items[r.value.activeItemIndex].label===void 0?r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="description":r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="label"),Te.value.data.value!==void 0&&Te.value.data.value!==null&&Te.value.data.value>=1e3&&(Te.value.data.value=Te.value.data.value/1e3),r.value.items[r.value.activeItemIndex].t3Entry=We.exports.cloneDeep(jt(Te.value.data)),r.value.items[r.value.activeItemIndex].type==="Icon"){let n="fa-solid fa-camera-retro";Te.value.data.type==="GRP"?n="fa-solid fa-camera-retro":Te.value.data.type==="SCHEDULE"?n="schedule":Te.value.data.type==="PROGRAM"?n="fa-solid fa-laptop-code":Te.value.data.type==="HOLIDAY"&&(n="calendar_month"),r.value.items[r.value.activeItemIndex].settings.icon=n}at.refreshObjectStatus(r.value.items[r.value.activeItemIndex]),Te.value.data=null,Te.value.active=!1}function qt(e,n){if(e===""){n(()=>{on.value=Be.value.panelsData});return}n(()=>{const s=e.toUpperCase();on.value=Be.value.panelsData.filter(_=>{var x,f;return _.command.toUpperCase().indexOf(s)>-1||((x=_.description)==null?void 0:x.toUpperCase().indexOf(s))>-1||((f=_.label)==null?void 0:f.toUpperCase().indexOf(s))>-1})})}const Vn=ne(0);function za(e){ie("Insert object to T3000 entry");const n=Vn.value*80,s={width:60,height:60},_={clientX:300,clientY:100,top:100,left:200+n},x=Xe.find(Q=>Q.name==="Pump"),f=H(s,_,x),ee=r.value.items.findIndex(Q=>Q.id===f.id);r.value.activeItemIndex=ee,La(),Vn.value++}function La(){if(ie("Link object to T3000 entry"),r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField||(r.value.items[r.value.activeItemIndex].label===void 0?r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="description":r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="label"),r.value.items[r.value.activeItemIndex].t3Entry=We.exports.cloneDeep(jt(Qe.value.data)),r.value.items[r.value.activeItemIndex].type==="Icon"){let e="fa-solid fa-camera-retro";Qe.value.data.type==="GRP"?e="fa-solid fa-camera-retro":Qe.value.data.type==="SCHEDULE"?e="schedule":Qe.value.data.type==="PROGRAM"?e="fa-solid fa-laptop-code":Qe.value.data.type==="HOLIDAY"&&(e="calendar_month"),r.value.items[r.value.activeItemIndex].settings.icon=e}at.refreshObjectStatus(r.value.items[r.value.activeItemIndex]),Qe.value.data=null,Qe.value.active=!1}function Ra(){}function St(e=!1,n=!1){Z.IdxPage.save(e,n)}function ja(){Z.IdxPage.refreshMoveable()}function Bn(){var e;if(((e=r.value.items)==null?void 0:e.length)>0){o.dialog({dark:!0,title:"Do you want to clear the drawing and start over?",message:"This will also erase your undo history",cancel:!0,persistent:!0}).onOk(()=>{Z.IdxPage.newProject()}).onCancel(()=>{});return}Z.IdxPage.newProject()}h.keyup(e=>{e.key==="ctrl"&&(p.value=!0)}),h.keydown(e=>{e.key==="esc"&&(fe(Xe[0]),Gt.value.length>1&&wn(),v.value&&(v.value=!1,Ht())),e.key==="ctrl"&&(p.value=!1),!(r.value.selectedTargets.length<1)&&(["up","down","left","right"].includes(e.key)&&ie("Move object"),e.key==="up"?dt.value.request("draggable",{deltaX:0,deltaY:-5},!0):e.key==="down"?dt.value.request("draggable",{deltaX:0,deltaY:5},!0):e.key==="left"?dt.value.request("draggable",{deltaX:-5,deltaY:0},!0):e.key==="right"?dt.value.request("draggable",{deltaX:5,deltaY:0},!0):e.key==="delete"&&pn(),["up","down","left","right"].includes(e.key)&&Z.IdxPage.refreshMoveable())}),h.keydown(["ctrl","s"],e=>{e.inputEvent.preventDefault(),St(!0,!0)}),h.keydown(["ctrl","z"],e=>{e.inputEvent.preventDefault(),!G.value&&Ht()}),h.keydown(["ctrl","y"],e=>{e.inputEvent.preventDefault(),!G.value&&Un()}),h.keydown(["ctrl","r"],e=>{e.inputEvent.preventDefault(),Bn()}),h.keydown(["ctrl","d"],e=>{e.inputEvent.preventDefault(),hn()}),h.keydown(["ctrl","g"],e=>{e.inputEvent.preventDefault(),mn()}),h.keydown(["ctrl","shift","g"],e=>{e.inputEvent.preventDefault(),bn()}),h.keydown(["ctrl","c"],e=>{!document.activeElement.matches(".viewport")||(e.inputEvent.preventDefault(),Jt())}),h.keydown(["ctrl","v"],e=>{!document.activeElement.matches(".viewport")||(e.inputEvent.preventDefault(),Jn())}),h.keydown(["ctrl","b"],e=>{e.inputEvent.preventDefault(),gn()}),h.keydown(["insert"],e=>{At.Hvac.KiOpt.InsertT3EntryDialog()});function vn(){var e,n;Te.value.active=!0,(e=r.value.items[r.value.activeItemIndex])!=null&&e.t3Entry&&(Te.value.data=We.exports.cloneDeep((n=r.value.items[r.value.activeItemIndex])==null?void 0:n.t3Entry))}function pn(){ie("Remove selected objects"),r.value.selectedTargets.length>0&&(r.value.selectedTargets.forEach(e=>{const n=r.value.items.findIndex(s=>`moveable-item-${s.id}`===e.id);n!==-1&&r.value.items.splice(n,1)}),r.value.selectedTargets=[],r.value.activeItemIndex=null)}function Aa(e){const n=1/r.value.viewportTransform.scale,s=e[0].translate[0];e[0].translate[1];const _=Math.min(...e.map(ye=>ye.translate[0])),x=Math.min(...e.map(ye=>ye.translate[1])),f=Math.max(...e.map(ye=>ye.translate[0]+ye.width)),ee=Math.max(...e.map(ye=>ye.translate[1]+ye.height)),Q=s<_?s:_,Se=e.map(ye=>{var He;return(He=ye==null?void 0:ye.type)!=null?He:""}).join("-");let Ee=e[0].zindex;e.forEach(ye=>{ye.zindex=Ee-1,Ee=ye.zindex});const Re={title:`Weld-${Se}`,active:!1,type:"Weld",translate:[Q,x],width:(f-_)*n,height:(ee-x)*n,rotate:0,scaleX:1,scaleY:1,settings:{active:!1,fillColor:"#659dc5",fontSize:16,inAlarm:!1,textColor:"inherit",titleColor:"inherit",weldItems:We.exports.cloneDeep(e)},zindex:1,t3Entry:null,id:r.value.itemsCount+1};Ce(Re)}function Wa(e){const n=1/r.value.viewportTransform.scale,s=e[0].translate[0];e[0].translate[1];const _=Math.min(...e.map(re=>re.translate[0]));let x=Math.min(...e.map(re=>re.translate[1]));const f=Math.max(...e.map(re=>re.translate[0]+re.width)),ee=Math.max(...e.map(re=>re.translate[1]+re.height));let Q=s<_?s:_;const Se=e.reduce((re,me)=>{const ct=me.rotate*Math.PI/180,ut=Math.cos(ct),Y=Math.sin(ct);return[{x:me.translate[0],y:me.translate[1]},{x:me.translate[0]+me.width*ut,y:me.translate[1]+me.width*Y},{x:me.translate[0]-me.height*Y,y:me.translate[1]+me.height*ut},{x:me.translate[0]+me.width*ut-me.height*Y,y:me.translate[1]+me.width*Y+me.height*ut}].forEach(tn=>{re.minX=Math.min(re.minX,tn.x),re.minY=Math.min(re.minY,tn.y),re.maxX=Math.max(re.maxX,tn.x),re.maxY=Math.max(re.maxY,tn.y)}),re},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});Se.minX,Se.minY,Se.maxX-Se.minX,Se.maxY-Se.minY;const Ee=e.map(re=>{var me;return(me=re==null?void 0:re.type)!=null?me:""}).join("-");let Re=e[0].zindex;e.forEach(re=>{re.zindex=Re-1,Re=re.zindex});const ye=e.every(re=>{var me;return((me=re==null?void 0:re.type)!=null?me:"")==="Duct"});if(ye){const re=Ga(e);e.forEach(me=>{const ct=re.find(ut=>ut.id===me.id);ct&&(me.overlap={isStartOverlap:ct.isStartOverlap,isEndOverlap:ct.isEndOverlap})})}const He=(f-_)*n+8,Et=(ee-x)*n+8,Zt={title:`Weld-${Ee}`,active:!1,cat:"General",type:ye?"Weld_Duct":"Weld_General",translate:[Q,x],width:He,height:Et,rotate:0,scaleX:1,scaleY:1,settings:{active:!1,fillColor:"#659dc5",fontSize:16,inAlarm:!1,textColor:"inherit",titleColor:"inherit"},weldItems:We.exports.cloneDeep(e),zindex:1,t3Entry:null,id:r.value.itemsCount+1};Ce(Zt)}function Yn(e){const{left:n,top:s,pos1:_,pos2:x,pos3:f,pos4:ee}=e;return[_,x,ee,f].map(Q=>[n+Q[0],s+Q[1]])}function Xn(e){const n=e.closest(".moveable-item.Duct"),s=Dn(e),_=document.querySelectorAll(".moveable-item.Duct");for(const x of Array.from(_)){if(n.isSameNode(x))continue;const f=Dn(x),ee=Yn(s),Q=Yn(f);if(Bl(ee,Q)>0)return!0}return!1}function Ga(e){const n=[];return e.map(s=>{const _=document.querySelector(`#moveable-item-${s.id} .duct-start`),x=document.querySelector(`#moveable-item-${s.id} .duct-end`),f=Xn(_),ee=Xn(x);n.push({id:s.id,isStartOverlap:f,isEndOverlap:ee})}),n}function gn(){if(r.value.selectedTargets.length<2)return;if(r.value.items.filter(x=>r.value.selectedTargets.some(f=>f.id===`moveable-item-${x.id}`)).some(x=>{var f;return((f=x==null?void 0:x.type)!=null?f:"")==="Weld"})){o.notify({type:"warning",message:"Currently not supported!"});return}ie("Weld selected objects");const n=r.value.items.filter(x=>r.value.selectedTargets.some(f=>f.id===`moveable-item-${x.id}`)),s=n.every(x=>x.cat==="General"),_=n.every(x=>{var f;return((f=x==null?void 0:x.type)!=null?f:"")==="Duct"});s||_?Wa(n):Aa(n),n.forEach(x=>{const f=r.value.items.findIndex(ee=>ee.id===x.id);f!==-1&&r.value.items.splice(f,1)}),Z.IdxPage.refreshMoveable()}function Ht(){Ge.value.length<1||(ft.value.unshift({title:se,state:We.exports.cloneDeep(r.value)}),r.value=We.exports.cloneDeep(Ge.value[0].state),Ge.value.shift(),Z.IdxPage.refreshMoveable())}function Un(){ft.value.length<1||(Ge.value.unshift({title:se,state:We.exports.cloneDeep(r.value)}),r.value=We.exports.cloneDeep(ft.value[0].state),ft.value.shift(),Z.IdxPage.refreshMoveable())}function Fa(e){}function Va(e){return new Promise((n,s)=>{var _=new FileReader;_.onload=()=>{n(_.result)},_.onerror=s,_.readAsDataURL(e)})}async function Ba(e){if(kt.value){console.log("= Idx saveLibImage file",e),console.log("= Idx saveLibImage user",kt.value),Wt.post("hvacTools",{json:{name:e.name,fileId:e.id}}).then(async s=>{o.notify({color:"positive",message:"Image successfully saved"});const _=await s.json();rl(_)}).catch(s=>{o.notify({color:"negative",message:s.message})});return}Ie.value.imagesCount++;const n={action:9,filename:e.name,fileLength:e.size,fileData:await Va(e.data)};Ye.value?Z.WebClient.SaveImage(n):Z.WsClient.SaveImage(n)}const It=ne({active:!1,data:{settings:(ta=Xe.find(e=>e.name==="Gauge"))==null?void 0:ta.settings}});function Ya(e){It.value.active=!0,It.value.data=e}function Xa(e){const n=r.value.items.findIndex(s=>s.id===e.id);r.value.items[n]=e,It.value.active=!1,It.value.data={}}function Ua(){M.value.active=!0}function Na(){const e=We.exports.cloneDeep(jt(r.value));e.selectedTargets=[],e.elementGuidelines=[];const n=document.createElement("a"),s=new Blob([JSON.stringify(e)],{type:"application/json"});n.href=URL.createObjectURL(s),n.download="HVAC_Drawer_Project.json",n.click()}async function qa(e){const n=await e.data.text();M.value.data=n,Ha()}function Ha(){var n,s;const e=JSON.parse(M.value.data);if(!((n=e.items)!=null&&n[0].type)){o.notify({message:"Error, Invalid json file",color:"negative",icon:"error",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]});return}if(((s=r.value.items)==null?void 0:s.length)>0){o.dialog({dark:!0,title:"You have unsaved drawing!",message:`Before proceeding with the import, please note that any unsaved drawing will be lost,
           and your undo history will also be erased. Are you sure you want to proceed?`,cancel:!0,persistent:!0}).onOk(()=>{Ge.value=[],ft.value=[],M.value.active=!1,r.value=e,M.value.data=null,setTimeout(()=>{at.refreshMoveableGuides()},100),Z.IdxPage.refreshMoveable()}).onCancel(()=>{M.value.active=!1});return}Ge.value=[],ft.value=[],M.value.active=!1,r.value=e,M.value.data=null,setTimeout(()=>{at.refreshMoveableGuides()},100),Z.IdxPage.refreshMoveable()}function hn(){if(r.value.selectedTargets.length<1)return;ie("Duplicate the selected objects");const e=[],n={};r.value.selectedTargets.forEach(s=>{const _=r.value.items.find(x=>`moveable-item-${x.id}`===s.id);if(_){let x;_.group&&(n[`${_.group}`]||(r.value.groupCount++,n[`${_.group}`]=r.value.groupCount),x=n[`${_.group}`]);const f=wt(_,x);setTimeout(()=>{const ee=document.querySelector(`#moveable-item-${f.id}`);e.push(ee)},10)}}),setTimeout(()=>{r.value.selectedTargets=e,a.value.setSelectedTargets(e),r.value.activeItemIndex=null},20)}function mn(){r.value.selectedTargets.length<2||(ie("Group the selected objects"),r.value.selectedTargets.length>0&&(r.value.groupCount++,r.value.selectedTargets.forEach(e=>{const n=r.value.items.find(s=>`moveable-item-${s.id}`===e.id);n&&(n.group=r.value.groupCount)})))}function bn(){r.value.selectedTargets.length<2||(ie("Ungroup the selected objects"),r.value.selectedTargets.length>0&&r.value.selectedTargets.forEach(e=>{const n=r.value.items.find(s=>`moveable-item-${s.id}`===e.id);n&&(n.group=void 0)}))}function Nn(e,n){const s=r.value.items[r.value.activeItemIndex];switch(e){case"newProject":Bn();break;case"importJsonAction":Ua();break;case"exportToJsonAction":Na();break;case"save":St(!0,!0);break;case"undoAction":Ht();break;case"redoAction":Un();break;case"duplicateSelected":hn();break;case"groupSelected":mn();break;case"ungroupSelected":bn();break;case"addToLibrary":Qn();break;case"deleteSelected":pn();break;case"weldSelected":gn();break;case"duplicateObject":pt(s);break;case"rotate90":ze(s);break;case"rotate-90":ze(s,!0);break;case"flipH":Le(s);break;case"flipV":it(s);break;case"bringToFront":xe(s);break;case"sendToBack":he(s);break;case"removeObject":te(s);break;case"zoomOut":Z.IdxPage.zoomAction("out");break;case"zoomIn":Z.IdxPage.zoomAction();break;case"zoomSet":Z.IdxPage.zoomAction("set",n);break;case"copy":Jt();break;case"paste":Jn();break;case"link":vn();break;case"convertObjectType":Zn(s,n);break;case"toggleRulersGrid":al(n);break}}function qn(){Be.value.loadingPanel=null,Ye.value?Z.WebClient.GetPanelsList():Z.WsClient.GetPanelsList()}function Qt(e){let n=e.description&&e.id!==e.description||!e.description&&e.id!==e.label?e.id+" - ":"";return n=!e.description&&!e.label?e.id:n,n+(e.description||e.label||"")}function yn(){r.value.activeItemIndex=null,r.value.selectedTargets=[],G.value=!G.value,r.value.locked=G.value,document.body.style.cursor="auto",document.querySelectorAll(".moveable-item").forEach(n=>{n.style.cursor=""}),G.value&&fe("Pointer"),Fl.restDocumentAreaPosition()}function _n(e){var n,s,_,x,f;if(!!G.value){if(((n=e.t3Entry)==null?void 0:n.type)==="GRP"){const ee={action:7,panelId:e.t3Entry.pid,entryIndex:e.t3Entry.index};pa.SaveGrpSwitch(ee),Ye.value?Z.WebClient.LoadGraphicEntry(ee):Z.WsClient.LoadGraphicEntry(ee)}else if(["SCHEDULE","PROGRAM","HOLIDAY"].includes((s=e.t3Entry)==null?void 0:s.type)){const ee={action:8,panelId:e.t3Entry.pid,entryType:Nl[e.t3Entry.type],entryIndex:e.t3Entry.index};Ye.value?Z.WebClient.OpenEntryEditWindow(ee):Z.WsClient.OpenEntryEditWindow(ee)}else((_=e.t3Entry)==null?void 0:_.auto_manual)===1&&((x=e.t3Entry)==null?void 0:x.digital_analog)===0&&((f=e.t3Entry)==null?void 0:f.range)&&(e.t3Entry.control=e.t3Entry.control===1?0:1,st("control",e));Qa()}}function kn(e,n,s){const _=s?"control":"value",x=r.value.items.find(f=>f.id===e.id);x.t3Entry[_]=n,st(_,x)}function Cn(e){!G.value||(e.t3Entry.auto_manual=e.t3Entry.auto_manual?0:1,st("auto_manual",e))}const Kt=ne(!1),xn=ne(!1),tt=ne("Auto"),rt=ne("Off"),gt=ne(!1),Pt=ne(!1),ht=ne(!1),Mt=ne(!1),Ot=ne(0);function Hn(e,n){e.t3Entry!==null?(xn.value=!0,e.t3Entry.auto_manual===1?(tt.value="Manual",gt.value=!1,ht.value=!1):(tt.value="Auto",gt.value=!0,ht.value=!0),e.t3Entry.digital_analog===0?Pt.value=!0:Pt.value=!1,e.t3Entry.control===1?rt.value="On":rt.value="Off",e.t3Entry.digital_analog===1&&e.t3Entry.range!==101?(Mt.value=!0,Ot.value=e.t3Entry.value*1):Mt.value=!1):xn.value=!1}function zt(e,n,s){n==="mode"&&(tt.value==="Auto"?(gt.value=!0,ht.value=!0):(gt.value=!1,ht.value=!1),e.t3Entry.auto_manual=tt.value==="Auto"?0:1,st("auto_manual",e)),n=="value"&&(e.t3Entry.control=rt.value==="Off"?0:1,st("control",e)),n==="number-value"&&(e.t3Entry.value=Ot.value*1,st("value",e)),St(!1,!0)}function Qa(){if(r.value.selectedTargets.length>1)Kt.value=!1,Pt.value=!1,Mt.value=!1;else if(r.value.selectedTargets.length===1){const e=r.value.items.find(n=>`moveable-item-${n.id}`===r.value.selectedTargets[0].id);e.t3Entry!==null?(Kt.value=!0,Hn(e)):(Kt.value=!1,Pt.value=!1,Mt.value=!1)}}function wn(){if(Gt.value.length>1){const e=Gt.value[Gt.value.length-2],n={action:7,panelId:e.pid,entryIndex:e.index};pa.RemoveLatestGrpSwitch(),Ye.value?Z.WebClient.LoadGraphicEntry(n):Z.WsClient.LoadGraphicEntry(n)}else if(Ye.value)Z.WebClient.GetInitialData();else{const e=Z.DeviceOpt.getCurrentDevice(),n=e.panelId,s=e.graphic;Z.WsClient.GetInitialData(n,s,!0)}}function Ka(){Ge.value.shift()}async function Qn(){if(r.value.selectedTargets.length<1||G.value)return;const e=r.value.items.filter(x=>r.value.selectedTargets.some(f=>f.id===`moveable-item-${x.id}`));let n=!1;const s=We.exports.cloneDeep(e);Ie.value.objLibItemsCount++;let _=null;kt.value&&(n=!0,Wt.post("hvacObjectLibs",{json:{label:"Item "+Ie.value.objLibItemsCount,items:s.map(x=>(delete x.id,x))}}).then(async x=>{_=await x.json(),o.notify({type:"positive",message:"Successfully saved to library"}),Ie.value.objLib.push({id:(_==null?void 0:_.id)||Ie.value.objLibItemsCount,label:"Item "+Ie.value.objLibItemsCount,items:_.items,online:n}),at.saveLib()}).catch(x=>{o.notify({type:"negative",message:x.message})})),Ie.value.objLib.push({id:(_==null?void 0:_.id)||Ie.value.objLibItemsCount,label:"Item "+Ie.value.objLibItemsCount,items:s,online:n}),at.saveLib()}function Ja(){ie("Bring selected objects to front"),r.value.items.filter(n=>r.value.selectedTargets.some(s=>s.id===`moveable-item-${n.id}`)).forEach(n=>{n.zindex=n.zindex+1})}function Za(){ie("Send selected objects to back"),r.value.items.filter(n=>r.value.selectedTargets.some(s=>s.id===`moveable-item-${n.id}`)).forEach(n=>{n.zindex=n.zindex-1})}function Kn(e=!1){dt.value.request("rotatable",{deltaRotate:e?-90:90},!0),Z.IdxPage.refreshMoveable()}function Jt(){if(G.value||r.value.selectedTargets.length===0)return;const e=r.value.items.filter(n=>r.value.selectedTargets.some(s=>s.id===`moveable-item-${n.id}`));localStorage.setItem("clipboard",JSON.stringify(e)),K.value=!0}function Jn(){if(G.value)return;let e=[];const n=localStorage.getItem("clipboard");if(n&&(e=JSON.parse(n)),!e)return;ie("Paste");const s=[],_=[];e.forEach(x=>{_.push(wt(x))}),setTimeout(()=>{_.forEach(x=>{const f=document.querySelector(`#moveable-item-${x.id}`);s.push(f)}),r.value.selectedTargets=s,a.value.setSelectedTargets(s),r.value.activeItemIndex=null},10)}function el(e){kt.value&&e.online&&Wt.delete("hvacObjectLibs/"+e.id).then(async()=>{o.notify({type:"positive",message:"Successfully deleted"})}).catch(s=>{o.notify({type:"negative",message:s.message})});const n=Ie.value.objLib.findIndex(s=>s.name===e.name);n!==-1&&Ie.value.objLib.splice(n,1),at.saveLib()}function tl(e,n){kt.value&&e.online&&Wt.patch("hvacObjectLibs/"+e.id,{json:{label:n}}).then(async()=>{o.notify({type:"positive",message:"Successfully updated"})}).catch(_=>{o.notify({type:"negative",message:_.message})});const s=Ie.value.objLib.findIndex(_=>_.name===e.name);s!==-1&&(Ie.value.objLib[s].label=n),at.saveLib()}function nl(e){e.online&&Wt.delete("hvacTools/"+e.dbId||e.id.slice(4)).then(async()=>{o.notify({type:"positive",message:"Successfully deleted"})}).catch(s=>{o.notify({type:"negative",message:s.message})});const n=Ie.value.images.findIndex(s=>s.name===e.name);if(n!==-1&&(Ie.value.images.splice(n,1),!e.online)){if(Ie.value.images.length<=0)return;const s=We.exports.cloneDeep(Ie.value.images[n].path);Ye.value?Z.WebClient.DeleteImage(jt(s)):Z.WsClient.DeleteImage(jt(s)),at.saveLib()}}function Zn(e,n){var ee;if(e||(e=r.value.items[r.value.activeItemIndex]),!e)return;ie("Convert object to "+n);const s=We.exports.cloneDeep((ee=Xe.find(Q=>Q.name===n))==null?void 0:ee.settings)||{},_=Object.keys(s).reduce((Q,Se)=>(Q[Se]=s[Se].value,Q),{}),x={};for(const Q in _)Object.hasOwnProperty.call(_,Q)&&(e.settings[Q]!==void 0?x[Q]=e.settings[Q]:x[Q]=_[Q]);const f=["bgColor","textColor","title","t3EntryDisplayField"];for(const Q of f)x[Q]===void 0&&(x[Q]=e.settings[Q]);e.type=n,e.settings=x}function al(e){yt.value=e==="Enable",r.value.rulersGridVisible=yt.value,St(!1,!1)}function ll(e,n){const s=n.name==="Int_Ext_Wall"?{width:200,height:10}:{width:60,height:60};H(s,{clientX:e.clientX,clientY:e.clientY,top:e.clientY,left:e.clientX},n)}const ol=(e,n)=>{r.value.items.map(s=>{var _;((_=s==null?void 0:s.type)!=null?_:"")==="Weld"&&s.id===e.id&&(s.settings.weldItems=n)})},ea=(e,n)=>{r.value.items.map(s=>{var _,x,f,ee,Q;if((((_=s==null?void 0:s.type)!=null?_:"")==="Weld_General"||((x=s==null?void 0:s.type)!=null?x:"")==="Weld_Duct")&&s.id===e.id){const Se=(f=s==null?void 0:s.weldItems[0])==null?void 0:f.translate[0],Ee=(ee=s==null?void 0:s.weldItems[0])==null?void 0:ee.translate[1];(Q=s==null?void 0:s.weldItems)==null||Q.forEach(Re=>{const ye=n==null?void 0:n.find(He=>{var Et;return((Et=He==null?void 0:He.item)==null?void 0:Et.id)===(Re==null?void 0:Re.id)});ye&&(Re.width=ye.newPos.width,Re.height=ye.newPos.height,Re.translate[0]=Se+ye.newPos.trsx,Re.translate[1]=Ee+ye.newPos.trsy)})}})};function il(e){if(e.preventDefault(),!G.value&&b.value.name!=="Pointer"&&b.value.name!="Wall"&&!v.value&&b.value.name!="Int_Ext_Wall"&&b.value.name!="Duct"){var s={rect:{width:60,height:60,top:e.clientY,left:e.clientX},clientX:e.clientX,clientY:e.clientY};L(s),fe(Xe[0])}}function sl(e){e.preventDefault(),fe(Xe[0]),v.value&&(v.value=!1,Ht(),setTimeout(()=>{je()},10),At.Hvac.PageMain.ClearItemsWithZeroWidth(r),At.Hvac.PageMain.SetWallDimensionsVisible("all",v.value,r,!1))}function rl(e){const n=Ie.value.images.findIndex(s=>s.id==="IMG-"+e.id);n!==-1&&Ie.value.images.splice(n,1),Ie.value.images.push({id:"IMG-"+e.id,dbId:e.id,name:e.name,path:{}.API_URL+"/file/"+e.file.path,online:!0})}return(e,n)=>(D(),de(Ct,null,[t(gl,{style:{"background-color":"#ebeced"}},{default:l(()=>{var s,_,x;return[g("div",Ds,[g("div",Ts,[y(Ye)&&!y(G)?(D(),X(ql,{key:0,onMenuAction:Nn,object:y(r).items[y(r).activeItemIndex],"selected-count":(s=y(r).selectedTargets)==null?void 0:s.length,"disable-undo":y(G)||y(Ge).length<1,"disable-redo":y(G)||y(ft).length<1,"disable-paste":y(G)||!K.value,zoom:y(U),rulersGridVisible:y(yt)},null,8,["object","selected-count","disable-undo","disable-redo","disable-paste","zoom","rulersGridVisible"])):ke("",!0),!y(Ye)&&!y(G)?(D(),X(Es,{key:1,locked:y(G),onLockToggle:yn,onNavGoBack:wn,onMenuAction:Nn,object:y(r).items[y(r).activeItemIndex],"selected-count":(_=y(r).selectedTargets)==null?void 0:_.length,"disable-undo":y(G)||y(Ge).length<1,"disable-redo":y(G)||y(ft).length<1,"disable-paste":y(G)||!K.value,zoom:y(U),rulersGridVisible:y(yt),deviceModel:y(mt),onShowMoreDevices:ae},null,8,["locked","object","selected-count","disable-undo","disable-redo","disable-paste","zoom","rulersGridVisible","deviceModel"])):ke("",!0)]),g("div",$s,[y(G)?ke("",!0):(D(),de("div",Ps,[y(G)?ke("",!0):(D(),X(Go,{key:0,"selected-tool":b.value,images:y(Ie).images,"object-lib":y(Ie).objLib,onSelectTool:fe,onDeleteLibItem:el,onRenameLibItem:tl,onDeleteLibImage:nl,onSaveLibImage:Ba,onToolDropped:ll,isBuiltInEdge:y(Ye)},null,8,["selected-tool","images","object-lib","isBuiltInEdge"]))])),g("div",Ms,[g("div",Os,[!y(G)&&y(yt)?(D(),de("div",zs)):ke("",!0),!y(G)&&y(yt)?(D(),de("div",Ls,[t(Hl,{id:"h-ruler",documentArea:y(Ft)},null,8,["documentArea"])])):ke("",!0),!y(G)&&y(yt)?(D(),de("div",Rs,[t(Ql,{id:"v-ruler",documentArea:y(Ft)},null,8,["documentArea"])])):ke("",!0),!y(G)&&y(yt)?(D(),de("div",js,[t(Kl,{id:"hv-grid",documentArea:y(Ft)},null,8,["documentArea"])])):ke("",!0),g("div",{class:"viewport-wrapper",onScroll:n[11]||(n[11]=(...f)=>e.handleScroll&&e.handleScroll(...f))},[g("div",{class:Rt(["flex fixed top-20 ml-10 z-50 nav-btns",{locked:y(G)}])},[((x=y(Gt))==null?void 0:x.length)>1?(D(),X(J,{key:0,icon:"arrow_back",class:"back-btn mr-2",dense:"",round:"",size:"md",color:"primary",onClick:wn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[As]),_:1})]),_:1})):ke("",!0),y(Ye)?(D(),X(J,{key:1,icon:y(G)?"lock_outline":"lock_open",class:"lock-btn",flat:"",round:"",dense:"",size:"md",color:y(G)?"primary":"normal",onClick:yn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[y(G)?(D(),de("strong",Gs,"Unlock")):(D(),de("strong",Ws,"Lock"))]),_:1})]),_:1},8,["icon","color"])):ke("",!0)],2),g("div",null,[!y(Ye)&&y(G)?(D(),X(J,{key:0,icon:y(G)?"lock_outline":"lock_open",class:"lock-btn",flat:"",round:"",dense:"",size:"md",color:y(G)?"primary":"normal",onClick:yn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[y(G)?(D(),de("strong",Vs,"Unlock")):(D(),de("strong",Fs,"Lock"))]),_:1})]),_:1},8,["icon","color"])):ke("",!0)]),g("div",{class:"viewport",tabindex:"0",onMousemove:be,onContextmenu:nn(sl,["right"]),onMouseleave:Ve,onClick:nn(il,["left"]),onDragover:n[10]||(n[10]=f=>{f.preventDefault()})},[!y(G)&&b.value.name!=="Pointer"?(D(),X(Yt,{key:0,class:"cursor-icon",name:b.value.icon?b.value.icon:b.value.type==="libItem"?"space_dashboard":"photo",size:"sm",style:oa({left:V.value.x+0+"px",top:V.value.y+"px"})},null,8,["name","style"])):ke("",!0),t(y(Fn),{ref_key:"selecto",ref:a,dragContainer:".viewport",selectableTargets:y(G)?[]:c.value,hitRate:20,selectByClick:!y(G),selectFromInside:!0,toggleContinueSelect:["shift"],ratio:0,boundContainer:!0,getElementRect:y(Dn),onDragStart:Pe,onSelectEnd:Ae,onDragEnd:L,dragCondition:dn},null,8,["selectableTargets","selectByClick","getElementRect"]),g("div",{ref_key:"viewport",ref:Ul},[t(y(ro),{ref_key:"moveable",ref:dt,draggable:!y(G),resizable:!y(G),rotatable:!y(G),keepRatio:S.value,target:y(r).selectedTargets,snappable:p.value&&!y(G),snapThreshold:10,isDisplaySnapDigit:!0,snapGap:!0,snapDirections:{top:!0,right:!0,bottom:!0,left:!0},elementSnapDirections:{top:!0,right:!0,bottom:!0,left:!0},snapDigit:0,elementGuidelines:y(r).elementGuidelines,origin:!0,throttleResize:0,throttleRotate:0,rotationPosition:"top",originDraggable:!0,originRelative:!0,defaultGroupRotate:0,defaultGroupOrigin:"50% 50%",padding:{left:0,top:0,right:0,bottom:0},onClickGroup:Ue,onDragStart:Ke,onDrag:Je,onDragEnd:Ze,onDragGroupStart:Ne,onDragGroup:et,onDragGroupEnd:ot,onResizeStart:k,onResize:m,onResizeEnd:E,onRotateStart:T,onRotate:I,onRotateEnd:w,onResizeGroupStart:W,onResizeGroup:z,onResizeGroupEnd:F,onRotateGroupStart:le,onRotateGroup:A,onRotateGroupEnd:j,renderDirections:["n","nw","ne","s","se","sw","e","w"]},null,8,["draggable","resizable","rotatable","keepRatio","target","snappable","elementGuidelines"]),O.value?(D(),X(xt,{key:0,"touch-position":"",target:".moveable-area","context-menu":""},{default:l(()=>[t(lt,null,{default:l(()=>[ue((D(),X(oe,{dense:"",clickable:"",onClick:Jt},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"content_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Copy")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + C")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:hn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"content_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Duplicate")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + D")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:mn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"join_full",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Group")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + G")]),_:1})]),_:1})]),_:1})),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:bn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"join_inner",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Ungroup")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + Shift + G")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Qn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"library_books",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Add to Library")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + L")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:n[0]||(n[0]=f=>Ja())},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"flip_to_front",color:"grey-7","text-color":"white"})]),_:1}),t(P,{class:"py-2"},{default:l(()=>[$("Bring to front")]),_:1})]),_:1})),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:n[1]||(n[1]=f=>Za())},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"flip_to_back",color:"grey-7","text-color":"white"})]),_:1}),t(P,{class:"py-2"},{default:l(()=>[$("Send to Back")]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:n[2]||(n[2]=f=>Kn())},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"autorenew",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate 90\xB0")]),_:1})]),_:1})),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:n[3]||(n[3]=f=>Kn(!0))},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"sync",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate -90\xB0")]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:pn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"delete",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Delete")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Delete")]),_:1})]),_:1})]),_:1})),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:gn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"splitscreen",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Weld Selected")]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + B")]),_:1})]),_:1})]),_:1})),[[ve]])]),_:1})]),_:1})):ke("",!0),(D(!0),de(Ct,null,Dt(y(r).items,(f,ee)=>{var Q,Se,Ee,Re,ye,He,Et,Zt,re,me,ct,ut;return D(),de("div",{key:f.id,ref_for:!0,ref_key:"targets",ref:c,style:oa(`position: absolute; transform: translate(${f.translate[0]}px, ${f.translate[1]}px) rotate(${f.rotate}deg) scaleX(${f.scaleX}) scaleY(${f.scaleY}); width: ${f.width}px; height: ${f.height}px; z-index: ${f.zindex};`),id:`moveable-item-${f.id}`,onMousedown:nn(Nt,["right"]),class:Rt(`moveable-item-wrapper moveable-item-index-${ee} ${y(G)?"locked":""} ${q(f.id)?"item-selected":""}`)},[!y(G)&&((Q=y(r).selectedTargets)==null?void 0:Q.length)===1?(D(),X(xt,{key:0,"touch-position":"","context-menu":""},{default:l(()=>[t(lt,null,{default:l(()=>[Kt.value?(D(),X(oe,{key:0,dense:""},{default:l(()=>[Ys,t(Vt,{label:tt.value,modelValue:tt.value,"onUpdate:modelValue":n[4]||(n[4]=Y=>tt.value=Y),color:"blue",onClick:Y=>zt(f,"mode",Y),"false-value":"Auto","true-value":"Manual"},null,8,["label","modelValue","onClick"])]),_:2},1024)):ke("",!0),t(_e),Pt.value?(D(),X(oe,{key:1,dense:"",disable:gt.value},{default:l(()=>[Xs,t(Vt,{disable:gt.value,label:rt.value,modelValue:rt.value,"onUpdate:modelValue":n[5]||(n[5]=Y=>rt.value=Y),color:"blue",onClick:Y=>zt(f,"value",Y),"false-value":"Off","true-value":"On"},null,8,["disable","label","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),Mt.value?(D(),X(oe,{key:2,dense:"",disable:ht.value},{default:l(()=>[Us,t(ra,{style:{"margin-left":"15px","margin-top":"-5px"},disable:ht.value,dense:"",type:"number",modelValue:Ot.value,"onUpdate:modelValue":n[6]||(n[6]=Y=>Ot.value=Y),onClick:Y=>zt(f,"number-value",Y)},null,8,["disable","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:vn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"link",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Link")]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Jt},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"content_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Copy")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(nt,null,{default:l(()=>[$("Ctrl + C")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>pt(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"file_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Duplicate")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>ze(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"autorenew",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate 90\xB0")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>ze(f,!0)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"sync",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate -90\xB0")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>Le(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"flip",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Flip horizontal")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>it(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"flip",color:"grey-7","text-color":"white",style:{transform:"rotate(90deg)"}})]),_:1}),t(P,null,{default:l(()=>[$("Flip vertical")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>xe(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"flip_to_front",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Bring to front")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>he(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"flip_to_back",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Send to Back")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),t(oe,{dense:"",clickable:""},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"transform",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Convert to")]),_:1}),t(P,{side:""},{default:l(()=>[t(Yt,{name:"keyboard_arrow_right"})]),_:1}),t(xt,{anchor:"top end",self:"top start","auto-close":""},{default:l(()=>[t(lt,null,{default:l(()=>[(D(!0),de(Ct,null,Dt(y(Xe).filter(Y=>{var en;return Y.name!==((en=f==null?void 0:f.type)!=null?en:"")&&!["Duct","Pointer","Text"].includes(Y.name)}),Y=>ue((D(),X(oe,{key:Y.name,dense:"",clickable:"",onClick:en=>Zn(f,Y.name)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:Y.icon,color:"grey-7","text-color":"white"},null,8,["icon"])]),_:2},1024),t(P,null,{default:l(()=>[$(Oe(Y.name),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[ve]])),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(_e),ue((D(),X(oe,{dense:"",clickable:"",onClick:Y=>te(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(we,{size:"sm",icon:"remove",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Remove")]),_:1})]),_:2},1032,["onClick"])),[[ve]])]),_:2},1024)]),_:2},1024)):ke("",!0),xn.value&&((Se=y(r).selectedTargets)==null?void 0:Se.length)===0?(D(),X(xt,{key:1,"touch-position":"","context-menu":""},{default:l(()=>[t(lt,null,{default:l(()=>[t(oe,{dense:""},{default:l(()=>[Ns,t(Vt,{label:tt.value,modelValue:tt.value,"onUpdate:modelValue":n[7]||(n[7]=Y=>tt.value=Y),color:"blue",onClick:Y=>zt(f,"mode",Y),"false-value":"Auto","true-value":"Manual"},null,8,["label","modelValue","onClick"])]),_:2},1024),t(_e),Pt.value?(D(),X(oe,{key:0,dense:"",disable:gt.value},{default:l(()=>[qs,t(Vt,{disable:gt.value,label:rt.value,modelValue:rt.value,"onUpdate:modelValue":n[8]||(n[8]=Y=>rt.value=Y),color:"blue",onClick:Y=>zt(f,"value",Y),"false-value":"Off","true-value":"On"},null,8,["disable","label","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),Mt.value?(D(),X(oe,{key:1,dense:"",disable:ht.value},{default:l(()=>[Hs,t(ra,{style:{"margin-left":"15px","margin-top":"-5px"},disable:ht.value,dense:"",type:"number",modelValue:Ot.value,"onUpdate:modelValue":n[9]||(n[9]=Y=>Ot.value=Y),onClick:Y=>zt(f,"number-value",Y)},null,8,["disable","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),t(_e)]),_:2},1024)]),_:2},1024)):ke("",!0),((Ee=f==null?void 0:f.type)!=null?Ee:"")!=="Int_Ext_Wall"?(D(),X(Vl,{ref_for:!0,ref_key:"objectsRef",ref:B,item:f,key:f.id+((Re=f==null?void 0:f.type)!=null?Re:""),class:Rt({link:y(G)&&f.t3Entry}),"show-arrows":y(G)&&!!((ye=f.t3Entry)!=null&&ye.range),onObjectClicked:Y=>_n(f),onAutoManualToggle:Y=>Cn(f),onChangeValue:kn,onUpdateWeldModel:ol,onContextmenu:nn(Y=>Hn(f,Y),["right"])},null,8,["item","class","show-arrows","onObjectClicked","onAutoManualToggle","onContextmenu"])):ke("",!0),((He=f==null?void 0:f.type)!=null?He:"")==="Weld_General"||((Et=f==null?void 0:f.type)!=null?Et:"")==="Weld_Duct"?(D(),X(Xo,{ref_for:!0,ref_key:"objectsRef",ref:B,item:f,key:f.id+((Zt=f==null?void 0:f.type)!=null?Zt:""),class:Rt({link:y(G)&&f.t3Entry}),"show-arrows":y(G)&&!!((re=f.t3Entry)!=null&&re.range),onObjectClicked:Y=>_n(f),onAutoManualToggle:Y=>Cn(f),onChangeValue:kn,onUpdateWeldModel:ea},null,8,["item","class","show-arrows","onObjectClicked","onAutoManualToggle"])):ke("",!0),((me=f==null?void 0:f.type)!=null?me:"")==="Int_Ext_Wall"?(D(),X(eo,{ref_for:!0,ref_key:"objectsRef",ref:B,item:f,key:f.id+((ct=f==null?void 0:f.type)!=null?ct:"")+f.index,class:Rt({link:y(G)&&f.t3Entry}),"show-arrows":y(G)&&!!((ut=f.t3Entry)!=null&&ut.range),onObjectClicked:Y=>_n(f),onAutoManualToggle:Y=>Cn(f),onChangeValue:kn,onUpdateWeldModel:ea},null,8,["item","class","show-arrows","onObjectClicked","onAutoManualToggle"])):ke("",!0)],46,Bs)}),128))],512)],32)],32)])])])]),!y(G)&&y(r).items[y(r).activeItemIndex]&&(y(r).activeItemIndex||y(r).activeItemIndex===0)&&y(r).selectedTargets.length>0?(D(),X(Jl,{key:0,object:y(r).items[y(r).activeItemIndex],onRefreshMoveable:ja,onT3UpdateEntryField:st,onLinkT3Entry:vn,onGaugeSettings:Ya,onMounted:n[12]||(n[12]=f=>ie("Object settings opened")),onNoChange:Ka,onDisplayFieldValueChanged:un},null,8,["object"])):ke("",!0)]}),_:1}),t(an,{modelValue:y(Te).active,"onUpdate:modelValue":n[14]||(n[14]=s=>y(Te).active=s)},{default:l(()=>[t(Tt,{style:{"min-width":"650px"}},{default:l(()=>[t(vt,{class:"row items-center q-pb-none"},{default:l(()=>[Qs,t(En),ue(t(J,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),_:1}),t(_e),t(vt,{style:{height:"70vh"},class:"scroll"},{default:l(()=>[g("div",Ks,[t(J,{icon:"refresh",flat:"",onClick:qn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[Js]),_:1})]),_:1}),t(aa,{"option-label":Qt,"option-value":"id",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:y(Te).data,"onUpdate:modelValue":n[13]||(n[13]=s=>y(Te).data=s),options:y(on),onFilter:qt,label:"Select Entry",class:"grow"},{option:l(s=>[t(oe,ia(sa(s.itemProps)),{default:l(()=>[t(P,{class:"grow"},{default:l(()=>[t(Me,null,{default:l(()=>[$(Oe(Qt(s.opt)),1)]),_:2},1024)]),_:2},1024),t(P,{avatar:"",class:"pl-1 min-w-0"},{default:l(()=>[t(nt,{size:"sm",icon:"label_important"},{default:l(()=>[$("Panel: "+Oe(s.opt.pid),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),g("div",Zs,[y(Be).loadingPanel!==null?(D(),X(ga,{key:0,indeterminate:"","show-value":"",value:N.value,size:"270px",thickness:.22,color:"light-blue","track-color":"grey-3",class:"q-ma-md overflow-hidden"},{default:l(()=>[g("div",er,[g("div",null,Oe(N.value)+"%",1),g("div",null," Loading Panel #"+Oe(y(Be).panelsList[y(Be).loadingPanel].panel_number),1)])]),_:1},8,["value"])):ke("",!0)])]),_:1}),t(_e),t($n,{align:"right"},{default:l(()=>[ue(t(J,{flat:"",label:"Cancel",color:"primary"},null,512),[[ve]]),t(J,{flat:"",label:"Save",disable:!y(Te).data,color:"primary",onClick:fn},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(an,{modelValue:y(Qe).active,"onUpdate:modelValue":n[17]||(n[17]=s=>y(Qe).active=s)},{default:l(()=>[t(Tt,{style:{"min-width":"650px"}},{default:l(()=>[t(vt,{class:"row items-center q-pb-none"},{default:l(()=>[tr,t(En),ue(t(J,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),_:1}),t(_e),t(vt,{style:{height:"70vh"},class:"scroll"},{default:l(()=>[g("div",nr,[t(J,{icon:"refresh",flat:"",onClick:qn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[ar]),_:1})]),_:1}),t(aa,{"option-label":Qt,label:"Type or select Entry","option-value":"id",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:y(Qe).data,"onUpdate:modelValue":[n[15]||(n[15]=s=>y(Qe).data=s),n[16]||(n[16]=s=>za(e.value))],options:y(on),onFilter:qt,class:"grow",autofocus:"",onFocus:Ra},{option:l(s=>[t(oe,ia(sa(s.itemProps)),{default:l(()=>[t(P,{class:"grow"},{default:l(()=>[t(Me,null,{default:l(()=>[$(Oe(Qt(s.opt)),1)]),_:2},1024)]),_:2},1024),t(P,{avatar:"",class:"pl-1 min-w-0"},{default:l(()=>[t(nt,{size:"sm",icon:"label_important"},{default:l(()=>[$("Panel: "+Oe(s.opt.pid),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),g("div",lr,[y(Be).loadingPanel!==null?(D(),X(ga,{key:0,indeterminate:"","show-value":"",value:N.value,size:"270px",thickness:.22,color:"light-blue","track-color":"grey-3",class:"q-ma-md overflow-hidden"},{default:l(()=>[g("div",or,[g("div",null,Oe(N.value)+"%",1),g("div",null," Loading Panel #"+Oe(y(Be).panelsList[y(Be).loadingPanel].panel_number),1)])]),_:1},8,["value"])):ke("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Wl,{active:It.value.active,"onUpdate:active":n[18]||(n[18]=s=>It.value.active=s),data:It.value.data,onSaved:Xa},null,8,["active","data"]),t(an,{modelValue:M.value.active,"onUpdate:modelValue":n[20]||(n[20]=s=>M.value.active=s)},{default:l(()=>[t(Tt,{style:{"min-width":"450px"}},{default:l(()=>[t(vt,null,{default:l(()=>[ir]),_:1}),t(vt,{class:"q-pt-none"},{default:l(()=>[t(Gl,{types:["application/json"],onUploaded:Fa,onFileAdded:qa})]),_:1}),t($n,{align:"right",class:"text-primary"},{default:l(()=>[t(J,{flat:"",label:"Cancel",onClick:n[19]||(n[19]=s=>M.value.active=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(an,{modelValue:y(mt).active,"onUpdate:modelValue":n[21]||(n[21]=s=>y(mt).active=s)},{default:l(()=>[t(Tt,{style:{"min-width":"900px"}},{default:l(()=>[t(vt,{class:"row items-center q-pb-none"},{default:l(()=>[sr,t(En),ue(t(J,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),_:1}),t(_e),t(Zl,{deviceModel:y(mt),onUpdateDeviceModel:ce,onTestSendMsg:e.testSendMsg},null,8,["deviceModel","onTestSendMsg"])]),_:1})]),_:1},8,["modelValue"])],64))}};var xr=rn(rr,[["__scopeId","data-v-15846348"]]);export{xr as default};

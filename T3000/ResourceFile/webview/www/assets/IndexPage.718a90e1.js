import{Q as ge,a as ta,b as Me,c as na}from"./QExpansionItem.67bf6597.js";import{J as zn,o as D,K as fe,L as _a,M as _,y as ae,k as Ln,N as kt,O as Et,c as Y,w as l,a as t,P as de,Q as $,R as Oe,S as Bt,T as aa,U as Dt,V as _e,W as g,X as K,Y as vt,Z as $n,_ as Rn,$ as jn,m as An,n as ka,a0 as sl,a1 as rl,r as cl,a2 as ke,a3 as xe,a4 as Ft,a5 as ul,d as dl,C as fl,a6 as Lt,a7 as an,a8 as la,a9 as oa,aa as ia,ab as ln,ac as Rt,ad as sa}from"./index.a446fa3f.js";import{Q as at,a as se,b as P,c as Ct,C as ve,d as tt}from"./ClosePopup.d1fae0b1.js";import{Q as vl}from"./QPage.be1b2b29.js";import{M as pl,P as Pn,i as Ca,a as gl,E as hl,s as ml,D as bl,g as on,c as yl,b as _l,d as ra,e as kl,f as yt,h as Sn,j as ca,k as Vt,r as Cl,l as xl,m as wl,K as xa,G as Sl,n as Il,o as El,p as Dl,q as ua,t as Tl,u as $l,v as Pl,w as Ml,x as da,y as Ol,z as In,A as zl,B as fa,C as Ll,F as Rl,Q as wa,H as zt,I as Mn,J as Tt,L as ee,T as jt,N as va,O as En,R as pa,S as jl,U as Al,V as nt,W as He,X as Wl,Y as Dn,Z as Gl,_ as Fl}from"./QTree.206e14cb.js";import{u as Wn,l as At}from"./api.1a67fc33.js";import{u as Vl}from"./use-meta.02f16f7b.js";import{u as _t,d as Bl,T as Ve,g as Wt,a as r,m as dt,l as B,b as We,r as ft,c as je,i as Be,v as Yl,e as Gt,f as ht,h as mt,j as Te,s as sn,k as Ie,n as bt,o as Xl}from"./T3Data.b51b73fb.js";import{p as De,T as Ul,H as Nl,V as ql,a as Hl,O as Ql,D as Kl,W as Jl}from"./DeviceInfo.fad3ef35.js";import{F as Zl}from"./FileUploadS3.1ad5eb74.js";import{t as Ye,a as eo}from"./common.a643a366.js";import{_ as cn}from"./plugin-vue_export-helper.21dcd24c.js";import"./AntdIcon.b4be41d2.js";import"./QToolbar.8c6eee1f.js";const Sa={};pl.forEach(i=>{Sa[i]=function(...u){return this.$_moveable[i](...u)}});const Ia={};Pn.forEach(i=>{Ia[i]=function(u){this.$_moveable[i]=u}});const to=zn({name:"moveable",methods:Sa,props:Pn,watch:Ia,mounted(){const i={},u=this.$props;Pn.forEach(c=>{const b=u[c];Ca(b)||(i[c]=u[c])});const o=this.$refs.moveableElement,n=new gl(o,{...i,warpSelf:!0});hl.forEach(c=>{n.on(c,b=>{this.$emit(c,{...b})})}),this.$_moveable=n},beforeUnmount(){this.$_moveable.destroy()}}),no=to,ao=(i,u)=>{const h=i.__vccOpts||i;for(const[o,n]of u)h[o]=n;return h},lo={ref:"moveableElement"};function oo(i,u,h,o,n,c){return D(),fe("div",lo,null,512)}const io=ao(no,[["render",oo]]);var On=function(i,u){return On=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,o){h.__proto__=o}||function(h,o){for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(h[n]=o[n])},On(i,u)};function Ea(i,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");On(i,u);function h(){this.constructor=i}i.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}var $e=function(){return $e=Object.assign||function(u){for(var h,o=1,n=arguments.length;o<n;o++){h=arguments[o];for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&(u[c]=h[c])}return u},$e.apply(this,arguments)};function so(i,u){var h={};for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&u.indexOf(o)<0&&(h[o]=i[o]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(i);n<o.length;n++)u.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(i,o[n])&&(h[o[n]]=i[o[n]]);return h}function ro(i,u,h,o){var n=arguments.length,c=n<3?u:o===null?o=Object.getOwnPropertyDescriptor(u,h):o,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,u,h,o);else for(var v=i.length-1;v>=0;v--)(b=i[v])&&(c=(n<3?b(c):n>3?b(u,h,c):b(u,h))||c);return n>3&&c&&Object.defineProperty(u,h,c),c}function Yt(i,u,h){if(h||arguments.length===2)for(var o=0,n=u.length,c;o<n;o++)(c||!(o in u))&&(c||(c=Array.prototype.slice.call(u,0,o)),c[o]=u[o]);return i.concat(c||Array.prototype.slice.call(u))}function co(i){if("touches"in i){var u=i.touches[0]||i.changedTouches[0];return{clientX:u.clientX,clientY:u.clientY}}else return{clientX:i.clientX,clientY:i.clientY}}function uo(i){if(typeof Map=="undefined")return i.filter(function(h,o){return i.indexOf(h)===o});var u=new Map;return i.filter(function(h){return u.has(h)?!1:(u.set(h,!0),!0)})}function fo(i,u,h){var o=yt(i);return o.elementFromPoint&&o.elementFromPoint(u,h)||null}function Da(i,u,h){var o=i.tag,n=i.children,c=i.attributes,b=i.className,v=i.style,d=u||yt(h).createElement(o);for(var p in c)d.setAttribute(p,c[p]);var S=d.children;if(n.forEach(function(M,z){Da(M,S[z],d)}),b&&b.split(/\s+/g).forEach(function(M){M&&!$l(d,M)&&Pl(d,M)}),v){var R=d.style;for(var p in v)R[p]=v[p]}return!u&&h&&h.appendChild(d),d}function vo(i,u){for(var h=[],o=2;o<arguments.length;o++)h[o-2]=arguments[o];var n=u||{},c=n.className,b=c===void 0?"":c,v=n.style,d=v===void 0?{}:v,p=so(n,["className","style"]);return{tag:i,className:b,style:d,attributes:p,children:h}}function Tn(i,u,h){i!==u&&h(i,u)}function ga(i,u,h){var o;h===void 0&&(h=i.data.boundArea);var n=i.distX,c=n===void 0?0:n,b=i.distY,v=b===void 0?0:b,d=i.data,p=d.startX,S=d.startY;if(u>0){var R=Math.sqrt((c*c+v*v)/(1+u*u)),M=u*R;c=(c>=0?1:-1)*M,v=(v>=0?1:-1)*R}var z=Math.abs(c),q=Math.abs(v),U=c<0?p-h.left:h.right-p,J=v<0?S-h.top:h.bottom-S;o=Ml([z,q],[0,0],[U,J],!!u),z=o[0],q=o[1],c=(c>=0?1:-1)*z,v=(v>=0?1:-1)*q;var N=Math.min(0,c),le=Math.min(0,v),F=p+N,X=S+le;return{left:F,top:X,right:F+z,bottom:X+q,width:z,height:q}}function rn(i){var u=i.getBoundingClientRect(),h=u.left,o=u.top,n=u.width,c=u.height;return{pos1:[h,o],pos2:[h+n,o],pos3:[h,o+c],pos4:[h+n,o+c]}}function ha(i,u,h){var o=Vt(i,u),n=o.list,c=o.prevList,b=o.added,v=o.removed,d=o.maintained;return Yt(Yt(Yt([],b.map(function(p){return n[p]}),!0),v.map(function(p){return c[p]}),!0),h?d.map(function(p){var S=p[1];return n[S]}):[],!0)}function ma(i){for(var u=0,h=i.length,o=1;o<h;++o)u=Math.max(Ll(i[o],i[o-1]),u);return u}var Ta=ml(`
:host {
    position: fixed;
    display: none;
    border: 1px solid #4af;
    background: rgba(68, 170, 255, 0.5);
    pointer-events: none;
    will-change: transform;
    z-index: 100;
}
`),ba="selecto-selection ".concat(Ta.className),Gn=["className","boundContainer","selectableTargets","selectByClick","selectFromInside","continueSelect","continueSelectWithoutDeselect","toggleContinueSelect","toggleContinueSelectWithoutDeselect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio","getElementRect","preventDragFromInside","rootContainer","dragCondition","clickBySelectEnd","checkOverflow","innerScrollOptions"],ya=Yt(["dragContainer","cspNonce","preventClickEventOnDrag","preventClickEventOnDragStart","preventRightClick"],Gn,!0),po=["dragStart","drag","dragEnd","selectStart","select","selectEnd","keydown","keyup","scroll","innerScroll"],go=["clickTarget","getSelectableElements","setSelectedTargets","getElementPoints","getSelectedTargets","findSelectableTargets","triggerDragStart","checkScroll","selectTargetsByPoints","setSelectedTargetsByPoints"],ho=function(i){Ea(u,i);function u(o){o===void 0&&(o={});var n=i.call(this)||this;n.selectedTargets=[],n.dragScroll=new bl,n._onDragStart=function(v,d){var p=v.data,S=v.clientX,R=v.clientY,M=v.inputEvent,z=n.options,q=z.selectFromInside,U=z.selectByClick,J=z.rootContainer,N=z.boundContainer,le=z.preventDragFromInside,F=le===void 0?!0:le,X=z.clickBySelectEnd,ue=z.dragCondition;if(ue&&!ue(v)){v.stop();return}p.data={};var oe=on(n.container);p.innerWidth=oe.innerWidth,p.innerHeight=oe.innerHeight,n.findSelectableTargets(p),p.startSelectedTargets=n.selectedTargets,p.scaleMatrix=yl(),p.containerX=0,p.containerY=0;var re=n.container,ie={left:-1/0,top:-1/0,right:1/0,bottom:1/0};if(J){var lt=n.container.getBoundingClientRect();p.containerX=lt.left,p.containerY=lt.top,p.scaleMatrix=_l(n.container,J)}if(N){var Xe=ra(N)&&"element"in N?$e({left:!0,top:!0,bottom:!0,right:!0},N):{element:N,left:!0,top:!0,bottom:!0,right:!0},Ue=Xe.element,Qe=void 0;if(Ue){kl(Ue)?Qe=yt(re).querySelector(Ue):Ue===!0?Qe=n.container:Qe=Ue;var Ke=Qe.getBoundingClientRect();Xe.left&&(ie.left=Ke.left),Xe.top&&(ie.top=Ke.top),Xe.right&&(ie.right=Ke.right),Xe.bottom&&(ie.bottom=Ke.bottom)}}p.boundArea=ie;var Je={left:S,top:R,right:S,bottom:R,width:0,height:0},Ne=[],Ze=U&&!X,ot=!1;if(!q||Ze){var Pe=n._findElement(d||M.target,p.selectableTargets);ot=!!Pe,Ze&&(Ne=Pe?[Pe]:[])}var Re=!q&&ot;if(Re&&!U)return v.stop(),!1;var C=M.type,k=C==="mousedown"||C==="touchstart",m=!v.isClick&&k?n.emit("dragStart",$e($e({},v),{data:p.data})):!0;if(!m)return v.stop(),!1;if(n.continueSelect?(Ne=ha(n.selectedTargets,Ne,n.continueSelectWithoutDeselect),p.startPassedTargets=n.selectedTargets):p.startPassedTargets=[],n._select(Ne,Je,v,!0,Re&&U&&!X&&F),p.startX=S,p.startY=R,p.selectFlag=!1,p.preventDragFromInside=!1,M.target){var E=Sn(p.scaleMatrix,[S-p.containerX,R-p.containerY]);n.target.style.cssText+="position: ".concat(J?"absolute":"fixed",";")+"left:0px;top:0px;"+"transform: translate(".concat(E[0],"px, ").concat(E[1],"px)")}if(Re&&U&&!X)M.preventDefault(),F&&(n._selectEnd(p.startSelectedTargets,p.startPassedTargets,Je,v,!0),p.preventDragFromInside=!0);else{p.selectFlag=!0;var T=n.options,I=T.scrollOptions,w=T.innerScrollOptions,j=!1;if(w){for(var W=v.inputEvent,L=W.target,G=null,te=L;te&&te!==yt(re).body;){var A=getComputedStyle(te).overflow!=="visible";if(A){G=te;break}te=te.parentElement}G&&(p.innerScrollOptions=$e({container:G,checkScrollEvent:!0},w===!0?{}:w),n.dragScroll.dragStart(v,p.innerScrollOptions),j=!0)}!j&&I&&I.container&&n.dragScroll.dragStart(v,I),Re&&U&&X&&(p.selectFlag=!1,v.preventDrag())}return!0},n._onDrag=function(v){if(v.data.selectFlag){var d=n.scrollOptions,p=v.data.innerScrollOptions,S=p||(d==null?void 0:d.container);if(S&&!v.isScroll&&n.dragScroll.drag(v,p||d))return}n._checkSelected(v)},n._onDragEnd=function(v){var d=v.data,p=v.inputEvent,S=ga(v,n.options.ratio),R=d.selectFlag,M=n.container;if(p&&n.emit("dragEnd",$e($e({isDouble:!!v.isDouble,isClick:!!v.isClick,isDrag:!1,isSelect:R},v),{data:d.data,rect:S})),n.target.style.cssText+="display: none;",R)d.selectFlag=!1,n.dragScroll.dragEnd();else if(n.selectByClick&&n.clickBySelectEnd){var z=n._findElement((p==null?void 0:p.target)||fo(M,v.clientX,v.clientY),d.selectableTargets);n._select(z?[z]:[],S,v)}d.preventDragFromInside||n._selectEnd(d.startSelectedTargets,d.startPassedTargets,S,v)},n._onKeyDown=function(v){var d=n.options,p=!1;if(!n._keydownContinueSelect){var S=n._sameCombiKey(v,d.toggleContinueSelect);n._keydownContinueSelect=S,p||(p=S)}if(!n._keydownContinueSelectWithoutDeselection){var S=n._sameCombiKey(v,d.toggleContinueSelectWithoutDeselect);n._keydownContinueSelectWithoutDeselection=S,p||(p=S)}!p||n.emit("keydown",{keydownContinueSelect:n._keydownContinueSelect,keydownContinueSelectWithoutDeselection:n._keydownContinueSelectWithoutDeselection})},n._onKeyUp=function(v){var d=n.options,p=!1;if(n._keydownContinueSelect){var S=n._sameCombiKey(v,d.toggleContinueSelect,!0);n._keydownContinueSelect=!S,p||(p=S)}if(n._keydownContinueSelectWithoutDeselection){var S=n._sameCombiKey(v,d.toggleContinueSelectWithoutDeselect,!0);n._keydownContinueSelectWithoutDeselection=!S,p||(p=S)}!p||n.emit("keyup",{keydownContinueSelect:n._keydownContinueSelect,keydownContinueSelectWithoutDeselection:n._keydownContinueSelectWithoutDeselection})},n._onBlur=function(){(n._keydownContinueSelect||n._keydownContinueSelectWithoutDeselection)&&(n._keydownContinueSelect=!1,n._keydownContinueSelectWithoutDeselection=!1,n.emit("keyup",{keydownContinueSelect:n._keydownContinueSelect,keydownContinueSelectWithoutDeselection:n._keydownContinueSelectWithoutDeselection}))},n._onDocumentSelectStart=function(v){var d=yt(n.container);if(!!n.gesto.isFlag()){var p=n.dragContainer;p===on(n.container)&&(p=d.documentElement);var S=ca(p)?[p]:[].slice.call(p),R=v.target;S.some(function(M){if(M===R||M.contains(R))return v.preventDefault(),!0})}},n.target=o.portalContainer;var c=o.container;n.options=$e({className:"",portalContainer:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,clickBySelectEnd:!1,hitRate:100,continueSelect:!1,continueSelectWithoutDeselect:!1,toggleContinueSelect:null,toggleContinueSelectWithoutDeselect:null,keyContainer:null,scrollOptions:null,checkInput:!1,preventDefault:!1,boundContainer:!1,preventDragFromInside:!0,dragCondition:null,rootContainer:null,checkOverflow:!1,innerScrollOptions:!1,getElementRect:rn,cspNonce:"",ratio:0},o);var b=n.options.portalContainer;return b&&(c=b.parentElement),n.container=c||document.body,n.initElement(),n.initDragScroll(),n.setKeyController(),n}var h=u.prototype;return h.setSelectedTargets=function(o){var n=this.selectedTargets,c=Vt(n,o),b=c.added,v=c.removed,d=c.prevList,p=c.list;return this.selectedTargets=o,{added:b.map(function(S){return p[S]}),removed:v.map(function(S){return d[S]}),beforeSelected:n,selected:o}},h.setSelectedTargetsByPoints=function(o,n){var c=Math.min(o[0],n[0]),b=Math.min(o[1],n[1]),v=Math.max(o[0],n[0]),d=Math.max(o[1],n[1]),p={left:c,top:b,right:v,bottom:d,width:v-c,height:d-b},S={ignoreClick:!0};this.findSelectableTargets(S);var R=this.hitTest(p,S,!0,null),M=this.setSelectedTargets(R);return $e($e({},M),{rect:p})},h.selectTargetsByPoints=function(o,n){var c=new MouseEvent("mousedown",{clientX:o[0],clientY:o[1],cancelable:!0,bubbles:!0}),b=new MouseEvent("mousemove",{clientX:n[0],clientY:n[1],cancelable:!0,bubbles:!0}),v=new MouseEvent("mousemove",{clientX:n[0],clientY:n[1],cancelable:!0,bubbles:!0}),d=this.gesto,p=d.onDragStart(c);p!==!1&&(d.onDrag(b),d.onDragEnd(v))},h.getSelectedTargets=function(){return this.selectedTargets},h.triggerDragStart=function(o){return this.gesto.triggerDragStart(o),this},h.destroy=function(){var o;this.off(),this.keycon&&this.keycon.destroy(),this.gesto.unset(),this.injectResult.destroy(),this.dragScroll.dragEnd(),Cl(document,"selectstart",this._onDocumentSelectStart),this.options.portalContainer||(o=this.target.parentElement)===null||o===void 0||o.removeChild(this.target),this.keycon=null,this.gesto=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},h.getElementPoints=function(o){var n=this.getElementRect||rn,c=n(o),b=[c.pos1,c.pos2,c.pos4,c.pos3];if(n!==rn){var v=o.getBoundingClientRect();return xl(b,v)}return b},h.getSelectableElements=function(){var o=this.container,n=[];return this.options.selectableTargets.forEach(function(c){if(wl(c)){var b=c();b&&n.push.apply(n,[].slice.call(b))}else if(ca(c))n.push(c);else if(ra(c))n.push(c.value||c.current);else{var v=[].slice.call(yt(o).querySelectorAll(c));n.push.apply(n,v)}}),n},h.checkScroll=function(){if(!!this.gesto.isFlag()){var o=this.scrollOptions,n=this.gesto.getEventData().innerScrollOptions,c=n||(o==null?void 0:o.container);c&&this.dragScroll.checkScroll($e({inputEvent:this.gesto.getCurrentEvent()},n||o))}},h.findSelectableTargets=function(o){var n=this;o===void 0&&(o=this.gesto.getEventData());var c=this.getSelectableElements(),b=c.map(function(R){return n.getElementPoints(R)});o.selectableTargets=c,o.selectablePoints=b,o.selectableParentMap=null;var v=this.options,d=v.checkOverflow||v.innerScrollOptions,p=yt(this.container);if(d){var S=new Map;o.selectableInnerScrollParentMap=S,o.selectableInnerScrollPathsList=c.map(function(R,M){for(var z=R.parentElement,q=[],U=[],J=function(){var N=S.get(z);if(!N){var le=getComputedStyle(z).overflow!=="visible";if(le){var F=rn(z);N={parentElement:z,indexes:[],points:[F.pos1,F.pos2,F.pos4,F.pos3],paths:Yt([],U,!0)},q.push(z),q.forEach(function(X){S.set(X,N)}),q=[]}}N?(z=N.parentElement,S.get(z).indexes.push(M),U.push(z)):q.push(z),z=z.parentElement};z&&z!==p.body;)J();return U})}return v.checkOverflow||(o.selectableInners=c.map(function(){return!0})),this._refreshGroups(o),c},h.clickTarget=function(o,n){var c=co(o),b=c.clientX,v=c.clientY,d={data:{selectFlag:!1},clientX:b,clientY:v,inputEvent:o,isClick:!0,isTrusted:!1,stop:function(){return!1}};return this._onDragStart(d,n)&&this._onDragEnd(d),this},h.setKeyController=function(){var o=this.options,n=o.keyContainer,c=o.toggleContinueSelect,b=o.toggleContinueSelectWithoutDeselect;this.keycon&&(this.keycon.destroy(),this.keycon=null),(c||b)&&(this.keycon=new xa(n||on(this.container)),this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on("blur",this._onBlur))},h.setClassName=function(o){this.options.className=o,this.target.setAttribute("class","".concat(ba," ").concat(o||""))},h.setKeyEvent=function(){var o=this.options,n=o.toggleContinueSelect,c=o.toggleContinueSelectWithoutDeselect;!n&&!c||this.keycon||this.setKeyController()},h.setKeyContainer=function(o){var n=this,c=this.options;Tn(c.keyContainer,o,function(){c.keyContainer=o,n.setKeyController()})},h.getContinueSelect=function(){var o=this.options,n=o.continueSelect,c=o.toggleContinueSelect;return!c||!this._keydownContinueSelect?n:!n},h.getContinueSelectWithoutDeselect=function(){var o=this.options,n=o.continueSelectWithoutDeselect,c=o.toggleContinueSelectWithoutDeselect;return!c||!this._keydownContinueSelectWithoutDeselection?n:!n},h.setToggleContinueSelect=function(o){var n=this,c=this.options;Tn(c.toggleContinueSelect,o,function(){c.toggleContinueSelect=o,n.setKeyEvent()})},h.setToggleContinueSelectWithoutDeselect=function(o){var n=this,c=this.options;Tn(c.toggleContinueSelectWithoutDeselect,o,function(){c.toggleContinueSelectWithoutDeselect=o,n.setKeyEvent()})},h.setPreventDefault=function(o){this.gesto.options.preventDefault=o},h.setCheckInput=function(o){this.gesto.options.checkInput=o},h.initElement=function(){var o=this.options,n=o.dragContainer,c=o.checkInput,b=o.preventDefault,v=o.preventClickEventOnDragStart,d=o.preventClickEventOnDrag,p=o.preventClickEventByCondition,S=o.preventRightClick,R=S===void 0?!0:S,M=o.className,z=this.container;this.target=Da(vo("div",{className:"".concat(ba," ").concat(M||"")}),this.target,z);var q=this.target;this.dragContainer=typeof n=="string"?[].slice.call(yt(z).querySelectorAll(n)):n||this.target.parentNode,this.gesto=new Sl(this.dragContainer,{checkWindowBlur:!0,container:on(z),checkInput:c,preventDefault:b,preventClickEventOnDragStart:v,preventClickEventOnDrag:d,preventClickEventByCondition:p,preventRightClick:R}).on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd}),Il(document,"selectstart",this._onDocumentSelectStart),this.injectResult=Ta.inject(q,{nonce:this.options.cspNonce})},h.hitTest=function(o,n,c,b){var v=this.options,d=v.hitRate,p=v.selectByClick,S=o.left,R=o.top,M=o.right,z=o.bottom,q=n.innerGroups,U=n.innerWidth,J=n.innerHeight,N=b==null?void 0:b.clientX,le=b==null?void 0:b.clientY,F=n.ignoreClick,X=[[S,R],[M,R],[M,z],[S,z]],ue=function(Pe,Re){var C=typeof d=="function"?da("".concat(d(Re))):da("".concat(d)),k=F?!1:Ol([N,le],Pe);if(!c&&p&&k)return!0;var m=ua(X,Pe);if(!m.length)return!1;var E=In(m),T=0;if(E===0&&In(Pe)===0?(T=ma(Pe),E=ma(m)):T=In(Pe),C.unit==="px")return E>=C.value;var I=Rl(Math.round(E/T*100),0,100);return I>=Math.min(100,C.value)},oe=n.selectableTargets,re=n.selectablePoints,ie=n.selectableInners;if(!q)return oe.filter(function(Pe,Re){return ie[Re]?ue(re[Re],oe[Re]):!1});for(var lt=[],Xe=Math.floor(S/U),Ue=Math.floor(M/U),Qe=Math.floor(R/J),Ke=Math.floor(z/J),Je=Xe;Je<=Ue;++Je){var Ne=q[Je];if(!!Ne)for(var Ze=Qe;Ze<=Ke;++Ze){var ot=Ne[Ze];!ot||ot.forEach(function(Pe){var Re=re[Pe],C=ie[Pe],k=oe[Pe];C&&ue(Re,k)&&lt.push(k)})}}return uo(lt)},h.initDragScroll=function(){var o=this;this.dragScroll.on("scrollDrag",function(n){var c=n.next;c(o.gesto.getCurrentEvent())}).on("scroll",function(n){var c=n.container,b=n.direction,v=o.gesto.getEventData().innerScrollOptions;v?o.emit("innerScroll",{container:c,direction:b}):o.emit("scroll",{container:c,direction:b})}).on("move",function(n){var c=n.offsetX,b=n.offsetY,v=n.inputEvent,d=o.gesto;if(!(!d||!d.isFlag())){var p=o.gesto.getEventData(),S=p.boundArea;p.startX-=c,p.startY-=b;var R=o.gesto.getEventData().innerScrollOptions,M=R==null?void 0:R.container,z=!1;if(M){var q=p.selectableInnerScrollParentMap,U=q.get(M);U&&(U.paths.forEach(function(J){var N=q.get(J);N.points.forEach(function(le){le[0]-=c,le[1]-=b})}),U.indexes.forEach(function(J){p.selectablePoints[J].forEach(function(N){N[0]-=c,N[1]-=b})}),z=!0)}z||p.selectablePoints.forEach(function(J){J.forEach(function(N){N[0]-=c,N[1]-=b})}),o._refreshGroups(p),S.left-=c,S.right-=c,S.top-=b,S.bottom-=b,o.gesto.scrollBy(c,b,v.inputEvent),o._checkSelected(o.gesto.getCurrentEvent())}})},h._select=function(o,n,c,b,v){v===void 0&&(v=!1);var d=c.inputEvent,p=c.data,S=this.setSelectedTargets(o),R=Vt(p.startSelectedTargets,o),M=R.added,z=R.removed,q=R.prevList,U=R.list,J={startSelected:q,startAdded:M.map(function(N){return U[N]}),startRemoved:z.map(function(N){return q[N]})};b&&this.emit("selectStart",$e($e($e({},S),J),{rect:n,inputEvent:d,data:p.data,isTrusted:c.isTrusted,isDragStartEnd:v})),(S.added.length||S.removed.length)&&this.emit("select",$e($e($e({},S),J),{rect:n,inputEvent:d,data:p.data,isTrusted:c.isTrusted,isDragStartEnd:v}))},h._selectEnd=function(o,n,c,b,v){v===void 0&&(v=!1);var d=b.inputEvent,p=b.isDouble,S=b.data,R=d&&d.type,M=R==="mousedown"||R==="touchstart",z=Vt(o,this.selectedTargets),q=z.added,U=z.removed,J=z.prevList,N=z.list,le=Vt(n,this.selectedTargets),F=le.added,X=le.removed,ue=le.prevList,oe=le.list;this.emit("selectEnd",{startSelected:o,beforeSelected:n,selected:this.selectedTargets,added:q.map(function(re){return N[re]}),removed:U.map(function(re){return J[re]}),afterAdded:F.map(function(re){return oe[re]}),afterRemoved:X.map(function(re){return ue[re]}),isDragStart:M&&v,isDragStartEnd:M&&v,isClick:!!b.isClick,isDouble:!!p,rect:c,inputEvent:d,data:S.data,isTrusted:b.isTrusted})},h._checkSelected=function(o,n){n===void 0&&(n=ga(o,this.options.ratio));var c=o.data,b=n.top,v=n.left,d=n.width,p=n.height,S=c.selectFlag,R=c.containerX,M=c.containerY,z=c.scaleMatrix,q=Sn(z,[v-R,b-M]),U=Sn(z,[d,p]),J=[];if(S){this.target.style.cssText+="display: block;left:0px;top:0px;"+"transform: translate(".concat(q[0],"px, ").concat(q[1],"px);")+"width:".concat(U[0],"px;height:").concat(U[1],"px;");var N=this.hitTest(n,c,!0,o);J=ha(c.startPassedTargets,N,this.continueSelect&&this.continueSelectWithoutDeselect)}var le=this.emit("drag",$e($e({},o),{data:c.data,isSelect:S,rect:n}));if(le===!1){this.target.style.cssText+="display: none;",o.stop();return}S&&this._select(J,n,o)},h._sameCombiKey=function(o,n,c){if(!n)return!1;var b=El(o.inputEvent,o.key),v=[].concat(n),d=Dl(v[0])?v:[v];if(c){var p=o.key;return d.some(function(S){return S.some(function(R){return R===p})})}return d.some(function(S){return S.every(function(R){return b.indexOf(R)>-1})})},h._findElement=function(o,n){for(var c=o;c&&!(n.indexOf(c)>-1);)c=c.parentElement;return c},h._refreshGroups=function(o){var n,c=o.innerWidth,b=o.innerHeight,v=o.selectablePoints;if(this.options.checkOverflow){var d=(n=this.gesto.getEventData().innerScrollOptions)===null||n===void 0?void 0:n.container,p=o.selectableInnerScrollParentMap,S=o.selectableInnerScrollPathsList;o.selectableInners=S.map(function(z,q){var U=!1;return z.every(function(J){if(U)return!0;if(J===d)return U=!0,!0;var N=p.get(J);if(N){var le=v[q],F=N.points,X=ua(le,F);if(!X.length)return!1}return!0})})}if(!c||!b)o.innerGroups=null;else{var R=o.selectablePoints,M={};R.forEach(function(z,q){var U=1/0,J=-1/0,N=1/0,le=-1/0;z.forEach(function(ue){var oe=Math.floor(ue[0]/c),re=Math.floor(ue[1]/b);U=Math.min(oe,U),J=Math.max(oe,J),N=Math.min(re,N),le=Math.max(re,le)});for(var F=U;F<=J;++F)for(var X=N;X<=le;++X)M[F]=M[F]||{},M[F][X]=M[F][X]||[],M[F][X].push(q)}),o.innerGroups=M}},u=ro([zl(Gn,function(o,n){var c={enumerable:!0,configurable:!0,get:function(){return this.options[n]}},b=fa("get ".concat(n));o[b]?c.get=function(){return this[b]()}:c.get=function(){return this.options[n]};var v=fa("set ".concat(n));o[v]?c.set=function(d){this[v](d)}:c.set=function(d){this.options[n]=d},Object.defineProperty(o,n,c)})],u),u}(Tl),mo=function(i){Ea(u,i);function u(){return i!==null&&i.apply(this,arguments)||this}return u}(ho),bo=mo,Xt=function(){return Xt=Object.assign||function(u){for(var h,o=1,n=arguments.length;o<n;o++){h=arguments[o];for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&(u[c]=h[c])}return u},Xt.apply(this,arguments)},$a={};go.forEach(function(i){$a[i]=function(){for(var u,h=[],o=0;o<arguments.length;o++)h[o]=arguments[o];return(u=this.$_selecto)[i].apply(u,h)}});var Pa={};Gn.forEach(function(i){Pa[i]=function(u){return this.$_selecto[i]=u}});var Fn=zn({name:"selecto",methods:$a,props:ya,watch:Pa,mounted:function(){var i=this,u=this.$props,h={};ya.forEach(function(n){var c=u[n];Ca(c)||(h[n]=c)});var o=new bo(Xt(Xt({},h),{portalContainer:this.$refs.selectoElement}));this.$_selecto=o,po.forEach(function(n){o.on(n,function(c){i.$emit(n,Xt({},c))})})},beforeUnmount:function(){this.$_selecto.destroy()}});const yo={ref:"selectoElement"};function _o(i,u,h,o,n,c){return D(),fe("div",yo,null,512)}Fn.render=_o;Fn.__file="src/Selecto.vue";const Ma=i=>(Rn("data-v-dcfbc98a"),i=i(),jn(),i),ko={class:"tools flex column"},Co={key:0,class:"grid gap-4 grid-cols-4 grid-flow-row auto-rows-max p-4"},xo={class:"tool-wrapper"},wo=["onClick"],So={class:"flex flex-col flex-nowrap items-center justify-center h-full"},Io={class:"grow leading-4 text-black text-center text-ellipsis overflow-hidden flex items-center"},Eo={key:1,class:"flex p-4 items-center justify-center"},Do=Ma(()=>g("p",{class:"text-center"},[$(" The library is empty. "),g("br"),g("br"),$(" You can select some objects and save them"),g("br"),$(" to the library to easily reuse them. ")],-1)),To=[Do],$o={key:0,class:"grid gap-4 grid-cols-4 grid-flow-row auto-rows-max p-4"},Po={class:"tool-wrapper"},Mo=["onClick"],Oo={class:"flex flex-col items-center justify-center h-full"},zo=["src"],Lo={key:1,class:"flex p-4 items-center justify-center"},Ro=Ma(()=>g("div",{class:"text-h6"},"Upload image",-1)),jo={__name:"ToolsSidebar",props:{selectedTool:{type:Object,required:!0},images:{type:Array,default:()=>[]},objectLib:{type:Array,default:()=>[]},isBuiltInEdge:{type:Boolean}},emits:["selectTool","saveLibImage","deleteLibItem","renameLibItem","deleteLibImage","toolDropped"],setup(i,{emit:u}){_a(F=>({"4215c46a":_(le)}));const h=i,o=u,n=Wn(),c=ae(null),b=ae("lib");function v(F,X="default"){o("selectTool",F,X)}function d(F){n.dialog({title:"Confirm",message:"Are you sure you want to delete this library item?",cancel:!0}).onOk(()=>{o("deleteLibItem",F)}).onCancel(()=>{}).onDismiss(()=>{})}function p(F){n.dialog({title:"Confirm",message:"Are you sure you want to delete this image?",cancel:!0}).onOk(()=>{o("deleteLibImage",F)}).onCancel(()=>{}).onDismiss(()=>{})}function S(F){n.dialog({title:"Rename",message:"Type the new name",prompt:{model:F.label,type:"text"},cancel:!0,persistent:!0}).onOk(X=>{!X||o("renameLibItem",F,X)}).onCancel(()=>{}).onDismiss(()=>{})}const R=ae("list"),M=ae({uploadBtnDisabled:!0,uploadBtnLoading:!1,file:null});function z(F){console.log("file",F),M.value.uploadBtnDisabled=!1,M.value.file=F}function q(){_t.value?c.value.upload():J(M.value.file)}function U(F){J(F.body)}function J(F){o("saveLibImage",F),R.value="list",M.value.file=null}function N(F,X){o("toolDropped",F,X)}let le=ae("37px");return le.value=h.isBuiltInEdge?"37px":"93px",Ln(()=>h.isBuiltInEdge,F=>{le.value=F?"37px":"93px"}),(F,X)=>(D(),fe("div",ko,[(D(!0),fe(kt,null,Et(_(eo),ue=>(D(),Y(ta,{key:ue,class:"mb-2 border border-solid border-gray-700",dark:"","default-opened":"",label:ue,"header-class":"p-2 min-h-0","expand-icon-class":"!pl-2"},{default:l(()=>[t(at,{class:"rounded-borders text-primary grid grid-cols-2 gap-1 p-1"},{default:l(()=>[(D(!0),fe(kt,null,Et(_(Ye).filter(oe=>oe.cat.includes(ue)),oe=>de((D(),Y(se,{key:oe.name,onClick:re=>v(oe),onDragend:re=>N(re,oe),clickable:"",active:i.selectedTool.name===oe.name,"active-class":"active-tool",draggable:"true",class:"p-2 min-h-0"},{default:l(()=>[t(ge,{anchor:"center right",self:"center left"},{default:l(()=>[$(Oe(oe.label),1)]),_:2},1024),t(P,null,{default:l(()=>[t(Bt,{name:oe.icon,size:"sm"},null,8,["name"])]),_:2},1024)]),_:2},1032,["onClick","onDragend","active"])),[[aa]])),128))]),_:2},1024)]),_:2},1032,["label"]))),128)),t(ta,{class:"mb-2 border border-solid border-gray-700",dark:"","default-opened":"",label:"User","header-class":"p-2 min-h-0","expand-icon-class":"!pl-2"},{default:l(()=>[t(at,{class:"rounded-borders text-primary grid grid-cols-2 gap-1 p-1"},{default:l(()=>[de((D(),Y(se,{clickable:"","active-class":"active-tool",active:i.selectedTool.type!=="default",class:"p-2 min-h-0"},{default:l(()=>[t(ge,{anchor:"center right",self:"center left"},{default:l(()=>[$(" User objects library ")]),_:1}),t(Ct,{"separate-close-popup":"",anchor:"bottom right",self:"bottom left","max-height":"650px",onHide:X[7]||(X[7]=ue=>R.value="list")},{default:l(()=>[t(Dt,{dark:"",style:{"min-width":"500px",height:"400px"}},{default:l(()=>[t(wa,{modelValue:b.value,"onUpdate:modelValue":X[0]||(X[0]=ue=>b.value=ue),"inline-label":"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(zt,{name:"lib",icon:"library_books",label:"Library"}),t(zt,{name:"imgs",icon:"collections",label:"Images"})]),_:1},8,["modelValue"]),t(_e),t(Mn,{modelValue:b.value,"onUpdate:modelValue":X[6]||(X[6]=ue=>b.value=ue),animated:"",dark:"",style:{"max-height":"350px"},class:"scroll"},{default:l(()=>[t(Tt,{name:"lib"},{default:l(()=>{var ue;return[((ue=i.objectLib)==null?void 0:ue.length)>0?(D(),fe("div",Co,[(D(!0),fe(kt,null,Et(i.objectLib,oe=>(D(),fe("div",{key:oe.id,class:"relative"},[g("div",xo,[t(K,{round:"",dense:"",color:"grey-7",icon:"more_vert",size:"sm"},{default:l(()=>[t(Ct,{"separate-close-popup":""},{default:l(()=>[t(at,{style:{"min-width":"100px"}},{default:l(()=>[de((D(),Y(se,{clickable:"",onClick:re=>S(oe)},{default:l(()=>[t(P,null,{default:l(()=>[$("Rename")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),de((D(),Y(se,{clickable:"",onClick:re=>d(oe)},{default:l(()=>[t(P,null,{default:l(()=>[$("Delete")]),_:1})]),_:2},1032,["onClick"])),[[ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024),de((D(),fe("div",{class:"w-24 h-24 bg-slate-200 hover:bg-slate-500 p-2 rounded-lg cursor-pointer",onClick:re=>v(oe,"libItem")},[g("div",So,[g("div",null,[t(Bt,{color:"blue-10",name:"library_books",size:"xl"})]),g("div",Io,Oe(oe.label),1)])],8,wo)),[[ve]])])]))),128))])):(D(),fe("div",Eo,To))]}),_:1}),t(Tt,{name:"imgs",class:"py-1"},{default:l(()=>[t(Mn,{modelValue:R.value,"onUpdate:modelValue":X[5]||(X[5]=ue=>R.value=ue),animated:"",dark:""},{default:l(()=>[t(Tt,{name:"list",class:"p-0"},{default:l(()=>{var ue;return[t(K,{dense:"",onClick:X[1]||(X[1]=oe=>R.value="upload"),icon:"library_add",color:"white","text-color":"black",label:"Add Image"}),((ue=i.images)==null?void 0:ue.length)>0?(D(),fe("div",$o,[(D(!0),fe(kt,null,Et(i.images,oe=>(D(),fe("div",{key:oe.id,class:"relative"},[g("div",Po,[t(K,{round:"",dense:"",color:"grey-7",icon:"more_vert",size:"sm"},{default:l(()=>[t(Ct,null,{default:l(()=>[t(at,{style:{"min-width":"100px"}},{default:l(()=>[de((D(),Y(se,{clickable:"",onClick:re=>p(oe)},{default:l(()=>[t(P,null,{default:l(()=>[$("Delete")]),_:1})]),_:2},1032,["onClick"])),[[ve]])]),_:2},1024)]),_:2},1024)]),_:2},1024),de((D(),fe("div",{class:"w-24 h-24 bg-slate-200 hover:bg-slate-500 p-2 rounded-lg cursor-pointer",onClick:re=>v(oe,"Image")},[g("div",Oo,[g("img",{src:oe.path+"?w=95&h=95"},null,8,zo)])],8,Mo)),[[ve]])])]))),128))])):(D(),fe("div",Lo," No images yet. "))]}),_:1}),t(Tt,{name:"upload",class:"p-0"},{default:l(()=>[t(Dt,{dark:"",style:{"max-width":"468px"}},{default:l(()=>[t(vt,{class:"py-1"},{default:l(()=>[Ro]),_:1}),t(vt,{class:"q-pt-none"},{default:l(()=>[t(Zl,{ref_key:"fileUploaderRef",ref:c,path:"lib-images",types:["image/*"],height:240,onFileAdded:z,onFileRemoved:X[2]||(X[2]=ue=>M.value.uploadBtnDisabled=!0),onUploaded:U},null,512)]),_:1}),t($n,{align:"right",class:"text-primary pb-0"},{default:l(()=>[t(K,{flat:"",label:"Cancel",onClick:X[3]||(X[3]=ue=>R.value="list")}),t(K,{disabled:M.value.uploadBtnDisabled,loading:M.value.uploadBtnLoading,flat:"",label:"Save",onClick:X[4]||(X[4]=ue=>q())},null,8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(P,null,{default:l(()=>[t(Bt,{name:"add_circle_outline",size:"sm"})]),_:1})]),_:1},8,["active"])),[[aa]])]),_:1})]),_:1})]))}};var Ao=cn(jo,[["__scopeId","data-v-dcfbc98a"]]);const Wo={name:"CanvasShape",props:{item:{type:Object,required:!0}},emits:["updateWeldModel"],setup(i,{emit:u}){const h=ae(null),o=ae(null),n=ae(null),c=()=>{var k;const C=document.getElementById(`canvas${i.item.id}`);n.value=new De.Project(C),(k=n==null?void 0:n.value)==null||k.clear(),De.settings.insertItems=!1,b()},b=()=>{const C=o.value;if(C){const{width:k,height:m}=i.item;C.width=k,C.height=m,C.style.width=`${k}px`,C.style.height=`${m}px`,n.value.view.viewSize=new De.Size(C.width,C.height),Re()}},v=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=C=="weld"?8:4,W=new De.Path.Rectangle({point:T,size:[m-j,E-j],strokeColor:I.bgColor||"#000",strokeWidth:2,fillColor:I.fillColor});return C=="weld"&&w&&W.rotate(w),W},d=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=C=="weld"?8:4,W=m/2+T[0],L=E/2+T[1];return new De.Path.Circle({center:[W,L],radius:Math.min(m-j,E-j)/2,strokeColor:I.bgColor||"#000",strokeWidth:2,fillColor:I.fillColor})},p=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=1,W=`<svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 32 32"
            height="${E}"
            width="${m}"
            version="1.1">
            <path d="M 1.6 5.4 L 25.6 5.4 L 30.4 15 L 25.6 24.6 L 1.6 24.6 L 6.4 15 Z" fill="${I.fillColor}" stroke="${I.bgColor||"#000"}"
              stroke-width="${j}" stroke-miterlimit="10"></path>
          </svg>
          `;return M(W)},S=(C,k,m,E,T)=>{const{settings:I,rotate:w}=k,j=1,W=`<svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 32 32"
            height="${E}"
            width="${m}"
            version="1.1">
            <path d="M 6.4 5.4 L 25.6 5.4 L 30.4 15 L 25.6 24.6 L 6.4 24.6 L 1.6 15 Z" fill="${I.fillColor}" stroke="${I.bgColor||"#000"}"
              stroke-width="${j}" stroke-miterlimit="10">
            </path>
         </svg>
        `;return M(W)},R=(C,k,m,E,T,I)=>{const{settings:w,rotate:j}=k,W=new De.Path({segments:m,closed:!0,strokeColor:"#000",strokeWidth:2,fillColor:"#659dc5"});return j&&W.rotate(j),W},M=C=>De.project.importSVG(C,{applyMatrix:!1}),z=C=>{C==null||C.map((k,m)=>{const{width:E,height:T,weldModel:I,cat:w,type:j,settings:W}=k,L=[];switch(j){case"G_Rectangle":L.push(v("",k,E,T,[2,2]));break;case"G_Circle":L.push(d("",k,E,T,[2,2]));break;case"G_Step":L.push(p("",k,E,T));break;case"G_Hexagon":L.push(S("",k,E,T));break}L==null||L.map((G,te)=>{n.value.activeLayer.addChild(G)})})},q=ae(i.item.width),U=ae(i.item.height);ae(i.item.settings.fillColor);const J=()=>{const C=i.item.width/q.value,k=i.item.height/U.value,m=i.item.translate[0]/q.value,E=i.item.translate[1]/U.value;return{widthScale:C,heightScale:k,trsXScale:m,trsYScale:E}},N=ae(0),le=ae(0),F=(C,k)=>{N.value=Math.min(...C.map(A=>A.translate[0])),le.value=Math.min(...C.map(A=>A.translate[1]));const m=J();let{width:E,height:T,cat:I,type:w,translate:j}=k,[W,L]=j,G=W-N.value+4,te=L-le.value+4;return E=E*m.widthScale,T=T*m.heightScale,W*=m.widthScale,L*=m.heightScale,W-=N.value*m.widthScale,L-=le.value*m.heightScale,G=W+4,te=L+4,{width:E,height:T,trsx:G,trsy:te}},X=(C,k)=>{let{width:m,height:E,cat:T,type:I,translate:w,rotate:j,overlap:W}=k,[L,G]=w;const{isStartOverlap:te,isEndOverlap:A}=W,we=()=>{let Ce=25,he=25,Z=0;return m>50&&(m<80?Ce=he=m/2:(Ce=40,he=40,Z=m-80)),{startW:Ce,middle:Z,endW:he}},Ge=(Ce,he)=>{const Z=[],xt=we(),Ut=[Ce,he];Z.push(Ut);const st=[Ce+xt.startW,he+E/2],Nt=[Ce,he+E];te||Z.push(st),Z.push(Nt);const un=[Ce+xt.startW+xt.middle,he+E],dn=[Ce+m,he+E];A?Z.push(dn):Z.push(un);const qt=[Ce+m,he+E/2];A||Z.push(qt);const Ht=[Ce+m,he],fn=[Ce+xt.startW+xt.middle,he];return A?Z.push(Ht):Z.push(fn),Z.push(Ut),Z},O=Math.min(...C.map(Ce=>Ce.translate[0])),H=Math.min(...C.map(Ce=>Ce.translate[1])),me=J();let Ae=L-O+4,ze=G-H+4;return m=m*me.widthScale,E=E*me.heightScale,L*=me.widthScale,G*=me.heightScale,L-=O*me.widthScale,G-=H*me.heightScale,Ae=L+4,ze=G+4,{pathPoints:Ge(Ae,ze),width:m,height:E,trsx:Ae,trsy:ze}},ue=C=>C==null?void 0:C.map((m,E)=>{let T=null;const I=F(C,m);switch(m.type){case"G_Rectangle":T=v("weld",m,I.width,I.height,[I.trsx,I.trsy]);break;case"G_Circle":T=d("weld",m,I.width,I.height,[I.trsx,I.trsy]);break;case"G_Step":T=p("weld",m,I.width,I.height);break;case"G_Hexagon":T=S("weld",m,I.width,I.height);break;case"Duct":const w=X(C,m);T=R("weld",m,w.pathPoints);break}return{type:m.type,pathItem:T,item:m,newPos:{width:I.width,height:I.height,trsx:I.trsx-4,trsy:I.trsy-4}}}),oe=C=>{let k=[];return C instanceof De.Path||C instanceof De.CompoundPath||C instanceof De.Path.Circle?k.push(C):C instanceof De.Group?C.children.forEach(m=>{k=k.concat(oe(m))}):C!=null&&C.children&&(C==null||C.children.forEach(m=>{k=k.concat(oe(m))})),k},re=C=>C.flatMap(m=>{const I=oe(m.pathItem).flatMap(w=>w.segments.map(j=>j.point)).map(w=>new De.Point(w));return I.push(I[0]),{type:m.type,points:I}}),ie=C=>{let k=[];return C.slice(0,-1).map((m,E)=>{const T=m,I=C[E+1],w=4,j=2,W=new De.Path.Circle({center:T,radius:w,fillColor:"#4af"}),L=new De.Path.Circle({center:I,radius:w,fillColor:"#4af"}),G=new De.Path.Line({from:T,to:I,strokeColor:"#000",strokeWidth:j,fillColor:"#f36dc5"});k.push({name:`Path Line ${E+1}`,path:G,startPoint:W,endPoint:L})}),k},lt=(C,k,m,E,T)=>{const I=C.startPoint,w=C.endPoint,j=C.path;function W(){if(m>0){const O=k[m-1];O.endPoint.position=I.position,O.path.segments[1].point=I.position}else{const O=k[k.length-1];O.endPoint.position=I.position,O.path.segments[1].point=I.position}}function L(){if(m===k.length-1){const O=k[0];O.startPoint.position=w.position,O.path.segments[0].point=w.position}else{const O=k[m+1];O.startPoint.position=w.position,O.path.segments[0].point=w.position}}function G(O){E!==null&&(E.segments[m].point=I.position,E.segments[m+1].point=w.position,m+2==E.segments.length&&(E.segments[0].point=w.position),m==0&&(E.segments[E.segments.length-1].point=I.position))}function te(){j.segments[0].point=I.position,j.segments[1].point=w.position}function A(O){if(m>0){const H=k[m-1];H.endPoint.position=O,H.path.segments[1].point=O}else{const H=k[k.length-1];H.endPoint.position=O,H.path.segments[1].point=O}}function we(O){if(m===k.length-1){const H=k[0];H.startPoint.position=O,H.path.segments[0].point=O}else{const H=k[m+1];H.startPoint.position=O,H.path.segments[0].point=O}}function Ge(O){if(T===null)return;const{crossStartIndex:H,crossEndIndex:me}=C.crossPathIndex,{crossedStartIndex:Ae,crossedEndIndex:ze}=C.crossedPathIndex;T.forEach((it,Ce)=>{const{crossPath:he,crossLinePoints:Z}=it;he.segments[H]!==null&&he.segments[H]!==void 0&&(he.segments[H].point=I.position),he.segments[me]!==null&&he.segments[me]!==void 0&&(he.segments[me].point=w.position),he.segments[he.segments.length-1].point=he.segments[0].point,Z[Ae]!==null&&Z[Ae]!==void 0&&(Z[Ae].startPoint.position=I.position,Z[Ae].path.segments[0].point=I.position),Z[ze]!==null&&Z[ze]!==void 0&&(Z[ze].endPoint.position=w.position,Z[ze].path.segments[1].point=w.position),Z[Ae-1]!=null&&Z[Ae-1]!=null&&(Z[Ae-1].endPoint.position=I.position,Z[Ae-1].path.segments[1].point=I.position),me!==-1&&Z[ze+1]!=null&&Z[ze+1]!=null&&(Z[ze+1].startPoint.position=w.position),Z[Z.length-1]!==null&&Z[Z.length-1]!==void 0&&(Z[Z.length-1].endPoint.position=Z[0].startPoint.position)})}I.onMouseDrag=function(O){this.position=this.position.add(O.delta),te(),G(`startCircle=>[x=${this.position.x},y=${this.position.y}]`),W(),Ge()},w.onMouseDrag=function(O){this.position=this.position.add(O.delta),te(),G(`endCircle=>[x=${this.position.x},y=${this.position.y}]`),L(),Ge()},j.onMouseDrag=function(O){const H=O.delta;I.position=I.position.add(H),w.position=w.position.add(H),te(),G(`line=>[x=${I.position.x},y=${I.position.y}], [x=${w.position.x},y=${w.position.y}]`),A(I.position),we(w.position),Ge()}},Xe=(C,k,m,E,T,I)=>{function w(){if(m>0){const O=k[m-1];O.endPoint.position=A.position,O.path.segments[1].point=A.position}else{const O=k[k.length-1];O.endPoint.position=A.position,O.path.segments[1].point=A.position}}function j(){if(m===k.length-1){const O=k[0];O.startPoint.position=we.position,O.path.segments[0].point=we.position}else{const O=k[m+1];O.startPoint.position=we.position,O.path.segments[0].point=we.position}}function W(O){T!==null&&(T.segments[m].point=A.position,T.segments[m+1].point=we.position,m+2==T.segments.length&&(T.segments[0].point=we.position),m==0&&(T.segments[T.segments.length-1].point=A.position))}function L(){Ge.segments[0].point=A.position,Ge.segments[1].point=we.position}function G(O){if(m>0){const H=k[m-1];H.endPoint.position=O,H.path.segments[1].point=O}else{const H=k[k.length-1];H.endPoint.position=O,H.path.segments[1].point=O}}function te(O){if(m===k.length-1){const H=k[0];H.startPoint.position=O,H.path.segments[0].point=O}else{const H=k[m+1];H.startPoint.position=O,H.path.segments[0].point=O}}const A=C.startPoint,we=C.endPoint,Ge=C.path;A.onMouseDrag=function(O){this.position=this.position.add(O.delta),L(),W(`startCircle=>[x=${this.position.x},y=${this.position.y}]`),w()},we.onMouseDrag=function(O){this.position=this.position.add(O.delta),L(),W(`endCircle=>[x=${this.position.x},y=${this.position.y}]`),j()},Ge.onMouseDrag=function(O){const H=O.delta;A.position=A.position.add(H),we.position=we.position.add(H),L(),W(`line=>[x=${A.position.x},y=${A.position.y}], [x=${we.position.x},y=${we.position.y}]`),G(A.position),te(we.position)},T.onMouseDrag=function(O){const H=O.delta;T.position.x+=H.x,k.map((me,Ae)=>{me.startPoint.position.x+=H.x,me.endPoint.position.x+=H.x,me.path.segments[0].point.x=me.startPoint.position.x,me.path.segments[1].point.x=me.endPoint.position.x;const{weldStartIndex:ze,weldEndIndex:it}=me.weldPathIndex,{weldedStartIndex:Ce,weldedEndIndex:he}=me.weldedPathIndex;E.segments[ze]!==null&&E.segments[ze]!==void 0&&(E.segments[ze].point=me.startPoint.position),E.segments[it]!==null&&E.segments[it]!==void 0&&(E.segments[it].point=me.endPoint.position),I[Ce]!==null&&I[Ce]!==void 0&&(I[Ce].startPoint.position=me.startPoint.position,I[Ce].path.segments[0].point=me.startPoint.position),I[he]!==null&&I[he]!==void 0&&(I[he].endPoint.position=me.endPoint.position,I[he].path.segments[1].point=me.endPoint.position)})}},Ue=(C,k,m,E)=>{C.map((T,I)=>{const w=T.startPoint,j=T.endPoint,W=m.segments.findIndex(A=>A.point.x.toFixed(4)===w.position.x.toFixed(4)&&A.point.y.toFixed(4)===w.position.y.toFixed(4)),L=m.segments.findIndex(A=>A.point.x.toFixed(4)===j.position.x.toFixed(4)&&A.point.y.toFixed(4)===j.position.y.toFixed(4)),G=k.findIndex(A=>A.startPoint.position.x.toFixed(4)===w.position.x.toFixed(4)&&A.startPoint.position.y.toFixed(4)===w.position.y.toFixed(4)),te=k.findIndex(A=>A.endPoint.position.x.toFixed(4)===j.position.x.toFixed(4)&&A.endPoint.position.y.toFixed(4)===j.position.y.toFixed(4));T.weldPathIndex={weldStartIndex:W,weldEndIndex:L},T.weldedPathIndex={weldedStartIndex:G,weldedEndIndex:te}}),k.map((T,I)=>{const w=T.startPoint,j=T.endPoint,W=E.segments.findIndex(A=>A.point.x.toFixed(4)===w.position.x.toFixed(4)&&A.point.y.toFixed(4)===w.position.y.toFixed(4)),L=E.segments.findIndex(A=>A.point.x.toFixed(4)===j.position.x.toFixed(4)&&A.point.y.toFixed(4)===j.position.y.toFixed(4)),G=C.findIndex(A=>A.startPoint.position.x.toFixed(4)===w.position.x.toFixed(4)&&A.startPoint.position.y.toFixed(4)===w.position.y.toFixed(4)),te=C.findIndex(A=>A.endPoint.position.x.toFixed(4)===j.position.x.toFixed(4)&&A.endPoint.position.y.toFixed(4)===j.position.y.toFixed(4));T.crossPathIndex={crossStartIndex:W,crossEndIndex:L},T.crossedPathIndex={crossedStartIndex:G,crossedEndIndex:te}})},Qe=C=>{let k=[];return C.slice(0,-1).map((m,E)=>{const T=m,I=C[E+1],w=4,j=2,W=new De.Path.Circle({center:T,radius:w,fillColor:"#4af"}),L=new De.Path.Circle({center:I,radius:w,fillColor:"#4af"}),G=new De.Path.Line({from:T,to:I,strokeColor:"#000",strokeWidth:j,fillColor:"green"});k.push({name:`Cross Path Line ${E+1}`,path:G,startPoint:W,endPoint:L})}),k},Ke=C=>C.map((m,E)=>new De.Path({segments:m.points,closed:!0,strokeColor:"#000",fillColor:"#f36dc5"})),Je=(C,k)=>{if(!(C!==null&&C!=null&&C.length>0))return;const E=new De.Path({segments:C,closed:!0,fillColor:"#659dc5"}),T=ie(C),I=k.map((w,j)=>{const W=new De.Path({segments:w.pts,closed:!0,fillColor:"#659dc5"}),L=Qe(w.pts);return Ue(L,T,E,W),L.map((G,te)=>{Xe(G,L,te,E,W,T)}),{crossPath:W,crossLinePoints:L}});T.map((w,j)=>{lt(w,T,j,E,I)}),n.value.activeLayer.addChild(E),I.map((w,j)=>{var W,L;(L=(W=n==null?void 0:n.value)==null?void 0:W.activeLayer)==null||L.addChild(w.crossPath)}),T.map((w,j)=>{var W,L,G,te,A,we;(L=(W=n==null?void 0:n.value)==null?void 0:W.activeLayer)==null||L.addChild(w.path),(te=(G=n==null?void 0:n.value)==null?void 0:G.activeLayer)==null||te.addChild(w.startPoint),(we=(A=n==null?void 0:n.value)==null?void 0:A.activeLayer)==null||we.addChild(w.endPoint)})},Ne=C=>{let k=-1/0,m=-1/0;for(const E of C){const T=Math.min(...E.points.map(w=>w==null?void 0:w.x)),I=Math.min(...E.points.map(w=>w==null?void 0:w.y));if(T>k||I>m)k=Math.max(...E.points.map(w=>w==null?void 0:w.x)),m=Math.max(...E.points.map(w=>w==null?void 0:w.y));else return!0}return!1},Ze=()=>{var W;const{weldItems:C}=i.item,k=ue(C);u("updateWeldModel",i.item,k),q.value=i.item.width,U.value=i.item.height,N.value=Math.min(...i.item.weldItems.map(L=>L.translate[0])),le.value=Math.min(...i.item.weldItems.map(L=>L.translate[1]));const m=re(k);if(!Ne(m)){k.map((L,G)=>{n.value.activeLayer.addChild(L.pathItem)});return}const T=Ke(m),I=Pe("union",T),w=(W=I==null?void 0:I.segments)==null?void 0:W.map(L=>L.point);w==null||w.push(w[0]);const j=ot(T,w);Je(w,j)},ot=(C,k)=>{const E=(j=>{const W=[];for(let L=0;L<j.length;L++)for(let G=L+1;G<j.length;G++)j[L].getIntersections(j[G]).forEach(A=>{W.push(A.point)});return W})(C),I=((j,W)=>j.map(G=>{const te=W.findIndex(A=>(A==null?void 0:A.x.toFixed(4))===(G==null?void 0:G.x.toFixed(4))&&(A==null?void 0:A.y.toFixed(4))===(G==null?void 0:G.y.toFixed(4)));return{crossPoint:G,index:te}}).sort((G,te)=>te.index-G.index))(E,k),w=[];for(let j=I.length-1;j>0;j-=2){const W=I[j].index,L=I[j-1].index,G=[];for(let te=W;te<=L;te++)G.push(k[te]);G.push(G[0]),w.push({idx:`${W}-${L}`,pts:G})}return w},Pe=(C,k)=>{if(k.length===0)return[];if(k.length<2)return k[0];let m=k[0];for(let E=1;E<k.length;E++)switch(C){case"union":m=m.unite(k[E]);break;case"difference":m=m.subtract(k[E]);break;case"xor":m=m.exclude(k[E]);break;case"intersection":m=m.intersect(k[E]);break;default:throw new Error("Invalid boolean operation")}return m},Re=()=>{var w;const{width:C,height:k,weldModel:m,cat:E,type:T,settings:I}=i.item;(w=n==null?void 0:n.value)==null||w.clear(),T==="Weld_General"||T==="Weld_Duct"?Ze():z([i.item])};return An(()=>{c(),Ln(()=>[i.item.width,i.item.height,i.item.settings],b,{deep:!0}),window.addEventListener("resize",b)}),ka(()=>{var C;(C=n.value)==null||C.clear(),window.removeEventListener("resize",b)}),{canvasContainer:h,canvas:o,initCanvas:c,resizeCanvas:b,draw:Re,loadSvgString:M,booleanOperation:Pe}}},Go={ref:"canvasContainer",class:"canvas-container"},Fo=["id"];function Vo(i,u,h,o,n,c){return D(),fe("div",Go,[g("canvas",{id:`canvas${h.item.id}`,ref:"canvas",resize:"",stats:"",class:"canvas-normal"},null,8,Fo)],512)}var Bo=cn(Wo,[["render",Vo],["__scopeId","data-v-083c08a3"]]);const Yo=zn({name:"NewTopToolBar",props:{locked:{type:Boolean,default:!1},grpNav:{type:Array,default:()=>[]},object:{type:Object,required:!1},selectedCount:{type:Number,required:!0},disableUndo:{type:Boolean,required:!1},disableRedo:{type:Boolean,required:!1},disablePaste:{type:Boolean,required:!1},zoom:{type:Number,required:!0},rulersGridVisible:{type:Boolean,required:!1},deviceModel:{type:Object,required:!1}},emits:["navGoBack","lockToggle","menuAction","showMoreDevices"],setup(i,{emit:u}){const h=ae(null),o=ae("Device (-)"),n=sl(),c=rl(),b=U=>{n.push({path:U})},v=()=>{n.push({path:"/login",query:{redirect:c.path}})},d=Wn();function p(U,J=null){u("menuAction",U,J)}function S(){d.cookies.remove("token"),_t.value=null,localStorage.removeItem("user")}const R=ae(i.rulersGridVisible?"Enable":"Disable");Ln(()=>i.rulersGridVisible,U=>{R.value=U?"Enable":"Disable"});const M=()=>{u("navGoBack")},z=()=>{u("lockToggle")},q=()=>{u("showMoreDevices")};return An(()=>{h.value=i.deviceModel,o.value=`Device (${i.deviceModel.data.device})`}),{tab:ae("home"),navGoBack:M,lockToggle:z,menuActionEmit:p,logout:S,tools:Ye,user:_t,showRulersGrid:R,showMoreDevices:q,currentDevice:h,deviceTabTitle:o,devVersion:Bl,navigateTo:b,navigateToLogin:v}}}),pe=i=>(Rn("data-v-72bff07c"),i=i(),jn(),i),Xo={class:"tool-bar-container"},Uo={class:"left-panel"},No={class:"tool-title"},qo=pe(()=>g("p",{style:{"font-size":"12px"}},"T3000 Havc",-1)),Ho={style:{"margin-left":"0px","font-size":"10px",color:"gray","z-index":"99",position:"absolute","margin-top":"0px"}},Qo={class:"tool-btns"},Ko={key:0},Jo={key:1},Zo=pe(()=>g("strong",null,"Go back",-1)),ei={class:"right-panel"},ti={style:{"margin-left":"auto"}},ni={class:"container"},ai={class:"sub-div"},li={class:"button-row"},oi=pe(()=>g("strong",null,"Copy",-1)),ii=pe(()=>g("em",null," (Ctrl + C)",-1)),si={class:"button-row"},ri=pe(()=>g("strong",null,"Copy",-1)),ci=pe(()=>g("em",null," (Ctrl + V)",-1)),ui={class:"sub-div"},di={class:"button-row"},fi=pe(()=>g("strong",null,"Undo",-1)),vi=pe(()=>g("em",null," (Ctrl + Z)",-1)),pi={class:"button-row"},gi=pe(()=>g("strong",null,"Redo",-1)),hi=pe(()=>g("em",null," (Ctrl + Y)",-1)),mi={class:"sub-div"},bi={class:"button-row"},yi=pe(()=>g("strong",null,"Delete selected",-1)),_i=pe(()=>g("em",null," (Delete)",-1)),ki={class:"sub-div"},Ci={class:"button-row"},xi=pe(()=>g("strong",null,"Group selected",-1)),wi=pe(()=>g("em",null," (Ctrl + G)",-1)),Si={class:"button-row"},Ii=pe(()=>g("strong",null,"Ungroup selected",-1)),Ei=pe(()=>g("em",null," (Ctrl + Shift + G)",-1)),Di={class:"sub-div"},Ti={class:"button-row"},$i=pe(()=>g("strong",null,"Add selected to library",-1)),Pi=pe(()=>g("em",null," (Ctrl + L)",-1)),Mi={class:"button-row"},Oi=pe(()=>g("strong",null,"Duplicate selected",-1)),zi=pe(()=>g("em",null," (Ctrl + D)",-1)),Li={class:"sub-div"},Ri={class:"button-row"},ji=pe(()=>g("strong",null,"Weld selected",-1)),Ai=pe(()=>g("em",null," (Ctrl + B)",-1)),Wi={class:"sub-div"},Gi={class:"button-row"},Fi=pe(()=>g("strong",null,"Link",-1)),Vi={class:"button-row"},Bi=pe(()=>g("strong",null,"Convert to",-1)),Yi={class:"sub-div"},Xi={class:"button-row"},Ui=pe(()=>g("strong",null,"Rotate 90\xB0",-1)),Ni={class:"button-row"},qi=pe(()=>g("strong",null,"Rotate -90\xB0",-1)),Hi={class:"sub-div"},Qi={class:"button-row"},Ki=pe(()=>g("strong",null,"Flip horizontal",-1)),Ji={class:"button-row"},Zi=pe(()=>g("strong",null,"Flip vertical",-1)),es={class:"sub-div"},ts={class:"button-row"},ns=pe(()=>g("strong",null,"Bring to front",-1)),as={class:"button-row"},ls=pe(()=>g("strong",null,"Send to Back",-1)),os={class:"sub-div"},is={class:"button-row"},ss=pe(()=>g("span",{style:{"font-size":"11px"}},"Rulers & Grid",-1)),rs={class:"button-row",style:{"margin-top":"-3px"}},cs={class:"flex items-center px-1",style:{"font-size":"12px"}},us=["value"],ds={class:"container"},fs={class:"sub-div"},vs={class:"button-row"},ps=pe(()=>g("span",{class:"file-short-cut"},"(Ctrl + R)",-1)),gs={class:"sub-div"},hs={class:"button-row"},ms={class:"sub-div"},bs={class:"button-row"},ys={class:"row device-row"},_s={class:"text-weight-medium select-text"},ks={class:"text-weight-medium select-text"},Cs={class:"text-weight-medium select-text"},xs={class:"text-weight-medium select-text"};function ws(i,u,h,o,n,c){var v;const b=cl("q-link");return D(),fe("div",Xo,[g("div",Uo,[g("div",No,[qo,g("span",Ho,Oe(i.devVersion),1)]),g("div",Qo,[t(K,{dense:"",flat:"",round:"",icon:"menu",size:"sm",onClick:i.lockToggle},null,8,["onClick"]),t(K,{icon:i.locked?"lock_outline":"lock_open",class:"lock-btn",flat:"",round:"",dense:"",size:"sm",color:i.locked?"primary":"normal",onClick:i.lockToggle},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[i.locked?(D(),fe("strong",Jo,"Unlock")):(D(),fe("strong",Ko,"Lock"))]),_:1})]),_:1},8,["icon","color","onClick"]),((v=i.grpNav)==null?void 0:v.length)>=0?(D(),Y(K,{key:0,icon:"arrow_back",class:"back-btn mr-2",dense:"",round:"",size:"sm",onClick:i.navGoBack},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[Zo]),_:1})]),_:1},8,["onClick"])):ke("",!0)])]),g("div",ei,[t(Dt,{class:"right-panel-card"},{default:l(()=>[t(wa,{modelValue:i.tab,"onUpdate:modelValue":u[1]||(u[1]=d=>i.tab=d),dense:"",class:"right-tab text-white","active-color":"#fff","indicator-color":"#fff",align:"left","narrow-indicator":""},{default:l(()=>[t(zt,{name:"home","no-caps":"",label:"Home"}),t(zt,{name:"file","no-caps":"",label:"File"}),t(zt,{name:"device","no-caps":"",label:`Device (${i.deviceModel.data.device===void 0?"-":i.deviceModel.data.device})`},null,8,["label"]),t(zt,{name:"newui","no-caps":"",label:"New UI",onClick:u[0]||(u[0]=d=>i.navigateTo("hvac/t2"))}),g("div",ti,[t(K,{flat:"",color:"primary",label:"Login",onClick:i.navigateToLogin},null,8,["onClick"])])]),_:1},8,["modelValue"]),t(_e),t(Mn,{modelValue:i.tab,"onUpdate:modelValue":u[27]||(u[27]=d=>i.tab=d),class:"tab-panel"},{default:l(()=>[t(Tt,{name:"home",class:"home-panel"},{default:l(()=>[g("div",ni,[g("div",ai,[g("div",li,[t(K,{flat:"",size:"sm",icon:"content_copy","no-caps":"",onClick:u[2]||(u[2]=d=>i.menuActionEmit("copy")),disable:i.selectedCount<1},{default:l(()=>[$("Copy "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[oi,ii]),_:1})]),_:1},8,["disable"])]),g("div",si,[t(K,{flat:"",size:"sm",icon:"content_paste","no-caps":"",onClick:u[3]||(u[3]=d=>i.menuActionEmit("paste")),disable:i.disablePaste},{default:l(()=>[$("Paste "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ri,ci]),_:1})]),_:1},8,["disable"])])]),g("div",ui,[g("div",di,[t(K,{flat:"",size:"sm",icon:"undo","no-caps":"",onClick:u[4]||(u[4]=d=>i.menuActionEmit("undoAction")),disable:i.disableUndo},{default:l(()=>[$("Undo "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[fi,vi]),_:1})]),_:1},8,["disable"])]),g("div",pi,[t(K,{flat:"",size:"sm",icon:"redo","no-caps":"",onClick:u[5]||(u[5]=d=>i.menuActionEmit("redoAction")),disable:i.disableRedo},{default:l(()=>[$("Redo "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[gi,hi]),_:1})]),_:1},8,["disable"])])]),g("div",mi,[g("div",bi,[t(K,{flat:"",size:"sm",icon:"delete","no-caps":"",onClick:u[6]||(u[6]=d=>i.menuActionEmit("deleteSelected")),disable:i.selectedCount<1},{default:l(()=>[$("Delete "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[yi,_i]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",ki,[g("div",Ci,[t(K,{flat:"",size:"sm",icon:"join_full","no-caps":"",onClick:u[7]||(u[7]=d=>i.menuActionEmit("groupSelected")),disable:i.selectedCount<2},{default:l(()=>[$("Group "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[xi,wi]),_:1})]),_:1},8,["disable"])]),g("div",Si,[t(K,{flat:"",size:"sm",icon:"join_inner","no-caps":"",onClick:u[8]||(u[8]=d=>i.menuActionEmit("ungroupSelected")),disable:i.selectedCount<2},{default:l(()=>[$("Ungroup "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Ii,Ei]),_:1})]),_:1},8,["disable"])])]),g("div",Di,[g("div",Ti,[t(K,{flat:"",size:"sm",icon:"library_books","no-caps":"",onClick:u[9]||(u[9]=d=>i.menuActionEmit("addToLibrary")),disable:i.selectedCount<2},{default:l(()=>[$("Add to library "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$i,Pi]),_:1})]),_:1},8,["disable"])]),g("div",Mi,[t(K,{flat:"",size:"sm",icon:"file_copy","no-caps":"",onClick:u[10]||(u[10]=d=>i.menuActionEmit("duplicateSelected")),disable:i.selectedCount<1},{default:l(()=>[$("Duplicate "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Oi,zi]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",Li,[g("div",Ri,[t(K,{flat:"",size:"sm",icon:"splitscreen","no-caps":"",onClick:u[11]||(u[11]=d=>i.menuActionEmit("weldSelected")),disable:!(i.selectedCount>=2)},{default:l(()=>[$("Weld "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ji,Ai]),_:1})]),_:1},8,["disable"])])]),g("div",Wi,[g("div",Gi,[t(K,{flat:"",size:"sm",icon:"link","no-caps":"",onClick:u[12]||(u[12]=d=>i.menuActionEmit("link")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Link "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Fi]),_:1})]),_:1},8,["disable"])]),g("div",Vi,[t(K,{flat:"",size:"sm",icon:"transform","no-caps":"",disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Convert to "),t(Ct,{anchor:"top end",self:"top start","auto-close":""},{default:l(()=>[t(at,null,{default:l(()=>[(D(!0),fe(kt,null,Et(i.tools.filter(d=>d.name!==i.object.type&&!["Duct","Pointer","Text"].includes(d.name)),d=>de((D(),Y(se,{key:d.name,dense:"",clickable:"",onClick:p=>i.menuActionEmit("convertObjectType",d.name)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:d.icon,color:"grey-7","text-color":"white"},null,8,["icon"])]),_:2},1024),t(P,null,{default:l(()=>[$(Oe(d.name),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[ve]])),128))]),_:1})]),_:1}),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Bi]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",Yi,[g("div",Xi,[t(K,{flat:"",size:"sm",icon:"autorenew","no-caps":"",onClick:u[13]||(u[13]=d=>i.menuActionEmit("rotate90")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Rotate 90\xB0 "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Ui]),_:1})]),_:1},8,["disable"])]),g("div",Ni,[t(K,{flat:"",size:"sm",icon:"sync","no-caps":"",onClick:u[14]||(u[14]=d=>i.menuActionEmit("rotate-90")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Rotate -90\xB0 "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[qi]),_:1})]),_:1},8,["disable"])])]),g("div",Hi,[g("div",Qi,[t(K,{flat:"",size:"sm",icon:"flip","no-caps":"",onClick:u[15]||(u[15]=d=>i.menuActionEmit("flipH")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Flip horizontal "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Ki]),_:1})]),_:1},8,["disable"])]),g("div",Ji,[t(K,{flat:"",size:"sm",icon:"flip","no-caps":"",onClick:u[16]||(u[16]=d=>i.menuActionEmit("flipV")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Flip vertical "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[Zi]),_:1})]),_:1},8,["disable"])])]),g("div",es,[g("div",ts,[t(K,{flat:"",size:"sm",icon:"flip_to_front","no-caps":"",onClick:u[17]||(u[17]=d=>i.menuActionEmit("bringToFront")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Bring to front "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ns]),_:1})]),_:1},8,["disable"])]),g("div",as,[t(K,{flat:"",size:"sm",icon:"flip_to_back","no-caps":"",onClick:u[18]||(u[18]=d=>i.menuActionEmit("sendToBack")),disable:!i.selectedCount||i.selectedCount>1},{default:l(()=>[$("Send to back "),t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[ls]),_:1})]),_:1},8,["disable"])])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",os,[g("div",is,[t(Ft,{color:"blue","false-value":"Disable","true-value":"Enable",modelValue:i.showRulersGrid,"onUpdate:modelValue":[u[19]||(u[19]=d=>i.showRulersGrid=d),u[20]||(u[20]=d=>i.menuActionEmit("toggleRulersGrid",i.showRulersGrid))],size:"xs",style:{"margin-top":"-3px"}},{default:l(()=>[ss,t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$(" Show rulers and grid ("+Oe(i.showRulersGrid)+") ",1)]),_:1})]),_:1},8,["modelValue"])]),g("div",rs,[t(K,{onClick:u[21]||(u[21]=d=>i.menuActionEmit("zoomOut")),disable:i.zoom<=10,dense:"",flat:"",size:"sm",icon:"zoom_out"},{default:l(()=>[t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$(" Zoom out ")]),_:1})]),_:1},8,["disable"]),g("div",cs,[g("input",{class:"zoom-input",onKeydown:u[22]||(u[22]=ul(d=>i.menuActionEmit("zoomSet",d.target.value),["enter"])),value:i.zoom,type:"number"},null,40,us),$("% ")]),t(K,{onClick:u[23]||(u[23]=d=>i.menuActionEmit("zoomIn")),disable:i.zoom>=400,dense:"",flat:"",size:"sm",icon:"zoom_in"},{default:l(()=>[t(ge,{anchor:"top middle",self:"center right"},{default:l(()=>[$(" Zoom in ")]),_:1})]),_:1},8,["disable"])])])])]),_:1}),t(Tt,{name:"file",class:"file-panel"},{default:l(()=>[g("div",ds,[g("div",fs,[g("div",vs,[t(K,{flat:"",size:"sm",icon:"assignment","no-caps":"",label:"New Project",style:{"font-size":"11px"},onClick:u[24]||(u[24]=d=>i.menuActionEmit("newProject"))}),ps])]),t(_e,{color:"white",inset:"",vertical:""}),g("div",gs,[g("div",hs,[t(K,{flat:"",size:"sm",icon:"file_open","no-caps":"",label:"Import",style:{"font-size":"11px"},onClick:u[25]||(u[25]=d=>i.menuActionEmit("importJsonAction"))})])]),g("div",ms,[g("div",bs,[t(K,{flat:"",size:"sm",icon:"file_open","no-caps":"",label:"Export",style:{"font-size":"11px"},onClick:u[26]||(u[26]=d=>i.menuActionEmit("exportToJsonAction"))})])])])]),_:1}),t(Tt,{name:"device",class:"device-panel"},{default:l(()=>[g("div",ys,[t(at,{class:"col-8",style:{height:"50px"}},{default:l(()=>[t(se,null,{default:l(()=>[t(P,{top:"",class:"col-3"},{default:l(()=>[t(Me,{class:"q-mt-sm"},{default:l(()=>{var d,p;return[$("Current: "+Oe((p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.device),1)]}),_:1})]),_:1}),t(P,{top:"",class:"col-1"},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Graphic ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",_s,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.id),1)]}),_:1})]),_:1}),t(P,{top:"",class:"col-3"},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Full label ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",ks,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.fullLabel),1)]}),_:1})]),_:1}),t(P,{top:""},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Label ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",Cs,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.label),1)]}),_:1})]),_:1}),t(P,{top:""},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Element Count ")]),_:1}),t(Me,null,{default:l(()=>{var d,p,S;return[g("span",xs,Oe((S=(p=(d=i.currentDevice)==null?void 0:d.data)==null?void 0:p.graphicFull)==null?void 0:S.elementCount),1)]}),_:1})]),_:1}),t(P,{avatar:"",top:""},{default:l(()=>[t(Me,{caption:"",class:"select-title"},{default:l(()=>[$(" Action ")]),_:1}),t(b,{class:"text-primary",style:{"font-size":"12px","margin-top":"2px",cursor:"pointer"},onClick:i.showMoreDevices},{default:l(()=>[$("Show more devices "),t(ge,{anchor:"top middle",self:"center left"},{default:l(()=>[$(" Save the current selection ")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1})])])}var Ss=cn(Yo,[["render",ws],["__scopeId","data-v-72bff07c"]]);const Fe=i=>(Rn("data-v-2a079b54"),i=i(),jn(),i),Is={class:"full-area"},Es={class:"top-area"},Ds={class:"main-area"},Ts={key:0,class:"side-bar"},$s={class:"work-area"},Ps={class:"document-area"},Ms={key:0,class:"c-ruler"},Os={key:1,class:"h-ruler"},zs={key:2,class:"v-ruler"},Ls={key:3,class:"hv-grid"},Rs=Fe(()=>g("strong",null,"Go back",-1)),js={key:0},As={key:1},Ws={key:0},Gs={key:1},Fs=["id"],Vs=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Mode:",-1)),Bs=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Ys=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Xs=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Mode:",-1)),Us=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),Ns=Fe(()=>g("span",{style:{"margin-top":"8px"}},"Value:",-1)),qs=Fe(()=>g("div",{class:"text-h6"},"Link Entry",-1)),Hs={class:"flex"},Qs=Fe(()=>g("strong",null,"Reload panels data",-1)),Ks={class:"flex flex-col items-center mt-4"},Js={class:"text-xl text-center"},Zs=Fe(()=>g("div",{class:"text-h6"},"Insert Entry",-1)),er={class:"flex"},tr=Fe(()=>g("strong",null,"Reload panels data",-1)),nr={class:"flex flex-col items-center mt-4"},ar={class:"text-xl text-center"},lr=Fe(()=>g("div",{class:"text-h6"},"Import from a JSON file",-1)),or=Fe(()=>g("div",{class:"text-h6"},"Devices List",-1)),ir={__name:"IndexPage",setup(i){var ea;_a(e=>({"341be470":_(Gt).widthOffset,"445c2503":_(Gt).heightOffset})),Vl({title:"HVAC Drawer"});const h=new xa,o=Wn(),n=ae(null),c=ae([]),b=ae({...Ye[0],type:"default"}),v=ae(!1),d=ae([0,0]),p=ae(!0),S=ae(!1),R=["Duct","Wall","Int_Ext_Wall"],M=ae({addedCount:0,active:!1,uploadBtnLoading:!1,data:null}),z=ae(!1),q=dl(()=>Ve.value.loadingPanel===null?100:parseInt((Ve.value.loadingPanel+1/Ve.value.panelsList.length)*100)),U=ae(!1),J=ee.IdxPage.zoom;let N=null;const le=ae({x:0,y:0}),F=ae(null);An(()=>{ee.IdxPage.initQuasar(o),ee.IdxPage.initPage()});function X(e,a){ht.value.active=e,ht.value.data=a}function ue(){ee.DeviceOpt.clearDirtyCurrentDevice(),ht.value.active=!0,r.value.selectedTarget=[],r.value.selectedTargets=[],r.value.activeItemIndex=null,ee.DeviceOpt.refreshGraphicPanelElementCount(ht.value.data)}ka(()=>{}),fl(()=>{ee.IdxPage.clearAutoSaveInterval(),ee.WsClient.clearInitialDataInterval(),ee.IdxPage.clearIdx()});function oe(e){le.value.x=e.clientX-mt.left,le.value.y=e.clientY-mt.top;const a=1/r.value.viewportTransform.scale;if(v.value&&R.includes(b.value.name)&&r.value.activeItemIndex!==null){const s=e.ctrlKey,y=(e.clientX-mt.left-r.value.viewportTransform.x)*a,x=(e.clientY-mt.top-r.value.viewportTransform.y)*a,f=y-d.value[0],ne=x-d.value[1];let Q=Math.atan2(ne,f)*(180/Math.PI);s&&(Q=Math.round(Q/5)*5);const Se=Math.sqrt(f*f+ne*ne);r.value.items[r.value.activeItemIndex].rotate=Q,r.value.items[r.value.activeItemIndex].width=Se,re()}}function re(){if(!!F.value)for(const e of F.value)!e.refresh||e.refresh()}function ie(e){e!=="Move Object"&&setTimeout(()=>{wt(!1,!1),re()},200),ft.value=[],We.value.unshift({title:e,state:je.exports.cloneDeep(r.value)}),We.value.length>20&&We.value.pop()}function lt(e){n.value.clickTarget(e.inputEvent,e.inputTarget)}function Xe(e){ie("Move Object")}function Ue(e){r.value.items.find(a=>`moveable-item-${a.id}`===e.target.id),e.target.style.transform=e.transform}function Qe(e){if(!e.lastEvent)We.value.shift();else{const a=r.value.items.find(s=>`moveable-item-${s.id}`===e.target.id);a.translate=e.lastEvent.beforeTranslate,console.log("= IdxPage onDragEnd:",e,a.translate),wt(!1,!1),re()}}function Ke(e){ie("Move Group"),e.events.forEach((a,s)=>{const y=r.value.items.findIndex(x=>`moveable-item-${x.id}`===a.target.id);a.set(r.value.items[y].translate)})}function Je(e){e.events.forEach((a,s)=>{const y=r.value.items.findIndex(x=>`moveable-item-${x.id}`===a.target.id);r.value.items[y].translate=a.beforeTranslate})}function Ne(e){e.lastEvent?re():We.value.shift()}function Ze(e){const a=e.inputEvent.target;(dt.value.isMoveableElement(a)||r.value.selectedTargets.some(s=>s===a||s.contains(a)))&&e.stop()}function ot(e){var a;if(r.value.selectedTargets=e.selected,(e==null?void 0:e.selected)&&!((a=e==null?void 0:e.inputEvent)!=null&&a.ctrlKey)){const s=r.value.items.filter(x=>e.selected.some(f=>f.id===`moveable-item-${x.id}`));[...new Set(s.filter(x=>x.group).map(x=>x.group))].forEach(x=>{Pe(x)})}r.value.selectedTargets.length===1?r.value.activeItemIndex=r.value.items.findIndex(s=>`moveable-item-${s.id}`===r.value.selectedTargets[0].id):r.value.activeItemIndex=null,e.isDragStart&&(e.inputEvent.preventDefault(),setTimeout(()=>{dt.value.dragStart(e.inputEvent)})),r.value.selectedTargets.length>1&&!B.value?setTimeout(()=>{z.value=!0},100):z.value=!1,nt.refreshMoveableGuides(),setTimeout(()=>{jt.Hvac.PageMain.SetWallDimensionsVisible("select",v.value,r,null)},100)}function Pe(e){const a=[];r.value.items.filter(s=>s.group===e&&!r.value.selectedTargets.some(y=>y.id===`moveable-item-${s.id}`)).forEach(s=>{const y=document.querySelector(`#moveable-item-${s.id}`);a.push(y)}),r.value.selectedTargets=r.value.selectedTargets.concat(a),n.value.setSelectedTargets(r.value.selectedTargets)}function Re(e){ie("Resize object");const a=r.value.items.findIndex(s=>`moveable-item-${s.id}`===e.target.id);e.setOrigin(["%","%"]),e.dragStart&&e.dragStart.set(r.value.items[a].translate)}function C(e){const a=r.value.items.find(s=>`moveable-item-${s.id}`===e.target.id);e.target.style.width=`${e.width}px`,e.target.style.height=`${e.height}px`,e.target.style.transform=`translate(${e.drag.beforeTranslate[0]}px, ${e.drag.beforeTranslate[1]}px) rotate(${a.rotate}deg) scaleX(${a.scaleX}) scaleY(${a.scaleY})`}function k(e){if(e.lastEvent===null||e.lastEvent===void 0)return;const a=r.value.items.findIndex(s=>{var y,x;return`moveable-item-${s.id}`===((x=(y=e==null?void 0:e.lastEvent)==null?void 0:y.target)==null?void 0:x.id)});r.value.items[a].width=e.lastEvent.width,r.value.items[a].height=e.lastEvent.height,r.value.items[a].translate=e.lastEvent.drag.beforeTranslate,jt.Hvac.PageMain.UpdateExteriorWallStroke(r,a,e.lastEvent.height),re()}function m(e){ie("Rotate object")}function E(e){const a=r.value.items.find(s=>`moveable-item-${s.id}`===e.target.id);a.rotate=e.rotate}function T(e){re()}function I(e){re()}function w(e){S.value=!0}function j(e){e.events.forEach((a,s)=>{a.target.style.width=`${a.width}px`,a.target.style.height=`${a.height}px`,a.target.style.transform=a.drag.transform})}function W(e){e.events.forEach(a=>{const s=r.value.items.findIndex(y=>`moveable-item-${y.id}`===a.lastEvent.target.id);r.value.items[s].width=a.lastEvent.width,r.value.items[s].height=a.lastEvent.height,r.value.items[s].translate=a.lastEvent.drag.beforeTranslate}),re(),S.value=!1}function L(e){ie("Rotate Group"),e.events.forEach(a=>{const s=r.value.items.findIndex(y=>`moveable-item-${y.id}`===a.target.id);a.set(r.value.items[s].rotate),a.dragStart&&a.dragStart.set(r.value.items[s].translate)})}function G(e){e.events.forEach((a,s)=>{const y=r.value.items.findIndex(x=>`moveable-item-${x.id}`===a.target.id);r.value.items[y].translate=a.drag.beforeTranslate,r.value.items[y].rotate=a.rotate})}function te(e,a=void 0,s=!0){var x;s&&ie(`Add ${(x=e==null?void 0:e.type)!=null?x:""}`),r.value.itemsCount++,e.id=r.value.itemsCount,e.group=a,e.settings.titleColor||(e.settings.titleColor="inherit"),e.settings.bgColor||(e.settings.bgColor="inherit"),e.settings.textColor||(e.settings.textColor="inherit"),e.settings.fontSize||(e.settings.fontSize=16),r.value.items.push(e);const y=document.querySelectorAll(".moveable-item");return r.value.elementGuidelines=[],Array.from(y).forEach(function(f){r.value.elementGuidelines.push(f)}),e}function A(e,a,s){const y=[],x=[];r.value.groupCount++,e.forEach(f=>{x.push(Z(f,r.value.groupCount))}),setTimeout(()=>{x.forEach(ne=>{const Q=document.querySelector(`#moveable-item-${ne.id}`);y.push(Q)}),r.value.selectedTargets=y,n.value.setSelectedTargets(y),r.value.activeItemIndex=null;const f=1/r.value.viewportTransform.scale;setTimeout(()=>{dt.value.request("draggable",{x:(s.clientX-mt.left-r.value.viewportTransform.x)*f-a.width*f,y:(s.clientY-mt.top-r.value.viewportTransform.y)*f-a.height*f},!0),setTimeout(()=>{ee.IdxPage.refreshMoveable()},1)},10)},10)}function we(e){var x;const a={width:e.rect.width,height:e.rect.height},s={clientX:e.clientX,clientY:e.clientY,top:e.rect.top,left:e.rect.left};if((b.value.name==="Pointer"||a.width<20||a.height<20)&&!R.includes(b.value.name)){v.value=!1;return}R.includes(b.value.name)&&a.height<20&&(a.height=b.value.height);const y=Ge(a,s);y&&R.includes((x=y==null?void 0:y.type)!=null?x:"")&&setTimeout(()=>{v.value=!0,r.value.selectedTargets=[],r.value.items[r.value.activeItemIndex].rotate=0,d.value=je.exports.cloneDeep(y.translate)},100)}function Ge(e,a,s){var Se;if(s=s||b.value,s.type==="libItem"){A(s.items,e,a);return}const y=1/r.value.viewportTransform.scale,x=je.exports.cloneDeep((Se=Ye.find(Ee=>Ee.name===s.name))==null?void 0:Se.settings)||{},f=Object.keys(x).reduce((Ee,Le)=>(Ee[Le]=x[Le].value,Ee),{});s.name==="G_Rectangle"&&(e.width=100);const ne={title:null,active:!1,type:s.name,translate:[(a.left-mt.left-r.value.viewportTransform.x)*y,(a.top-mt.top-r.value.viewportTransform.y)*y],width:e.width*y,height:e.height*y,rotate:0,scaleX:1,scaleY:1,settings:f,zindex:1,t3Entry:null,showDimensions:!0};if(s.type==="Image"&&(ne.image=s,ne.type=s.id),s.cat){const[Ee]=s.cat;ne.cat=Ee}const Q=te(ne);return["Value","Icon","Switch"].includes(s.name)&&(Te.value.active=!0),setTimeout(()=>{B.value||(r.value.activeItemIndex=r.value.items.findIndex(Ee=>Ee.id===Q.id))},10),setTimeout(()=>{if(B.value)return;const Ee=document.querySelector(`#moveable-item-${Q.id}`);r.value.selectedTargets=[Ee],n.value.setSelectedTargets([Ee])},100),Q}function O(e,a="default"){b.value=e,typeof e=="string"&&(b.value=Ye.find(s=>s.name===e)),b.value.type=a}function H(e,a=!1){!e||(ie("Rotate object"),a?e.rotate=e.rotate-90:e.rotate=e.rotate+90,ee.IdxPage.refreshMoveable())}function me(e){ie("Flip object H"),e.scaleX===1?e.scaleX=-1:e.scaleX=1,ee.IdxPage.refreshMoveable()}function Ae(e){ie("Flip object V"),e.scaleY===1?e.scaleY=-1:e.scaleY=1,ee.IdxPage.refreshMoveable()}function ze(e){ie("Bring object to front"),e.zindex=e.zindex+1}function it(e){ie("Send object to back"),e.zindex=e.zindex-1}function Ce(e){ie("Remove object");const a=r.value.items.findIndex(s=>s.id===e.id);r.value.activeItemIndex=null,r.value.items.splice(a,1),r.value.selectedTargets=[]}function he(e){ie(`Duplicate ${e.type}`),r.value.activeItemIndex=null;const a=Z(e);r.value.selectedTargets=[],setTimeout(()=>{xt(a)},10)}function Z(e,a=void 0){const s=je.exports.cloneDeep(e);return s.translate[0]=s.translate[0]+5,s.translate[1]=s.translate[1]+5,te(s,a,!1)}function xt(e){const a=document.querySelector(`#moveable-item-${e.id}`);r.value.selectedTargets=[a],r.value.activeItemIndex=r.value.items.findIndex(s=>s.id===e.id)}function Ut(e){}function st(e,a){ee.IdxPage.T3UpdateEntryField(e,a)}function Nt(e){wt(!1,!0)}function un(e){return!e.inputEvent.altKey}function dn(){if(ie("Link object to T3000 entry"),r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField||(r.value.items[r.value.activeItemIndex].label===void 0?r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="description":r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="label"),Te.value.data.value!==void 0&&Te.value.data.value!==null&&Te.value.data.value>=1e3&&(Te.value.data.value=Te.value.data.value/1e3),r.value.items[r.value.activeItemIndex].t3Entry=je.exports.cloneDeep(Rt(Te.value.data)),r.value.items[r.value.activeItemIndex].type==="Icon"){let a="fa-solid fa-camera-retro";Te.value.data.type==="GRP"?a="fa-solid fa-camera-retro":Te.value.data.type==="SCHEDULE"?a="schedule":Te.value.data.type==="PROGRAM"?a="fa-solid fa-laptop-code":Te.value.data.type==="HOLIDAY"&&(a="calendar_month"),r.value.items[r.value.activeItemIndex].settings.icon=a}nt.refreshObjectStatus(r.value.items[r.value.activeItemIndex]),Te.value.data=null,Te.value.active=!1}function qt(e,a){if(e===""){a(()=>{sn.value=Ve.value.panelsData});return}a(()=>{const s=e.toUpperCase();sn.value=Ve.value.panelsData.filter(y=>{var x,f;return y.command.toUpperCase().indexOf(s)>-1||((x=y.description)==null?void 0:x.toUpperCase().indexOf(s))>-1||((f=y.label)==null?void 0:f.toUpperCase().indexOf(s))>-1})})}const Ht=ae(0);function fn(e){ie("Insert object to T3000 entry");const a=Ht.value*80,s={width:60,height:60},y={clientX:300,clientY:100,top:100,left:200+a},x=Ye.find(Q=>Q.name==="Pump"),f=Ge(s,y,x),ne=r.value.items.findIndex(Q=>Q.id===f.id);r.value.activeItemIndex=ne,Oa(),Ht.value++}function Oa(){if(ie("Link object to T3000 entry"),r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField||(r.value.items[r.value.activeItemIndex].label===void 0?r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="description":r.value.items[r.value.activeItemIndex].settings.t3EntryDisplayField="label"),r.value.items[r.value.activeItemIndex].t3Entry=je.exports.cloneDeep(Rt(He.value.data)),r.value.items[r.value.activeItemIndex].type==="Icon"){let e="fa-solid fa-camera-retro";He.value.data.type==="GRP"?e="fa-solid fa-camera-retro":He.value.data.type==="SCHEDULE"?e="schedule":He.value.data.type==="PROGRAM"?e="fa-solid fa-laptop-code":He.value.data.type==="HOLIDAY"&&(e="calendar_month"),r.value.items[r.value.activeItemIndex].settings.icon=e}nt.refreshObjectStatus(r.value.items[r.value.activeItemIndex]),He.value.data=null,He.value.active=!1}function za(){}function wt(e=!1,a=!1){ee.IdxPage.save(e,a)}function La(){ee.IdxPage.refreshMoveable()}function Vn(){var e;if(((e=r.value.items)==null?void 0:e.length)>0){o.dialog({dark:!0,title:"Do you want to clear the drawing and start over?",message:"This will also erase your undo history",cancel:!0,persistent:!0}).onOk(()=>{ee.IdxPage.newProject()}).onCancel(()=>{});return}ee.IdxPage.newProject()}h.keyup(e=>{e.key==="ctrl"&&(p.value=!0)}),h.keydown(e=>{e.key==="esc"&&(O(Ye[0]),Wt.value.length>1&&wn(),v.value&&(v.value=!1,Qt())),e.key==="ctrl"&&(p.value=!1),!(r.value.selectedTargets.length<1)&&(["up","down","left","right"].includes(e.key)&&ie("Move object"),e.key==="up"?dt.value.request("draggable",{deltaX:0,deltaY:-5},!0):e.key==="down"?dt.value.request("draggable",{deltaX:0,deltaY:5},!0):e.key==="left"?dt.value.request("draggable",{deltaX:-5,deltaY:0},!0):e.key==="right"?dt.value.request("draggable",{deltaX:5,deltaY:0},!0):e.key==="delete"&&pn(),["up","down","left","right"].includes(e.key)&&ee.IdxPage.refreshMoveable())}),h.keydown(["ctrl","s"],e=>{e.inputEvent.preventDefault(),wt(!0,!0)}),h.keydown(["ctrl","z"],e=>{e.inputEvent.preventDefault(),!B.value&&Qt()}),h.keydown(["ctrl","y"],e=>{e.inputEvent.preventDefault(),!B.value&&Xn()}),h.keydown(["ctrl","r"],e=>{e.inputEvent.preventDefault(),Vn()}),h.keydown(["ctrl","d"],e=>{e.inputEvent.preventDefault(),hn()}),h.keydown(["ctrl","g"],e=>{e.inputEvent.preventDefault(),mn()}),h.keydown(["ctrl","shift","g"],e=>{e.inputEvent.preventDefault(),bn()}),h.keydown(["ctrl","c"],e=>{!document.activeElement.matches(".viewport")||(e.inputEvent.preventDefault(),Zt())}),h.keydown(["ctrl","v"],e=>{!document.activeElement.matches(".viewport")||(e.inputEvent.preventDefault(),Kn())}),h.keydown(["ctrl","b"],e=>{e.inputEvent.preventDefault(),gn()}),h.keydown(["insert"],e=>{jt.Hvac.KiOpt.InsertT3EntryDialog()});function vn(){var e,a;Te.value.active=!0,(e=r.value.items[r.value.activeItemIndex])!=null&&e.t3Entry&&(Te.value.data=je.exports.cloneDeep((a=r.value.items[r.value.activeItemIndex])==null?void 0:a.t3Entry))}function pn(){ie("Remove selected objects"),r.value.selectedTargets.length>0&&(r.value.selectedTargets.forEach(e=>{const a=r.value.items.findIndex(s=>`moveable-item-${s.id}`===e.id);a!==-1&&r.value.items.splice(a,1)}),r.value.selectedTargets=[],r.value.activeItemIndex=null)}function Ra(e){const a=1/r.value.viewportTransform.scale,s=e[0].translate[0];e[0].translate[1];const y=Math.min(...e.map(ye=>ye.translate[0])),x=Math.min(...e.map(ye=>ye.translate[1])),f=Math.max(...e.map(ye=>ye.translate[0]+ye.width)),ne=Math.max(...e.map(ye=>ye.translate[1]+ye.height)),Q=s<y?s:y,Se=e.map(ye=>{var qe;return(qe=ye==null?void 0:ye.type)!=null?qe:""}).join("-");let Ee=e[0].zindex;e.forEach(ye=>{ye.zindex=Ee-1,Ee=ye.zindex});const Le={title:`Weld-${Se}`,active:!1,type:"Weld",translate:[Q,x],width:(f-y)*a,height:(ne-x)*a,rotate:0,scaleX:1,scaleY:1,settings:{active:!1,fillColor:"#659dc5",fontSize:16,inAlarm:!1,textColor:"inherit",titleColor:"inherit",weldItems:je.exports.cloneDeep(e)},zindex:1,t3Entry:null,id:r.value.itemsCount+1};te(Le)}function ja(e){const a=1/r.value.viewportTransform.scale,s=e[0].translate[0];e[0].translate[1];const y=Math.min(...e.map(ce=>ce.translate[0]));let x=Math.min(...e.map(ce=>ce.translate[1]));const f=Math.max(...e.map(ce=>ce.translate[0]+ce.width)),ne=Math.max(...e.map(ce=>ce.translate[1]+ce.height));let Q=s<y?s:y;const Se=e.reduce((ce,be)=>{const ct=be.rotate*Math.PI/180,ut=Math.cos(ct),V=Math.sin(ct);return[{x:be.translate[0],y:be.translate[1]},{x:be.translate[0]+be.width*ut,y:be.translate[1]+be.width*V},{x:be.translate[0]-be.height*V,y:be.translate[1]+be.height*ut},{x:be.translate[0]+be.width*ut-be.height*V,y:be.translate[1]+be.width*V+be.height*ut}].forEach(nn=>{ce.minX=Math.min(ce.minX,nn.x),ce.minY=Math.min(ce.minY,nn.y),ce.maxX=Math.max(ce.maxX,nn.x),ce.maxY=Math.max(ce.maxY,nn.y)}),ce},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});Se.minX,Se.minY,Se.maxX-Se.minX,Se.maxY-Se.minY;const Ee=e.map(ce=>{var be;return(be=ce==null?void 0:ce.type)!=null?be:""}).join("-");let Le=e[0].zindex;e.forEach(ce=>{ce.zindex=Le-1,Le=ce.zindex});const ye=e.every(ce=>{var be;return((be=ce==null?void 0:ce.type)!=null?be:"")==="Duct"});if(ye){const ce=Aa(e);e.forEach(be=>{const ct=ce.find(ut=>ut.id===be.id);ct&&(be.overlap={isStartOverlap:ct.isStartOverlap,isEndOverlap:ct.isEndOverlap})})}const qe=(f-y)*a+8,It=(ne-x)*a+8,en={title:`Weld-${Ee}`,active:!1,cat:"General",type:ye?"Weld_Duct":"Weld_General",translate:[Q,x],width:qe,height:It,rotate:0,scaleX:1,scaleY:1,settings:{active:!1,fillColor:"#659dc5",fontSize:16,inAlarm:!1,textColor:"inherit",titleColor:"inherit"},weldItems:je.exports.cloneDeep(e),zindex:1,t3Entry:null,id:r.value.itemsCount+1};te(en)}function Bn(e){const{left:a,top:s,pos1:y,pos2:x,pos3:f,pos4:ne}=e;return[y,x,ne,f].map(Q=>[a+Q[0],s+Q[1]])}function Yn(e){const a=e.closest(".moveable-item.Duct"),s=Dn(e),y=document.querySelectorAll(".moveable-item.Duct");for(const x of Array.from(y)){if(a.isSameNode(x))continue;const f=Dn(x),ne=Bn(s),Q=Bn(f);if(Fl(ne,Q)>0)return!0}return!1}function Aa(e){const a=[];return e.map(s=>{const y=document.querySelector(`#moveable-item-${s.id} .duct-start`),x=document.querySelector(`#moveable-item-${s.id} .duct-end`),f=Yn(y),ne=Yn(x);a.push({id:s.id,isStartOverlap:f,isEndOverlap:ne})}),a}function gn(){if(r.value.selectedTargets.length<2)return;if(r.value.items.filter(x=>r.value.selectedTargets.some(f=>f.id===`moveable-item-${x.id}`)).some(x=>{var f;return((f=x==null?void 0:x.type)!=null?f:"")==="Weld"})){o.notify({type:"warning",message:"Currently not supported!"});return}ie("Weld selected objects");const a=r.value.items.filter(x=>r.value.selectedTargets.some(f=>f.id===`moveable-item-${x.id}`)),s=a.every(x=>x.cat==="General"),y=a.every(x=>{var f;return((f=x==null?void 0:x.type)!=null?f:"")==="Duct"});s||y?ja(a):Ra(a),a.forEach(x=>{const f=r.value.items.findIndex(ne=>ne.id===x.id);f!==-1&&r.value.items.splice(f,1)}),ee.IdxPage.refreshMoveable()}function Qt(){We.value.length<1||(ft.value.unshift({title:N,state:je.exports.cloneDeep(r.value)}),r.value=je.exports.cloneDeep(We.value[0].state),We.value.shift(),ee.IdxPage.refreshMoveable())}function Xn(){ft.value.length<1||(We.value.unshift({title:N,state:je.exports.cloneDeep(r.value)}),r.value=je.exports.cloneDeep(ft.value[0].state),ft.value.shift(),ee.IdxPage.refreshMoveable())}function Wa(e){}function Ga(e){return new Promise((a,s)=>{var y=new FileReader;y.onload=()=>{a(y.result)},y.onerror=s,y.readAsDataURL(e)})}async function Fa(e){if(_t.value){console.log("= Idx saveLibImage file",e),console.log("= Idx saveLibImage user",_t.value),At.post("hvacTools",{json:{name:e.name,fileId:e.id}}).then(async s=>{o.notify({color:"positive",message:"Image successfully saved"});const y=await s.json();il(y)}).catch(s=>{o.notify({color:"negative",message:s.message})});return}Ie.value.imagesCount++;const a={action:9,filename:e.name,fileLength:e.size,fileData:await Ga(e.data)};Be.value?ee.WebClient.SaveImage(a):ee.WsClient.SaveImage(a)}const St=ae({active:!1,data:{settings:(ea=Ye.find(e=>e.name==="Gauge"))==null?void 0:ea.settings}});function Va(e){St.value.active=!0,St.value.data=e}function Ba(e){const a=r.value.items.findIndex(s=>s.id===e.id);r.value.items[a]=e,St.value.active=!1,St.value.data={}}function Ya(){M.value.active=!0}function Xa(){const e=je.exports.cloneDeep(Rt(r.value));e.selectedTargets=[],e.elementGuidelines=[];const a=document.createElement("a"),s=new Blob([JSON.stringify(e)],{type:"application/json"});a.href=URL.createObjectURL(s),a.download="HVAC_Drawer_Project.json",a.click()}async function Ua(e){const a=await e.data.text();M.value.data=a,Na()}function Na(){var a,s;const e=JSON.parse(M.value.data);if(!((a=e.items)!=null&&a[0].type)){o.notify({message:"Error, Invalid json file",color:"negative",icon:"error",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]});return}if(((s=r.value.items)==null?void 0:s.length)>0){o.dialog({dark:!0,title:"You have unsaved drawing!",message:`Before proceeding with the import, please note that any unsaved drawing will be lost,
           and your undo history will also be erased. Are you sure you want to proceed?`,cancel:!0,persistent:!0}).onOk(()=>{We.value=[],ft.value=[],M.value.active=!1,r.value=e,M.value.data=null,setTimeout(()=>{nt.refreshMoveableGuides()},100),ee.IdxPage.refreshMoveable()}).onCancel(()=>{M.value.active=!1});return}We.value=[],ft.value=[],M.value.active=!1,r.value=e,M.value.data=null,setTimeout(()=>{nt.refreshMoveableGuides()},100),ee.IdxPage.refreshMoveable()}function hn(){if(r.value.selectedTargets.length<1)return;ie("Duplicate the selected objects");const e=[],a={};r.value.selectedTargets.forEach(s=>{const y=r.value.items.find(x=>`moveable-item-${x.id}`===s.id);if(y){let x;y.group&&(a[`${y.group}`]||(r.value.groupCount++,a[`${y.group}`]=r.value.groupCount),x=a[`${y.group}`]);const f=Z(y,x);setTimeout(()=>{const ne=document.querySelector(`#moveable-item-${f.id}`);e.push(ne)},10)}}),setTimeout(()=>{r.value.selectedTargets=e,n.value.setSelectedTargets(e),r.value.activeItemIndex=null},20)}function mn(){r.value.selectedTargets.length<2||(ie("Group the selected objects"),r.value.selectedTargets.length>0&&(r.value.groupCount++,r.value.selectedTargets.forEach(e=>{const a=r.value.items.find(s=>`moveable-item-${s.id}`===e.id);a&&(a.group=r.value.groupCount)})))}function bn(){r.value.selectedTargets.length<2||(ie("Ungroup the selected objects"),r.value.selectedTargets.length>0&&r.value.selectedTargets.forEach(e=>{const a=r.value.items.find(s=>`moveable-item-${s.id}`===e.id);a&&(a.group=void 0)}))}function Un(e,a){const s=r.value.items[r.value.activeItemIndex];switch(e){case"newProject":Vn();break;case"importJsonAction":Ya();break;case"exportToJsonAction":Xa();break;case"save":wt(!0,!0);break;case"undoAction":Qt();break;case"redoAction":Xn();break;case"duplicateSelected":hn();break;case"groupSelected":mn();break;case"ungroupSelected":bn();break;case"addToLibrary":Hn();break;case"deleteSelected":pn();break;case"weldSelected":gn();break;case"duplicateObject":he(s);break;case"rotate90":H(s);break;case"rotate-90":H(s,!0);break;case"flipH":me(s);break;case"flipV":Ae(s);break;case"bringToFront":ze(s);break;case"sendToBack":it(s);break;case"removeObject":Ce(s);break;case"zoomOut":ee.IdxPage.zoomAction("out");break;case"zoomIn":ee.IdxPage.zoomAction();break;case"zoomSet":ee.IdxPage.zoomAction("set",a);break;case"copy":Zt();break;case"paste":Kn();break;case"link":vn();break;case"convertObjectType":Jn(s,a);break;case"toggleRulersGrid":tl(a);break}}function Nn(){Ve.value.loadingPanel=null,Be.value?ee.WebClient.GetPanelsList():ee.WsClient.GetPanelsList()}function Kt(e){let a=e.description&&e.id!==e.description||!e.description&&e.id!==e.label?e.id+" - ":"";return a=!e.description&&!e.label?e.id:a,a+(e.description||e.label||"")}function yn(){r.value.activeItemIndex=null,r.value.selectedTargets=[],B.value=!B.value,B.value&&O("Pointer"),Wl.restDocumentAreaPosition()}function _n(e){var a,s,y,x,f;if(!!B.value){if(((a=e.t3Entry)==null?void 0:a.type)==="GRP"){const ne={action:7,panelId:e.t3Entry.pid,entryIndex:e.t3Entry.index};va.SaveGrpSwitch(ne),Be.value?ee.WebClient.LoadGraphicEntry(ne):ee.WsClient.LoadGraphicEntry(ne)}else if(["SCHEDULE","PROGRAM","HOLIDAY"].includes((s=e.t3Entry)==null?void 0:s.type)){const ne={action:8,panelId:e.t3Entry.pid,entryType:Xl[e.t3Entry.type],entryIndex:e.t3Entry.index};Be.value?ee.WebClient.OpenEntryEditWindow(ne):ee.WsClient.OpenEntryEditWindow(ne)}else((y=e.t3Entry)==null?void 0:y.auto_manual)===1&&((x=e.t3Entry)==null?void 0:x.digital_analog)===0&&((f=e.t3Entry)==null?void 0:f.range)&&(e.t3Entry.control=e.t3Entry.control===1?0:1,st("control",e));qa()}}function kn(e,a,s){const y=s?"control":"value",x=r.value.items.find(f=>f.id===e.id);x.t3Entry[y]=a,st(y,x)}function Cn(e){!B.value||(e.t3Entry.auto_manual=e.t3Entry.auto_manual?0:1,st("auto_manual",e))}const Jt=ae(!1),xn=ae(!1),et=ae("Auto"),rt=ae("Off"),pt=ae(!1),$t=ae(!1),gt=ae(!1),Pt=ae(!1),Mt=ae(0);function qn(e,a){e.t3Entry!==null?(xn.value=!0,e.t3Entry.auto_manual===1?(et.value="Manual",pt.value=!1,gt.value=!1):(et.value="Auto",pt.value=!0,gt.value=!0),e.t3Entry.digital_analog===0?$t.value=!0:$t.value=!1,e.t3Entry.control===1?rt.value="On":rt.value="Off",e.t3Entry.digital_analog===1&&e.t3Entry.range!==101?(Pt.value=!0,Mt.value=e.t3Entry.value*1):Pt.value=!1):xn.value=!1}function Ot(e,a,s){a==="mode"&&(et.value==="Auto"?(pt.value=!0,gt.value=!0):(pt.value=!1,gt.value=!1),e.t3Entry.auto_manual=et.value==="Auto"?0:1,st("auto_manual",e)),a=="value"&&(e.t3Entry.control=rt.value==="Off"?0:1,st("control",e)),a==="number-value"&&(e.t3Entry.value=Mt.value*1,st("value",e)),wt(!1,!0)}function qa(){if(r.value.selectedTargets.length>1)Jt.value=!1,$t.value=!1,Pt.value=!1;else if(r.value.selectedTargets.length===1){const e=r.value.items.find(a=>`moveable-item-${a.id}`===r.value.selectedTargets[0].id);e.t3Entry!==null?(Jt.value=!0,qn(e)):(Jt.value=!1,$t.value=!1,Pt.value=!1)}}function wn(){if(Wt.value.length>1){const e=Wt.value[Wt.value.length-2],a={action:7,panelId:e.pid,entryIndex:e.index};va.RemoveLatestGrpSwitch(),Be.value?ee.WebClient.LoadGraphicEntry(a):ee.WsClient.LoadGraphicEntry(a)}else if(Be.value)ee.WebClient.GetInitialData();else{const e=ee.DeviceOpt.getCurrentDevice(),a=e.panelId,s=e.graphic;ee.WsClient.GetInitialData(a,s,!0)}}function Ha(){We.value.shift()}async function Hn(){if(r.value.selectedTargets.length<1||B.value)return;const e=r.value.items.filter(x=>r.value.selectedTargets.some(f=>f.id===`moveable-item-${x.id}`));let a=!1;const s=je.exports.cloneDeep(e);Ie.value.objLibItemsCount++;let y=null;_t.value&&(a=!0,At.post("hvacObjectLibs",{json:{label:"Item "+Ie.value.objLibItemsCount,items:s.map(x=>(delete x.id,x))}}).then(async x=>{y=await x.json(),o.notify({type:"positive",message:"Successfully saved to library"}),Ie.value.objLib.push({id:(y==null?void 0:y.id)||Ie.value.objLibItemsCount,label:"Item "+Ie.value.objLibItemsCount,items:y.items,online:a}),nt.saveLib()}).catch(x=>{o.notify({type:"negative",message:x.message})})),Ie.value.objLib.push({id:(y==null?void 0:y.id)||Ie.value.objLibItemsCount,label:"Item "+Ie.value.objLibItemsCount,items:s,online:a}),nt.saveLib()}function Qa(){ie("Bring selected objects to front"),r.value.items.filter(a=>r.value.selectedTargets.some(s=>s.id===`moveable-item-${a.id}`)).forEach(a=>{a.zindex=a.zindex+1})}function Ka(){ie("Send selected objects to back"),r.value.items.filter(a=>r.value.selectedTargets.some(s=>s.id===`moveable-item-${a.id}`)).forEach(a=>{a.zindex=a.zindex-1})}function Qn(e=!1){dt.value.request("rotatable",{deltaRotate:e?-90:90},!0),ee.IdxPage.refreshMoveable()}function Zt(){if(B.value||r.value.selectedTargets.length===0)return;const e=r.value.items.filter(a=>r.value.selectedTargets.some(s=>s.id===`moveable-item-${a.id}`));localStorage.setItem("clipboard",JSON.stringify(e)),U.value=!0}function Kn(){if(B.value)return;let e=[];const a=localStorage.getItem("clipboard");if(a&&(e=JSON.parse(a)),!e)return;ie("Paste");const s=[],y=[];e.forEach(x=>{y.push(Z(x))}),setTimeout(()=>{y.forEach(x=>{const f=document.querySelector(`#moveable-item-${x.id}`);s.push(f)}),r.value.selectedTargets=s,n.value.setSelectedTargets(s),r.value.activeItemIndex=null},10)}function Ja(e){_t.value&&e.online&&At.delete("hvacObjectLibs/"+e.id).then(async()=>{o.notify({type:"positive",message:"Successfully deleted"})}).catch(s=>{o.notify({type:"negative",message:s.message})});const a=Ie.value.objLib.findIndex(s=>s.name===e.name);a!==-1&&Ie.value.objLib.splice(a,1),nt.saveLib()}function Za(e,a){_t.value&&e.online&&At.patch("hvacObjectLibs/"+e.id,{json:{label:a}}).then(async()=>{o.notify({type:"positive",message:"Successfully updated"})}).catch(y=>{o.notify({type:"negative",message:y.message})});const s=Ie.value.objLib.findIndex(y=>y.name===e.name);s!==-1&&(Ie.value.objLib[s].label=a),nt.saveLib()}function el(e){e.online&&At.delete("hvacTools/"+e.dbId||e.id.slice(4)).then(async()=>{o.notify({type:"positive",message:"Successfully deleted"})}).catch(s=>{o.notify({type:"negative",message:s.message})});const a=Ie.value.images.findIndex(s=>s.name===e.name);if(a!==-1&&(Ie.value.images.splice(a,1),!e.online)){if(Ie.value.images.length<=0)return;const s=je.exports.cloneDeep(Ie.value.images[a].path);Be.value?ee.WebClient.DeleteImage(Rt(s)):ee.WsClient.DeleteImage(Rt(s)),nt.saveLib()}}function Jn(e,a){var ne;if(e||(e=r.value.items[r.value.activeItemIndex]),!e)return;ie("Convert object to "+a);const s=je.exports.cloneDeep((ne=Ye.find(Q=>Q.name===a))==null?void 0:ne.settings)||{},y=Object.keys(s).reduce((Q,Se)=>(Q[Se]=s[Se].value,Q),{}),x={};for(const Q in y)Object.hasOwnProperty.call(y,Q)&&(e.settings[Q]!==void 0?x[Q]=e.settings[Q]:x[Q]=y[Q]);const f=["bgColor","textColor","title","t3EntryDisplayField"];for(const Q of f)x[Q]===void 0&&(x[Q]=e.settings[Q]);e.type=a,e.settings=x}function tl(e){bt.value=e==="Enable",r.value.rulersGridVisible=bt.value,wt(!1,!1)}function nl(e,a){const s=a.name==="Int_Ext_Wall"?{width:200,height:10}:{width:60,height:60};Ge(s,{clientX:e.clientX,clientY:e.clientY,top:e.clientY,left:e.clientX},a)}const al=(e,a)=>{r.value.items.map(s=>{var y;((y=s==null?void 0:s.type)!=null?y:"")==="Weld"&&s.id===e.id&&(s.settings.weldItems=a)})},Zn=(e,a)=>{r.value.items.map(s=>{var y,x,f,ne,Q;if((((y=s==null?void 0:s.type)!=null?y:"")==="Weld_General"||((x=s==null?void 0:s.type)!=null?x:"")==="Weld_Duct")&&s.id===e.id){const Se=(f=s==null?void 0:s.weldItems[0])==null?void 0:f.translate[0],Ee=(ne=s==null?void 0:s.weldItems[0])==null?void 0:ne.translate[1];(Q=s==null?void 0:s.weldItems)==null||Q.forEach(Le=>{const ye=a==null?void 0:a.find(qe=>{var It;return((It=qe==null?void 0:qe.item)==null?void 0:It.id)===(Le==null?void 0:Le.id)});ye&&(Le.width=ye.newPos.width,Le.height=ye.newPos.height,Le.translate[0]=Se+ye.newPos.trsx,Le.translate[1]=Ee+ye.newPos.trsy)})}})};function ll(e){if(e.preventDefault(),!B.value&&b.value.name!=="Pointer"&&b.value.name!="Wall"&&!v.value&&b.value.name!="Int_Ext_Wall"&&b.value.name!="Duct"){var s={rect:{width:60,height:60,top:e.clientY,left:e.clientX},clientX:e.clientX,clientY:e.clientY};we(s),O(Ye[0])}}function ol(e){e.preventDefault(),O(Ye[0]),v.value&&(v.value=!1,Qt(),setTimeout(()=>{re()},10),jt.Hvac.PageMain.ClearItemsWithZeroWidth(r),jt.Hvac.PageMain.SetWallDimensionsVisible("all",v.value,r,!1))}function il(e){const a=Ie.value.images.findIndex(s=>s.id==="IMG-"+e.id);a!==-1&&Ie.value.images.splice(a,1),Ie.value.images.push({id:"IMG-"+e.id,dbId:e.id,name:e.name,path:{}.API_URL+"/file/"+e.file.path,online:!0})}return(e,a)=>(D(),fe(kt,null,[t(vl,{style:{"background-color":"#ebeced"}},{default:l(()=>{var s,y,x;return[g("div",Is,[g("div",Es,[_(Be)?(D(),Y(Ul,{key:0,onMenuAction:Un,object:_(r).items[_(r).activeItemIndex],"selected-count":(s=_(r).selectedTargets)==null?void 0:s.length,"disable-undo":_(B)||_(We).length<1,"disable-redo":_(B)||_(ft).length<1,"disable-paste":_(B)||!U.value,zoom:_(J),rulersGridVisible:_(bt)},null,8,["object","selected-count","disable-undo","disable-redo","disable-paste","zoom","rulersGridVisible"])):ke("",!0),!_(Be)&&!_(B)?(D(),Y(Ss,{key:1,locked:_(B),onLockToggle:yn,onNavGoBack:wn,onMenuAction:Un,object:_(r).items[_(r).activeItemIndex],"selected-count":(y=_(r).selectedTargets)==null?void 0:y.length,"disable-undo":_(B)||_(We).length<1,"disable-redo":_(B)||_(ft).length<1,"disable-paste":_(B)||!U.value,zoom:_(J),rulersGridVisible:_(bt),deviceModel:_(ht),onShowMoreDevices:ue},null,8,["locked","object","selected-count","disable-undo","disable-redo","disable-paste","zoom","rulersGridVisible","deviceModel"])):ke("",!0)]),g("div",Ds,[_(B)?ke("",!0):(D(),fe("div",Ts,[_(B)?ke("",!0):(D(),Y(Ao,{key:0,"selected-tool":b.value,images:_(Ie).images,"object-lib":_(Ie).objLib,onSelectTool:O,onDeleteLibItem:Ja,onRenameLibItem:Za,onDeleteLibImage:el,onSaveLibImage:Fa,onToolDropped:nl,isBuiltInEdge:_(Be)},null,8,["selected-tool","images","object-lib","isBuiltInEdge"]))])),g("div",$s,[g("div",Ps,[!_(B)&&_(bt)?(D(),fe("div",Ms)):ke("",!0),!_(B)&&_(bt)?(D(),fe("div",Os,[t(Nl,{id:"h-ruler",documentArea:_(Gt)},null,8,["documentArea"])])):ke("",!0),!_(B)&&_(bt)?(D(),fe("div",zs,[t(ql,{id:"v-ruler",documentArea:_(Gt)},null,8,["documentArea"])])):ke("",!0),!_(B)&&_(bt)?(D(),fe("div",Ls,[t(Hl,{id:"hv-grid",documentArea:_(Gt)},null,8,["documentArea"])])):ke("",!0),g("div",{class:"viewport-wrapper",onScroll:a[11]||(a[11]=(...f)=>e.handleScroll&&e.handleScroll(...f))},[g("div",{class:Lt(["flex fixed top-20 ml-10 z-50 nav-btns",{locked:_(B)}])},[((x=_(Wt))==null?void 0:x.length)>1?(D(),Y(K,{key:0,icon:"arrow_back",class:"back-btn mr-2",dense:"",round:"",size:"md",color:"primary",onClick:wn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[Rs]),_:1})]),_:1})):ke("",!0),_(Be)?(D(),Y(K,{key:1,icon:_(B)?"lock_outline":"lock_open",class:"lock-btn",flat:"",round:"",dense:"",size:"md",color:_(B)?"primary":"normal",onClick:yn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[_(B)?(D(),fe("strong",As,"Unlock")):(D(),fe("strong",js,"Lock"))]),_:1})]),_:1},8,["icon","color"])):ke("",!0)],2),g("div",null,[!_(Be)&&_(B)?(D(),Y(K,{key:0,icon:_(B)?"lock_outline":"lock_open",class:"lock-btn",flat:"",round:"",dense:"",size:"md",color:_(B)?"primary":"normal",onClick:yn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[_(B)?(D(),fe("strong",Gs,"Unlock")):(D(),fe("strong",Ws,"Lock"))]),_:1})]),_:1},8,["icon","color"])):ke("",!0)]),g("div",{class:"viewport",tabindex:"0",onMousemove:oe,onContextmenu:an(ol,["right"]),onClick:an(ll,["left"]),onDragover:a[10]||(a[10]=f=>{f.preventDefault()})},[!_(B)&&b.value.name!=="Pointer"?(D(),Y(Bt,{key:0,class:"cursor-icon",name:b.value.icon?b.value.icon:b.value.type==="libItem"?"space_dashboard":"photo",size:"sm",style:la({left:le.value.x+0+"px",top:le.value.y+"px"})},null,8,["name","style"])):ke("",!0),t(_(Fn),{ref_key:"selecto",ref:n,dragContainer:".viewport",selectableTargets:_(B)?[]:c.value,hitRate:20,selectByClick:!_(B),selectFromInside:!0,toggleContinueSelect:["shift"],ratio:0,boundContainer:!0,getElementRect:_(Dn),onDragStart:Ze,onSelectEnd:ot,onDragEnd:we,dragCondition:un},null,8,["selectableTargets","selectByClick","getElementRect"]),g("div",{ref_key:"viewport",ref:Yl},[t(_(io),{ref_key:"moveable",ref:dt,draggable:!_(B),resizable:!_(B),rotatable:!_(B),keepRatio:S.value,target:_(r).selectedTargets,snappable:p.value&&!_(B),snapThreshold:10,isDisplaySnapDigit:!0,snapGap:!0,snapDirections:{top:!0,right:!0,bottom:!0,left:!0},elementSnapDirections:{top:!0,right:!0,bottom:!0,left:!0},snapDigit:0,elementGuidelines:_(r).elementGuidelines,origin:!0,throttleResize:0,throttleRotate:0,rotationPosition:"top",originDraggable:!0,originRelative:!0,defaultGroupRotate:0,defaultGroupOrigin:"50% 50%",padding:{left:0,top:0,right:0,bottom:0},onClickGroup:lt,onDragStart:Xe,onDrag:Ue,onDragEnd:Qe,onDragGroupStart:Ke,onDragGroup:Je,onDragGroupEnd:Ne,onResizeStart:Re,onResize:C,onResizeEnd:k,onRotateStart:m,onRotate:E,onRotateEnd:T,onResizeGroupStart:w,onResizeGroup:j,onResizeGroupEnd:W,onRotateGroupStart:L,onRotateGroup:G,onRotateGroupEnd:I,renderDirections:["n","nw","ne","s","se","sw","e","w"]},null,8,["draggable","resizable","rotatable","keepRatio","target","snappable","elementGuidelines"]),z.value?(D(),Y(Ct,{key:0,"touch-position":"",target:".moveable-area","context-menu":""},{default:l(()=>[t(at,null,{default:l(()=>[de((D(),Y(se,{dense:"",clickable:"",onClick:Zt},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"content_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Copy")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + C")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:hn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"content_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Duplicate")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + D")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:mn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"join_full",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Group")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + G")]),_:1})]),_:1})]),_:1})),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:bn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"join_inner",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Ungroup")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + Shift + G")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:Hn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"library_books",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Add to Library")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + L")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:a[0]||(a[0]=f=>Qa())},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"flip_to_front",color:"grey-7","text-color":"white"})]),_:1}),t(P,{class:"py-2"},{default:l(()=>[$("Bring to front")]),_:1})]),_:1})),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:a[1]||(a[1]=f=>Ka())},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"flip_to_back",color:"grey-7","text-color":"white"})]),_:1}),t(P,{class:"py-2"},{default:l(()=>[$("Send to Back")]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:a[2]||(a[2]=f=>Qn())},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"autorenew",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate 90\xB0")]),_:1})]),_:1})),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:a[3]||(a[3]=f=>Qn(!0))},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"sync",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate -90\xB0")]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:pn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"delete",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Delete")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Delete")]),_:1})]),_:1})]),_:1})),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:gn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"splitscreen",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Weld Selected")]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + B")]),_:1})]),_:1})]),_:1})),[[ve]])]),_:1})]),_:1})):ke("",!0),(D(!0),fe(kt,null,Et(_(r).items,(f,ne)=>{var Q,Se,Ee,Le,ye,qe,It,en,ce,be,ct,ut;return D(),fe("div",{key:f.id,ref_for:!0,ref_key:"targets",ref:c,style:la(`position: absolute; transform: translate(${f.translate[0]}px, ${f.translate[1]}px) rotate(${f.rotate}deg) scaleX(${f.scaleX}) scaleY(${f.scaleY}); width: ${f.width}px; height: ${f.height}px; z-index: ${f.zindex};`),id:`moveable-item-${f.id}`,onMousedown:an(Ut,["right"]),class:Lt(["moveable-item-wrapper",`moveable-item-index-${ne}`])},[!_(B)&&((Q=_(r).selectedTargets)==null?void 0:Q.length)===1?(D(),Y(Ct,{key:0,"touch-position":"","context-menu":""},{default:l(()=>[t(at,null,{default:l(()=>[Jt.value?(D(),Y(se,{key:0,dense:""},{default:l(()=>[Vs,t(Ft,{label:et.value,modelValue:et.value,"onUpdate:modelValue":a[4]||(a[4]=V=>et.value=V),color:"blue",onClick:V=>Ot(f,"mode",V),"false-value":"Auto","true-value":"Manual"},null,8,["label","modelValue","onClick"])]),_:2},1024)):ke("",!0),t(_e),$t.value?(D(),Y(se,{key:1,dense:"",disable:pt.value},{default:l(()=>[Bs,t(Ft,{disable:pt.value,label:rt.value,modelValue:rt.value,"onUpdate:modelValue":a[5]||(a[5]=V=>rt.value=V),color:"blue",onClick:V=>Ot(f,"value",V),"false-value":"Off","true-value":"On"},null,8,["disable","label","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),Pt.value?(D(),Y(se,{key:2,dense:"",disable:gt.value},{default:l(()=>[Ys,t(sa,{style:{"margin-left":"15px","margin-top":"-5px"},disable:gt.value,dense:"",type:"number",modelValue:Mt.value,"onUpdate:modelValue":a[6]||(a[6]=V=>Mt.value=V),onClick:V=>Ot(f,"number-value",V)},null,8,["disable","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:vn},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"link",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Link")]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:Zt},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"content_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[t(Me,null,{default:l(()=>[$("Copy")]),_:1})]),_:1}),t(P,{side:""},{default:l(()=>[t(tt,null,{default:l(()=>[$("Ctrl + C")]),_:1})]),_:1})]),_:1})),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>he(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"file_copy",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Duplicate")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>H(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"autorenew",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate 90\xB0")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>H(f,!0)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"sync",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Rotate -90\xB0")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>me(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"flip",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Flip horizontal")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>Ae(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"flip",color:"grey-7","text-color":"white",style:{transform:"rotate(90deg)"}})]),_:1}),t(P,null,{default:l(()=>[$("Flip vertical")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>ze(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"flip_to_front",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Bring to front")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>it(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"flip_to_back",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Send to Back")]),_:1})]),_:2},1032,["onClick"])),[[ve]]),t(_e),t(se,{dense:"",clickable:""},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"transform",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Convert to")]),_:1}),t(P,{side:""},{default:l(()=>[t(Bt,{name:"keyboard_arrow_right"})]),_:1}),t(Ct,{anchor:"top end",self:"top start","auto-close":""},{default:l(()=>[t(at,null,{default:l(()=>[(D(!0),fe(kt,null,Et(_(Ye).filter(V=>{var tn;return V.name!==((tn=f==null?void 0:f.type)!=null?tn:"")&&!["Duct","Pointer","Text"].includes(V.name)}),V=>de((D(),Y(se,{key:V.name,dense:"",clickable:"",onClick:tn=>Jn(f,V.name)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:V.icon,color:"grey-7","text-color":"white"},null,8,["icon"])]),_:2},1024),t(P,null,{default:l(()=>[$(Oe(V.name),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[ve]])),128))]),_:2},1024)]),_:2},1024)]),_:2},1024),t(_e),de((D(),Y(se,{dense:"",clickable:"",onClick:V=>Ce(f)},{default:l(()=>[t(P,{avatar:""},{default:l(()=>[t(xe,{size:"sm",icon:"remove",color:"grey-7","text-color":"white"})]),_:1}),t(P,null,{default:l(()=>[$("Remove")]),_:1})]),_:2},1032,["onClick"])),[[ve]])]),_:2},1024)]),_:2},1024)):ke("",!0),xn.value&&((Se=_(r).selectedTargets)==null?void 0:Se.length)===0?(D(),Y(Ct,{key:1,"touch-position":"","context-menu":""},{default:l(()=>[t(at,null,{default:l(()=>[t(se,{dense:""},{default:l(()=>[Xs,t(Ft,{label:et.value,modelValue:et.value,"onUpdate:modelValue":a[7]||(a[7]=V=>et.value=V),color:"blue",onClick:V=>Ot(f,"mode",V),"false-value":"Auto","true-value":"Manual"},null,8,["label","modelValue","onClick"])]),_:2},1024),t(_e),$t.value?(D(),Y(se,{key:0,dense:"",disable:pt.value},{default:l(()=>[Us,t(Ft,{disable:pt.value,label:rt.value,modelValue:rt.value,"onUpdate:modelValue":a[8]||(a[8]=V=>rt.value=V),color:"blue",onClick:V=>Ot(f,"value",V),"false-value":"Off","true-value":"On"},null,8,["disable","label","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),Pt.value?(D(),Y(se,{key:1,dense:"",disable:gt.value},{default:l(()=>[Ns,t(sa,{style:{"margin-left":"15px","margin-top":"-5px"},disable:gt.value,dense:"",type:"number",modelValue:Mt.value,"onUpdate:modelValue":a[9]||(a[9]=V=>Mt.value=V),onClick:V=>Ot(f,"number-value",V)},null,8,["disable","modelValue","onClick"])]),_:2},1032,["disable"])):ke("",!0),t(_e)]),_:2},1024)]),_:2},1024)):ke("",!0),((Ee=f==null?void 0:f.type)!=null?Ee:"")!=="Int_Ext_Wall"?(D(),Y(Gl,{ref_for:!0,ref_key:"objectsRef",ref:F,item:f,key:f.id+((Le=f==null?void 0:f.type)!=null?Le:""),class:Lt({link:_(B)&&f.t3Entry}),"show-arrows":_(B)&&!!((ye=f.t3Entry)!=null&&ye.range),onObjectClicked:V=>_n(f),onAutoManualToggle:V=>Cn(f),onChangeValue:kn,onUpdateWeldModel:al,onContextmenu:an(V=>qn(f,V),["right"])},null,8,["item","class","show-arrows","onObjectClicked","onAutoManualToggle","onContextmenu"])):ke("",!0),((qe=f==null?void 0:f.type)!=null?qe:"")==="Weld_General"||((It=f==null?void 0:f.type)!=null?It:"")==="Weld_Duct"?(D(),Y(Bo,{ref_for:!0,ref_key:"objectsRef",ref:F,item:f,key:f.id+((en=f==null?void 0:f.type)!=null?en:""),class:Lt({link:_(B)&&f.t3Entry}),"show-arrows":_(B)&&!!((ce=f.t3Entry)!=null&&ce.range),onObjectClicked:V=>_n(f),onAutoManualToggle:V=>Cn(f),onChangeValue:kn,onUpdateWeldModel:Zn},null,8,["item","class","show-arrows","onObjectClicked","onAutoManualToggle"])):ke("",!0),((be=f==null?void 0:f.type)!=null?be:"")==="Int_Ext_Wall"?(D(),Y(Jl,{ref_for:!0,ref_key:"objectsRef",ref:F,item:f,key:f.id+((ct=f==null?void 0:f.type)!=null?ct:"")+f.index,class:Lt({link:_(B)&&f.t3Entry}),"show-arrows":_(B)&&!!((ut=f.t3Entry)!=null&&ut.range),onObjectClicked:V=>_n(f),onAutoManualToggle:V=>Cn(f),onChangeValue:kn,onUpdateWeldModel:Zn},null,8,["item","class","show-arrows","onObjectClicked","onAutoManualToggle"])):ke("",!0)],46,Fs)}),128))],512)],32)],32)])])])]),!_(B)&&_(r).items[_(r).activeItemIndex]&&(_(r).activeItemIndex||_(r).activeItemIndex===0)&&_(r).selectedTargets.length>0?(D(),Y(Ql,{key:0,object:_(r).items[_(r).activeItemIndex],onRefreshMoveable:La,onT3UpdateEntryField:st,onLinkT3Entry:vn,onGaugeSettings:Va,onMounted:a[12]||(a[12]=f=>ie("Object settings opened")),onNoChange:Ha,onDisplayFieldValueChanged:Nt},null,8,["object"])):ke("",!0)]}),_:1}),t(ln,{modelValue:_(Te).active,"onUpdate:modelValue":a[14]||(a[14]=s=>_(Te).active=s)},{default:l(()=>[t(Dt,{style:{"min-width":"650px"}},{default:l(()=>[t(vt,{class:"row items-center q-pb-none"},{default:l(()=>[qs,t(En),de(t(K,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),_:1}),t(_e),t(vt,{style:{height:"70vh"},class:"scroll"},{default:l(()=>[g("div",Hs,[t(K,{icon:"refresh",flat:"",onClick:Nn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[Qs]),_:1})]),_:1}),t(na,{"option-label":Kt,"option-value":"id",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:_(Te).data,"onUpdate:modelValue":a[13]||(a[13]=s=>_(Te).data=s),options:_(sn),onFilter:qt,label:"Select Entry",class:"grow"},{option:l(s=>[t(se,oa(ia(s.itemProps)),{default:l(()=>[t(P,{class:"grow"},{default:l(()=>[t(Me,null,{default:l(()=>[$(Oe(Kt(s.opt)),1)]),_:2},1024)]),_:2},1024),t(P,{avatar:"",class:"pl-1 min-w-0"},{default:l(()=>[t(tt,{size:"sm",icon:"label_important"},{default:l(()=>[$("Panel: "+Oe(s.opt.pid),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),g("div",Ks,[_(Ve).loadingPanel!==null?(D(),Y(pa,{key:0,indeterminate:"","show-value":"",value:q.value,size:"270px",thickness:.22,color:"light-blue","track-color":"grey-3",class:"q-ma-md overflow-hidden"},{default:l(()=>[g("div",Js,[g("div",null,Oe(q.value)+"%",1),g("div",null," Loading Panel #"+Oe(_(Ve).panelsList[_(Ve).loadingPanel].panel_number),1)])]),_:1},8,["value"])):ke("",!0)])]),_:1}),t(_e),t($n,{align:"right"},{default:l(()=>[de(t(K,{flat:"",label:"Cancel",color:"primary"},null,512),[[ve]]),t(K,{flat:"",label:"Save",disable:!_(Te).data,color:"primary",onClick:dn},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ln,{modelValue:_(He).active,"onUpdate:modelValue":a[17]||(a[17]=s=>_(He).active=s)},{default:l(()=>[t(Dt,{style:{"min-width":"650px"}},{default:l(()=>[t(vt,{class:"row items-center q-pb-none"},{default:l(()=>[Zs,t(En),de(t(K,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),_:1}),t(_e),t(vt,{style:{height:"70vh"},class:"scroll"},{default:l(()=>[g("div",er,[t(K,{icon:"refresh",flat:"",onClick:Nn},{default:l(()=>[t(ge,{anchor:"top middle",self:"bottom middle"},{default:l(()=>[tr]),_:1})]),_:1}),t(na,{"option-label":Kt,label:"Type or select Entry","option-value":"id",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",modelValue:_(He).data,"onUpdate:modelValue":[a[15]||(a[15]=s=>_(He).data=s),a[16]||(a[16]=s=>fn(e.value))],options:_(sn),onFilter:qt,class:"grow",autofocus:"",onFocus:za},{option:l(s=>[t(se,oa(ia(s.itemProps)),{default:l(()=>[t(P,{class:"grow"},{default:l(()=>[t(Me,null,{default:l(()=>[$(Oe(Kt(s.opt)),1)]),_:2},1024)]),_:2},1024),t(P,{avatar:"",class:"pl-1 min-w-0"},{default:l(()=>[t(tt,{size:"sm",icon:"label_important"},{default:l(()=>[$("Panel: "+Oe(s.opt.pid),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),g("div",nr,[_(Ve).loadingPanel!==null?(D(),Y(pa,{key:0,indeterminate:"","show-value":"",value:q.value,size:"270px",thickness:.22,color:"light-blue","track-color":"grey-3",class:"q-ma-md overflow-hidden"},{default:l(()=>[g("div",ar,[g("div",null,Oe(q.value)+"%",1),g("div",null," Loading Panel #"+Oe(_(Ve).panelsList[_(Ve).loadingPanel].panel_number),1)])]),_:1},8,["value"])):ke("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(jl,{active:St.value.active,"onUpdate:active":a[18]||(a[18]=s=>St.value.active=s),data:St.value.data,onSaved:Ba},null,8,["active","data"]),t(ln,{modelValue:M.value.active,"onUpdate:modelValue":a[20]||(a[20]=s=>M.value.active=s)},{default:l(()=>[t(Dt,{style:{"min-width":"450px"}},{default:l(()=>[t(vt,null,{default:l(()=>[lr]),_:1}),t(vt,{class:"q-pt-none"},{default:l(()=>[t(Al,{types:["application/json"],onUploaded:Wa,onFileAdded:Ua})]),_:1}),t($n,{align:"right",class:"text-primary"},{default:l(()=>[t(K,{flat:"",label:"Cancel",onClick:a[19]||(a[19]=s=>M.value.active=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ln,{modelValue:_(ht).active,"onUpdate:modelValue":a[21]||(a[21]=s=>_(ht).active=s)},{default:l(()=>[t(Dt,{style:{"min-width":"900px"}},{default:l(()=>[t(vt,{class:"row items-center q-pb-none"},{default:l(()=>[or,t(En),de(t(K,{icon:"close",flat:"",round:"",dense:""},null,512),[[ve]])]),_:1}),t(_e),t(Kl,{deviceModel:_(ht),onUpdateDeviceModel:X,onTestSendMsg:e.testSendMsg},null,8,["deviceModel","onTestSendMsg"])]),_:1})]),_:1},8,["modelValue"])],64))}};var kr=cn(ir,[["__scopeId","data-v-2a079b54"]]);export{kr as default};

import{j as e}from"./react.3bc90b5d.js";import{r as a,R as s}from"./client.58f92968.js";import{a0 as t,a1 as l,a2 as r,B as o,a3 as n,T as i,a4 as d,a5 as c,a6 as u,u as p,L as x,M as h,E as m,h as g,N as v,i as j,P as b,Q as f,I as _,S as N,R as w,U as y,V as C,X as S,Y as k,Z as I,$ as V}from"./App.4ea21eda.js";import{R as D}from"./RadioGroup.ff7938d5.js";import{I as $}from"./Input.4fa0d50c.js";import{c as E,D as L,a as T,b as F,d as W,e as P,f as H}from"./DataGridHeaderCell.c083631d.js";import{T as O}from"./TableCellLayout.777c5080.js";import"./index.f111124c.js";import"./Serializer.f6a5f515.js";import"./axios.65f6a2c9.js";import"./T3Data.f6c34e59.js";import"./_commonjsHelpers.a5007c1f.js";const z=[{value:0,label:"Unused",unit:"",category:"General"},{value:1,label:"0.0 -> 10",unit:"Volts",category:"Voltage"},{value:2,label:"0.0 -> 100",unit:"%Open",category:"Percentage"},{value:3,label:"4 -> 20",unit:"psi",category:"Pressure"},{value:4,label:"0.0 -> 100",unit:"%",category:"Percentage"},{value:5,label:"0.0 -> 100",unit:"%Cls",category:"Percentage"},{value:6,label:"4 -> 20",unit:"ma",category:"Current"},{value:7,label:"0.0 -> 100",unit:"PWM",category:"PWM"},{value:8,label:"2 -> 10",unit:"Volts",category:"Voltage"}],M=[{value:0,label:"Unused",category:"General"},{value:1,label:"Off/On",category:"Standard"},{value:2,label:"Close/Open",category:"Standard"},{value:3,label:"Stop/Start",category:"Standard"},{value:4,label:"Disable/Enable",category:"Standard"},{value:5,label:"Normal/Alarm",category:"Standard"},{value:6,label:"Normal/High",category:"Standard"},{value:7,label:"Normal/Low",category:"Standard"},{value:8,label:"No/Yes",category:"Standard"},{value:9,label:"Cool/Heat",category:"Standard"},{value:10,label:"Unoccupy/Occupy",category:"Standard"},{value:11,label:"Low/High",category:"Standard"},{value:12,label:"On/Off",category:"Standard"},{value:13,label:"Open/Close",category:"Standard"},{value:14,label:"Start/Stop",category:"Standard"},{value:15,label:"Enable/Disable",category:"Standard"},{value:16,label:"Alarm/Normal",category:"Standard"},{value:17,label:"High/Normal",category:"Standard"},{value:18,label:"Low/Normal",category:"Standard"},{value:19,label:"Yes/No",category:"Standard"},{value:20,label:"Heat/Cool",category:"Standard"},{value:21,label:"Occupy/Unoccupy",category:"Standard"},{value:22,label:"High/Low",category:"Standard"},{value:23,label:"Custom Digital 1",category:"Custom"},{value:24,label:"Custom Digital 2",category:"Custom"},{value:25,label:"Custom Digital 3",category:"Custom"},{value:26,label:"Custom Digital 4",category:"Custom"},{value:27,label:"Custom Digital 5",category:"Custom"},{value:28,label:"Custom Digital 6",category:"Custom"},{value:29,label:"Custom Digital 7",category:"Custom"},{value:30,label:"Custom Digital 8",category:"Custom"}];function U(e,a){const s={23:"9/9",24:"/",25:"/",26:"/",27:"/",28:"/",29:"/",30:"/"};if(s.hasOwnProperty(e))return s[e];const t=function(e){return 1===e?M:z}(a),l=t.find((a=>a.value===e));return l?l.label:"Unknown"}var A="_drawerHeader_k2oy1_5",R="_headerContent_k2oy1_15",B="_drawerTitle_k2oy1_29",K="_inputLabelHeader_k2oy1_41",G="_drawerBody_k2oy1_53",Y="_topCombinedSection_k2oy1_73",J="_defaultColumn_k2oy1_97",Q="_selectionColumn_k2oy1_109",X="_sectionDivider_k2oy1_123",Z="_dividerText_k2oy1_175",q="_topSection_k2oy1_191",ee="_inputLabel_k2oy1_41",ae="_numberInput_k2oy1_231",se="_currentLabel_k2oy1_331",te="_actionButtons_k2oy1_361",le="_saveButton_k2oy1_395",re="_defaultSection_k2oy1_407",oe="_digitalSection_k2oy1_425",ne="_analogSection_k2oy1_447",ie="_analogColumns_k2oy1_461",de="_column_k2oy1_473",ce="_sectionHeader_k2oy1_485",ue="_sectionTitle_k2oy1_505",pe="_rangeGroup_k2oy1_541",xe="_rangeGroupTwoColumn_k2oy1_557",he="_rangeOption_k2oy1_577",me="_editButton_k2oy1_685",ge="_mainContent_k2oy1_779";const ve=({isOpen:p,onClose:x,currentRange:h,digitalAnalog:m,onSave:g,inputLabel:v})=>{const[j,b]=a.exports.useState(h),[f,_]=a.exports.useState(h.toString()),N=()=>{b(h),_(h.toString()),x()};s.useEffect((()=>{p&&(b(h),_(h.toString()))}),[p,h]);const w=U(j,(y=j)>=1&&y<=30?1:0);var y;return e.exports.jsxs(t,{type:"overlay",separator:!0,open:p,onOpenChange:(e,{open:a})=>!a&&N(),position:"end",size:"large",style:{width:"1000px",maxWidth:"90vw"},children:[e.exports.jsx(l,{className:A,children:e.exports.jsx(r,{action:e.exports.jsx(o,{appearance:"subtle","aria-label":"Close",icon:e.exports.jsx(n,{}),onClick:N}),children:e.exports.jsxs("div",{className:R,children:[e.exports.jsx(i,{size:300,weight:"semibold",className:B,children:"Select Range Number"}),v&&e.exports.jsx(i,{size:200,className:K,children:v})]})})}),e.exports.jsxs(d,{className:G,children:[e.exports.jsxs("div",{className:Y,children:[e.exports.jsxs("div",{className:J,children:[e.exports.jsx("div",{className:X,children:e.exports.jsx("span",{className:Z,children:"Default"})}),e.exports.jsx("div",{className:re,children:e.exports.jsx(D,{value:j.toString(),onChange:(e,a)=>b(Number(a.value)),children:e.exports.jsx(c,{value:"0",label:"0. Unused"})})})]}),e.exports.jsxs("div",{className:Q,children:[e.exports.jsx("div",{className:X,children:e.exports.jsx("span",{className:Z,children:"Selection"})}),e.exports.jsxs("div",{className:q,children:[e.exports.jsx(u,{className:ee,children:"Enter Range Number (0-30):"}),e.exports.jsx($,{type:"number",value:f,onChange:(e,a)=>(e=>{_(e);const a=parseInt(e,10);!isNaN(a)&&a>=0&&a<=30&&b(a)})(a.value),className:ae,min:0,max:30}),e.exports.jsx("div",{className:se,children:w}),e.exports.jsxs("div",{className:te,children:[e.exports.jsx(o,{appearance:"primary",onClick:()=>{g(j),x()},className:le,children:"OK"}),e.exports.jsx(o,{appearance:"secondary",onClick:N,children:"Cancel"})]})]})]})]}),e.exports.jsx("div",{className:X,children:e.exports.jsx("span",{className:Z,children:"Digital"})}),e.exports.jsx(D,{value:j.toString(),onChange:(e,a)=>b(Number(a.value)),children:e.exports.jsx("div",{className:ge,children:e.exports.jsxs("div",{className:oe,children:[e.exports.jsxs("div",{className:de,children:[e.exports.jsx("div",{className:ce,children:e.exports.jsx(i,{weight:"semibold",size:300,className:ue,children:"Digital Units"})}),e.exports.jsx("div",{className:xe,children:M.filter((e=>e.value>=1&&e.value<=22)).map((a=>e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:a.value.toString(),label:`${a.value}. ${a.label}`})},a.value)))})]}),e.exports.jsxs("div",{className:de,children:[e.exports.jsxs("div",{className:ce,children:[e.exports.jsx(i,{weight:"semibold",size:300,className:ue,children:"Custom Digital Units"}),e.exports.jsx(o,{appearance:"primary",className:me,children:"Edit"})]}),e.exports.jsxs("div",{className:pe,children:[e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"23",label:"23. 9/9"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"24",label:"24. /"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"25",label:"25. /"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"26",label:"26. /"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"27",label:"27. /"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"28",label:"28. /"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"29",label:"29. /"})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"30",label:"30. /"})})]})]}),e.exports.jsxs("div",{className:de,children:[e.exports.jsxs("div",{className:ce,children:[e.exports.jsx(i,{weight:"semibold",size:300,className:ue,children:"Multi State"}),e.exports.jsx(o,{appearance:"primary",className:me,children:"Edit"})]}),e.exports.jsxs("div",{className:pe,children:[e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"100",label:""})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"101",label:""})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"102",label:""})}),e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:"103",label:""})})]})]})]})})}),e.exports.jsx("div",{className:X,children:e.exports.jsx("span",{className:Z,children:"Output Analog Units"})}),e.exports.jsx(D,{value:j.toString(),onChange:(e,a)=>b(Number(a.value)),children:e.exports.jsx("div",{className:ne,children:e.exports.jsx("div",{className:ie,children:e.exports.jsxs("div",{className:de,children:[e.exports.jsx("div",{className:ce,children:e.exports.jsx(i,{weight:"semibold",size:300,className:ue,children:"Analog Ranges"})}),e.exports.jsx("div",{className:pe,children:z.filter((e=>e.value>=1&&e.value<=8)).map((a=>e.exports.jsx("div",{className:he,children:e.exports.jsx(c,{value:a.value.toString(),label:`${a.value}. ${a.label} ${a.unit}`})},a.value)))})]})})})})]})]})};var je="_container_d6wfp_35",be="_bladeContentContainer_d6wfp_59",fe="_bladeContentWrapper_d6wfp_75",_e="_bladeContent_d6wfp_59",Ne="_partContent_d6wfp_107",we="_toolbar_d6wfp_125",ye="_toolbarContainer_d6wfp_143",Ce="_toolbarButton_d6wfp_159",Se="_toolbarSeparator_d6wfp_237",ke="_searchInputWrapper_d6wfp_253",Ie="_searchIcon_d6wfp_267",Ve="_searchInput_d6wfp_253",De="_overviewHr_d6wfp_387",$e="_dockingBody_d6wfp_403",Ee="_scrollContainer_d6wfp_421",Le="_noData_d6wfp_483",Te="_loadingBar_d6wfp_501",Fe="_autoLoadIndicator_d6wfp_529",We="_editableCell_d6wfp_817",Pe="_editInput_d6wfp_845",He="_saveButton_d6wfp_917",Oe="_refreshIconButton_d6wfp_979",ze="_isRefreshing_d6wfp_1049",Me="_rotating_d6wfp_1081",Ue="_headerCellSort_d6wfp_1091",Ae="_headerCell_d6wfp_1091",Re="_sortIconFaded_d6wfp_1117",Be="_cellFlexContainer_d6wfp_1125",Ke="_editInputContainer_d6wfp_1135",Ge="_errorNotice_d6wfp_1239",Ye="_noPadding_d6wfp_1291",Je="_centerText_d6wfp_1299",Qe="_iconSmall_d6wfp_1343",Xe="_iconMedium_d6wfp_1351",Ze="_iconError_d6wfp_1359",qe="_textError_d6wfp_1371",ea="_flex1_d6wfp_1383",aa="_switchScale_d6wfp_1391",sa="_switchContainer_d6wfp_1399",ta="_rangeLink_d6wfp_1411",la="_marginLeft8_d6wfp_1427";const ra=()=>{const{selectedDevice:t,treeData:l,selectDevice:r,getNextDevice:o,getFilteredDevices:n}=p(),d=x((e=>e.setMessage)),[c,u]=a.exports.useState([]),[D,$]=a.exports.useState(!1),[z,M]=a.exports.useState(null),[A,R]=a.exports.useState(!1),[B,K]=a.exports.useState(new Set),[G,Y]=a.exports.useState(!1),J=a.exports.useRef(!1),Q=a.exports.useRef(null),[X,Z]=a.exports.useState(!1),q=a.exports.useRef(!1),ee=a.exports.useCallback((async()=>{if(t){$(!0),M(null);try{const e=`${h}/api/t3_device/devices/${t.serialNumber}/output-points`,a=await fetch(e);if(!a.ok)throw new Error(`Failed to fetch outputs: ${a.statusText}`);const s=(await a.json()).output_points||[];u(s)}catch(e){const a=e instanceof Error?e.message:"Failed to load outputs";M(a)}finally{$(!1)}}else u([])}),[t]);a.exports.useEffect((()=>{ee()}),[ee]),a.exports.useEffect((()=>{u([]),Y(!1),J.current=!1}),[null==t?void 0:t.serialNumber]),a.exports.useEffect((()=>{if(D||!t||G||J.current)return;(async()=>{if(J.current=!0,c.length>0)Y(!0);else{$(!0);try{const e=await w.refreshFromDevice({serialNumber:t.serialNumber,type:"output",onLoadingChange:e=>{e&&d(`Loading outputs from ${t.nameShowOnTree} (Action 17)...`,"info")}});d(`âœ“ Synced ${e.itemCount} outputs from ${t.nameShowOnTree}`,"success")}catch(e){d(`Failed to sync outputs: ${e instanceof Error?e.message:"Unknown error"}`,"error")}finally{await ee(),Y(!0),$(!1)}}})()}),[D,t,G,ee,c.length,d]);const ae=a.exports.useCallback((async()=>{const e=o();e&&(Z(!0),r(e),setTimeout((()=>{Z(!1)}),500))}),[o,r]),se=a.exports.useCallback((e=>{if(X||D)return;const a=e.currentTarget;a.scrollHeight-a.scrollTop-a.clientHeight<=1&&c.length>0?q.current=!0:q.current=!1}),[X,D,c.length]),te=a.exports.useCallback((e=>{X||D||0===c.length||e.deltaY>0&&q.current&&(q.current=!1,ae())}),[X,D,c.length,ae]);a.exports.useEffect((()=>{t&&Q.current&&Q.current.scrollTo({top:0,behavior:X?"smooth":"auto"})}),[t,X]);const le=(e,a,s)=>{ce({serialNumber:e.serialNumber,outputIndex:e.outputIndex||"",field:a}),pe(s||"")},re=async()=>{if(de)if("fValue"===de.field||ue.trim()){he(!0);try{if(t&&["fullLabel","fValue"].includes(de.field)){const e=c.find((e=>e.serialNumber===de.serialNumber&&e.outputIndex===de.outputIndex));if(!e)throw new Error("Current output data not found");const a={fullLabel:"fullLabel"===de.field?ue:e.fullLabel||"",label:e.label||"",value:"fValue"===de.field?1e3*parseFloat(ue||"0"):parseFloat(e.fValue||"0"),range:parseInt(e.range||"0"),autoManual:parseInt(e.autoManual||"0"),control:0,digitalAnalog:parseInt(e.digitalAnalog||"0"),decom:0,lowVoltage:0,highVoltage:0},s=await fetch(`${h}/api/t3_device/outputs/${t.serialNumber}/${de.outputIndex}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){const e=await s.text();throw new Error(`HTTP ${s.status}: ${e}`)}await s.json()}u((e=>e.map((e=>e.serialNumber===de.serialNumber&&e.outputIndex===de.outputIndex?{...e,[de.field]:"fValue"===de.field?(1e3*parseFloat(ue||"0")).toString():ue}:e)))),ce(null)}catch(e){alert(`Failed to update: ${e instanceof Error?e.message:"Unknown error"}`)}finally{he(!1)}}else ce(null);else ce(null)},oe=e=>{"Enter"===e.key?(e.preventDefault(),re()):"Escape"===e.key&&(e.preventDefault(),ce(null),pe(""))},[ne,ie]=a.exports.useState(""),[de,ce]=a.exports.useState(null),[ue,pe]=a.exports.useState(""),[xe,he]=a.exports.useState(!1),[me,ge]=a.exports.useState(!1),[ra,oa]=a.exports.useState(null),[na,ia]=a.exports.useState(null),[da,ca]=a.exports.useState("ascending"),ua=e=>{na===e?ca("ascending"===da?"descending":"ascending"):(ia(e),ca("ascending"))},pa=s.useMemo((()=>0===c.length?Array(10).fill(null).map(((e,a)=>({serialNumber:(null==t?void 0:t.serialNumber)||0,outputId:"",outputIndex:"",panel:"",fullLabel:"",autoManual:"",hwSwitchStatus:"",fValue:"",units:"",range:"",rangeField:"",lowVoltage:"",highVoltage:"",pwmPeriod:"",status:"",signalType:"",digitalAnalog:"",label:"",typeField:""}))):c),[c,t]),xa=e=>!e.outputIndex&&!e.outputId&&0===c.length,ha=[E({columnId:"panel",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("panel"),children:[e.exports.jsx("span",{children:"Panel"}),"panel"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>e.exports.jsx(O,{children:!xa(a)&&(a.panel||"---")})}),E({columnId:"output",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("output"),children:[e.exports.jsx("span",{children:"Output"}),"output"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=B.has(a.outputIndex||"");return e.exports.jsx(O,{children:!xa(a)&&e.exports.jsxs("div",{className:Be,children:[e.exports.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(!t)return;const a=parseInt(e,10);if(!isNaN(a)){K((a=>new Set(a).add(e)));try{await w.refreshSingleOutput(t.serialNumber,a),await ee()}catch(s){}finally{K((a=>{const s=new Set(a);return s.delete(e),s}))}}})(a.outputIndex||"")},className:`${Oe} ${s?ze:""}`,title:"Refresh this output from device",disabled:s,children:e.exports.jsx(g,{className:`${Qe} ${s?Me:""}`})}),e.exports.jsx(i,{size:200,weight:"regular",children:a.outputId||(a.outputIndex?`OUT${parseInt(a.outputIndex)+1}`:"---")})]})})}}),E({columnId:"fullLabel",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("fullLabel"),children:[e.exports.jsx("span",{children:"Full Label"}),"fullLabel"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=(null==de?void 0:de.serialNumber)===a.serialNumber&&(null==de?void 0:de.outputIndex)===a.outputIndex&&"fullLabel"===(null==de?void 0:de.field);return e.exports.jsx(O,{children:!xa(a)&&(s?e.exports.jsxs("div",{className:Ke,children:[e.exports.jsx("input",{type:"text",className:`${Pe} ${ea}`,value:ue,onChange:e=>pe(e.target.value),onBlur:re,onKeyDown:oe,autoFocus:!0,disabled:xe,placeholder:"Enter label","aria-label":"Edit full label"}),e.exports.jsx("button",{onClick:e=>{e.stopPropagation(),re()},disabled:xe,className:He,title:"Save",children:e.exports.jsx(k,{className:Xe})})]}):e.exports.jsx("div",{className:We,onDoubleClick:()=>le(a,"fullLabel",a.fullLabel||""),title:"Double-click to edit",children:e.exports.jsx(i,{size:200,weight:"regular",children:a.fullLabel||"Unnamed"})}))})}}),E({columnId:"label",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("label"),children:[e.exports.jsx("span",{children:"Label"}),"label"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=(null==de?void 0:de.serialNumber)===a.serialNumber&&(null==de?void 0:de.outputIndex)===a.outputIndex&&"label"===(null==de?void 0:de.field);return e.exports.jsx(O,{children:!xa(a)&&(s?e.exports.jsxs("div",{className:Ke,children:[e.exports.jsx("input",{type:"text",className:`${Pe} ${ea}`,value:ue,onChange:e=>pe(e.target.value),onBlur:re,onKeyDown:oe,autoFocus:!0,disabled:xe,placeholder:"Enter label","aria-label":"Edit label"}),e.exports.jsx("button",{onClick:e=>{e.stopPropagation(),re()},disabled:xe,className:He,title:"Save",children:e.exports.jsx(k,{className:Xe})})]}):e.exports.jsx("div",{className:We,onDoubleClick:()=>le(a,"label",a.label||""),title:"Double-click to edit",children:e.exports.jsx(i,{size:200,weight:"regular",children:a.label||"---"})}))})}}),E({columnId:"autoManual",renderHeaderCell:()=>e.exports.jsx("div",{className:Ae,children:e.exports.jsx("span",{children:"Auto/Man"})}),renderCell:a=>{var s;const t=null==(s=a.autoManual)?void 0:s.toString().toLowerCase(),l="auto"===t||"1"===t;return e.exports.jsx(O,{children:!xa(a)&&e.exports.jsx("div",{onClick:async()=>{const e=l?"0":"1";try{const s=c.find((e=>e.serialNumber===a.serialNumber&&e.outputIndex===a.outputIndex));if(!s)throw new Error("Current output data not found");const t={fullLabel:s.fullLabel||"",label:s.label||"",value:parseFloat(s.fValue||"0"),range:parseInt(s.range||"0"),autoManual:parseInt(e),control:0,lowVoltage:parseFloat(s.lowVoltage||"0"),highVoltage:parseFloat(s.highVoltage||"0"),pwmPeriod:parseInt(s.pwmPeriod||"0")},l=await fetch(`${h}/api/t3_device/outputs/${a.serialNumber}/${a.outputIndex}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok){const e=await l.text();throw new Error(`HTTP ${l.status}: ${e}`)}await l.json();u((s=>s.map((s=>s.serialNumber===a.serialNumber&&s.outputIndex===a.outputIndex?{...s,autoManual:e}:s))))}catch(s){alert(`Failed to update Auto/Man: ${s instanceof Error?s.message:"Unknown error"}`)}},className:sa,children:e.exports.jsx(I,{checked:l,className:aa})})})}}),E({columnId:"hoaSwitch",renderHeaderCell:()=>e.exports.jsx("div",{className:Ae,children:e.exports.jsx("span",{children:"HOA Switch"})}),renderCell:a=>{var s;const t=(null==(s=a.hwSwitchStatus)?void 0:s.toString())||"1";let l="AUTO",r="success";return"0"===t?(l="MAN-OFF",r="danger"):"2"===t?(l="MAN-ON",r="warning"):(l="AUTO",r="success"),e.exports.jsx(O,{children:!xa(a)&&e.exports.jsx(V,{appearance:"filled",color:r,size:"small",children:l})})}}),E({columnId:"value",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("value"),children:[e.exports.jsx("span",{children:"Value"}),"value"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=(null==de?void 0:de.serialNumber)===a.serialNumber&&(null==de?void 0:de.outputIndex)===a.outputIndex&&"fValue"===(null==de?void 0:de.field);return e.exports.jsx(O,{children:!xa(a)&&(s?e.exports.jsxs("div",{className:Ke,children:[e.exports.jsx("input",{type:"number",step:"0.01",className:`${Pe} ${ea}`,value:ue,onChange:e=>pe(e.target.value),onBlur:re,onKeyDown:oe,autoFocus:!0,disabled:xe,placeholder:"Enter value","aria-label":"Edit value"}),e.exports.jsx("button",{onClick:e=>{e.stopPropagation(),re()},disabled:xe,className:He,title:"Save",children:e.exports.jsx(k,{className:Xe})})]}):e.exports.jsx("div",{className:We,onDoubleClick:()=>le(a,"fValue",a.fValue?(parseFloat(a.fValue)/1e3).toFixed(2):"0"),title:"Double-click to edit",children:e.exports.jsx(i,{size:200,weight:"regular",children:a.fValue?(parseFloat(a.fValue)/1e3).toFixed(2):"---"})}))})}}),E({columnId:"units",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("units"),children:[e.exports.jsx("span",{children:"Units"}),"units"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>e.exports.jsx(O,{children:!xa(a)&&(a.units||"---")})}),E({columnId:"range",compare:(e,a)=>{const s=e.range||"",t=a.range||"";return s.localeCompare(t)},renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("range"),children:[e.exports.jsx("span",{children:"Range"}),"range"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=U(a.range?parseInt(a.range):0,"Digital"===a.signalType?1:0);return e.exports.jsx(O,{children:!xa(a)&&e.exports.jsx("div",{onClick:()=>(e=>{oa(e),ge(!0)})(a),className:ta,title:"Click to change range",children:e.exports.jsx(i,{size:200,weight:"regular",children:s})})})}}),E({columnId:"lowVoltage",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("lowVoltage"),children:[e.exports.jsx("span",{children:"Low V"}),"lowVoltage"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=(null==de?void 0:de.serialNumber)===a.serialNumber&&(null==de?void 0:de.outputIndex)===a.outputIndex&&"lowVoltage"===(null==de?void 0:de.field);return e.exports.jsx(O,{children:!xa(a)&&(s?e.exports.jsx("input",{type:"number",step:"0.01",className:Pe,value:ue,onChange:e=>pe(e.target.value),onBlur:re,onKeyDown:oe,autoFocus:!0,disabled:xe,placeholder:"Enter voltage","aria-label":"Edit low voltage"}):e.exports.jsx("div",{className:We,onDoubleClick:()=>{var e;return le(a,"lowVoltage",(null==(e=a.lowVoltage)?void 0:e.toString())||"0")},title:"Double-click to edit",children:e.exports.jsx(i,{size:200,weight:"regular",children:a.lowVoltage||"---"})}))})}}),E({columnId:"highVoltage",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("highVoltage"),children:[e.exports.jsx("span",{children:"High V"}),"highVoltage"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{const s=(null==de?void 0:de.serialNumber)===a.serialNumber&&(null==de?void 0:de.outputIndex)===a.outputIndex&&"highVoltage"===(null==de?void 0:de.field);return e.exports.jsx(O,{children:!xa(a)&&(s?e.exports.jsx("input",{type:"number",step:"0.01",className:Pe,value:ue,onChange:e=>pe(e.target.value),onBlur:re,onKeyDown:oe,autoFocus:!0,disabled:xe,placeholder:"Enter voltage","aria-label":"Edit high voltage"}):e.exports.jsx("div",{className:We,onDoubleClick:()=>{var e;return le(a,"highVoltage",(null==(e=a.highVoltage)?void 0:e.toString())||"0")},title:"Double-click to edit",children:e.exports.jsx(i,{size:200,weight:"regular",children:a.highVoltage||"---"})}))})}}),E({columnId:"pwmPeriod",renderHeaderCell:()=>e.exports.jsx("div",{className:Ae,children:e.exports.jsx("span",{children:"PWM Period"})}),renderCell:a=>{const s=(null==de?void 0:de.serialNumber)===a.serialNumber&&(null==de?void 0:de.outputIndex)===a.outputIndex&&"pwmPeriod"===(null==de?void 0:de.field);return e.exports.jsx(O,{children:!xa(a)&&(s?e.exports.jsx("input",{type:"number",step:"1",className:Pe,value:ue,onChange:e=>pe(e.target.value),onBlur:re,onKeyDown:oe,autoFocus:!0,disabled:xe,placeholder:"Enter period","aria-label":"Edit PWM period"}):e.exports.jsx("div",{className:We,onDoubleClick:()=>{var e;return le(a,"pwmPeriod",(null==(e=a.pwmPeriod)?void 0:e.toString())||"0")},title:"Double-click to edit",children:e.exports.jsx(i,{size:200,weight:"regular",children:a.pwmPeriod||"---"})}))})}}),E({columnId:"status",renderHeaderCell:()=>e.exports.jsxs("div",{className:Ue,onClick:()=>ua("status"),children:[e.exports.jsx("span",{children:"Status"}),"status"===na?"ascending"===da?e.exports.jsx(y,{}):e.exports.jsx(C,{}):e.exports.jsx(S,{className:Re})]}),renderCell:a=>{var s;let t="Normal",l="success";const r=null==(s=a.status)?void 0:s.toString();return"0"===r||"64"===r?(t="Normal",l="success"):r&&"online"!==r&&"normal"!==r?(t=`Code ${r}`,l="warning"):"online"!==(null==r?void 0:r.toLowerCase())&&"normal"!==(null==r?void 0:r.toLowerCase())||(t="Normal",l="success"),e.exports.jsx(O,{children:!xa(a)&&e.exports.jsx(V,{appearance:"filled",color:l,children:t})})}}),E({columnId:"signalType",renderHeaderCell:()=>e.exports.jsx("div",{className:Ae,children:e.exports.jsx("span",{children:"Type"})}),renderCell:a=>{let s="Virtual",t="success";switch(a.typeField||"0"){case"0":default:s="Virtual",t="success";break;case"1":s="Digital",t="informative";break;case"2":s="Analog",t="brand";break;case"3":s="Extend Digital",t="informative";break;case"4":s="Extend Analog",t="brand";break;case"5":s="Internal",t="warning"}return e.exports.jsx(O,{children:!xa(a)&&e.exports.jsx(V,{appearance:"outline",color:t,children:s})})}})];return e.exports.jsxs("div",{className:je,children:[e.exports.jsx("div",{className:be,children:e.exports.jsx("div",{className:fe,children:e.exports.jsx("div",{className:_e,children:e.exports.jsxs("div",{className:Ne,children:[z&&e.exports.jsxs("div",{className:Ge,children:[e.exports.jsx(m,{className:Ze}),e.exports.jsx(i,{className:qe,children:z})]}),t&&e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("div",{className:we,children:e.exports.jsxs("div",{className:ye,children:[e.exports.jsxs("button",{className:Ce,onClick:async()=>{if(t){R(!0),d("Refreshing outputs from device...","info");try{const e=await w.refreshFromDevice({serialNumber:t.serialNumber,type:"output",onLoadingChange:e=>{e&&d("Loading data from device (Action 17)...","info")}});d(e.message,"success")}catch(e){const a=e instanceof Error?e.message:"Failed to refresh from device";M(a),d(a,"error")}finally{await ee(),R(!1)}}},disabled:A,title:"Refresh all outputs from device","aria-label":"Refresh from Device",children:[e.exports.jsx(g,{}),e.exports.jsx("span",{children:A?"Refreshing...":"Refresh from Device"})]}),e.exports.jsxs("button",{className:Ce,onClick:()=>{},title:"Export to CSV","aria-label":"Export to CSV",children:[e.exports.jsx(v,{}),e.exports.jsx("span",{children:"Export to CSV"})]}),e.exports.jsx("div",{className:Se,role:"separator"}),e.exports.jsxs("button",{className:Ce,onClick:()=>{},title:"Settings","aria-label":"Settings",children:[e.exports.jsx(j,{}),e.exports.jsx("span",{children:"Settings"})]}),e.exports.jsxs("div",{className:ke,children:[e.exports.jsx(b,{className:Ie}),e.exports.jsx("input",{className:Ve,type:"text",placeholder:"Search outputs...",value:ne,onChange:e=>{ie(e.target.value)},spellCheck:"false",role:"searchbox","aria-label":"Search outputs"})]}),e.exports.jsx(f,{content:`Showing output points for ${t.nameShowOnTree} (SN: ${t.serialNumber}). This table displays all configured output points including digital and analog outputs, their current values, voltage settings, and operational status.`,relationship:"description",children:e.exports.jsx("button",{className:`${Ce} ${la}`,title:"Information","aria-label":"Information about this page",children:e.exports.jsx(_,{})})})]})}),e.exports.jsx("div",{className:Ye,children:e.exports.jsx("hr",{className:De})})]}),e.exports.jsxs("div",{className:$e,children:[D&&0===c.length&&e.exports.jsxs("div",{className:Te,children:[e.exports.jsx(N,{size:"tiny"}),e.exports.jsx(i,{size:200,weight:"regular",children:"Loading outputs..."})]}),!t&&!D&&e.exports.jsx("div",{className:Le,children:e.exports.jsxs("div",{className:Je,children:[e.exports.jsx(i,{size:400,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(i,{size:200,children:"Please select a device from the tree to view outputs"})]})}),t&&!D&&e.exports.jsxs("div",{ref:Q,className:Ee,onScroll:se,onWheel:te,children:[e.exports.jsxs(L,{items:pa,columns:ha,sortable:!0,resizableColumns:!0,columnSizingOptions:{output:{minWidth:60,defaultWidth:80},panel:{minWidth:60,defaultWidth:75},fullLabel:{minWidth:150,defaultWidth:200},autoManual:{minWidth:90,defaultWidth:120},hoaSwitch:{minWidth:80,defaultWidth:120},value:{minWidth:100,defaultWidth:140},units:{minWidth:100,defaultWidth:150},range:{minWidth:80,defaultWidth:120},lowVoltage:{minWidth:80,defaultWidth:100},highVoltage:{minWidth:80,defaultWidth:100},pwmPeriod:{minWidth:90,defaultWidth:120},status:{minWidth:80,defaultWidth:100},signalType:{minWidth:60,defaultWidth:80},label:{minWidth:130,defaultWidth:170}},children:[e.exports.jsx(T,{children:e.exports.jsx(F,{children:({renderHeaderCell:a})=>e.exports.jsx(W,{children:a()})})}),e.exports.jsx(P,{children:({item:a,rowId:s})=>e.exports.jsx(F,{children:({renderCell:s})=>e.exports.jsx(H,{children:s(a)})},s)})]}),X&&e.exports.jsxs("div",{className:Fe,children:[e.exports.jsx(N,{size:"tiny"}),e.exports.jsx(i,{size:200,weight:"regular",children:"Loading next device..."})]})]})]})]})})})}),ra&&e.exports.jsx(ve,{isOpen:me,onClose:()=>ge(!1),currentRange:ra.range?parseInt(ra.range):0,digitalAnalog:"Digital"===ra.signalType?1:0,onSave:async e=>{if(ra)try{const a={fullLabel:ra.fullLabel||"",label:ra.label||"",value:parseFloat(ra.fValue||"0"),range:e,autoManual:parseInt(ra.autoManual||"0"),control:0,lowVoltage:parseFloat(ra.lowVoltage||"0"),highVoltage:parseFloat(ra.highVoltage||"0"),pwmPeriod:parseInt(ra.pwmPeriod||"0")},s=await fetch(`${h}/api/t3_device/outputs/${ra.serialNumber}/${ra.outputIndex}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){const e=await s.text();throw new Error(`HTTP ${s.status}: ${e}`)}await s.json();u((a=>a.map((a=>a.serialNumber===ra.serialNumber&&a.outputIndex===ra.outputIndex?{...a,range:e.toString()}:a))))}catch(a){alert(`Failed to update Range: ${a instanceof Error?a.message:"Unknown error"}`)}},inputLabel:`Output ${ra.outputIndex||ra.outputId} - ${ra.fullLabel||"Unnamed"}`})]})};export{ra as OutputsPage,ra as default};

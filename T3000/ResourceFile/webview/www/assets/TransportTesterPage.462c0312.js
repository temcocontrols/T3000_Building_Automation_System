import{j as e}from"./react.3bc90b5d.js";import{r as s}from"./client.58f92968.js";import{T as t,aP as r,aQ as o,B as l,aF as i,bA as a,cF as n,S as c,b4 as p,bd as x,cG as d,b0 as _,l as E,M as h}from"./App.4ea21eda.js";import{I as m}from"./Input.4fa0d50c.js";import"./index.f111124c.js";import"./Serializer.f6a5f515.js";import"./axios.65f6a2c9.js";import"./T3Data.f6c34e59.js";import"./_commonjsHelpers.a5007c1f.js";var j="_container_1yow5_1",u="_topBar_1yow5_15",A="_topBarControls_1yow5_43",T="_controlGroup_1yow5_57",y="_content_1yow5_69",S="_bottomArea_1yow5_81",f="_messagePanel_1yow5_99",N="_panelHeader_1yow5_117",I="_formGroup_1yow5_141",v="_messageInfo_1yow5_161",b="_infoSection_1yow5_179",w="_responsePanel_1yow5_203",D="_responseText_1yow5_221",L="_responsePlaceholder_1yow5_245",g="_rightPanel_1yow5_265",G="_requestPanel_1yow5_285",P="_requestText_1yow5_303",z="_historyPanel_1yow5_329",R="_historyList_1yow5_345",O="_historyPlaceholder_1yow5_355",C="_historyItem_1yow5_367",V="_historyItemHeader_1yow5_389";const W=({json:t})=>{let r;try{r=JSON.parse(t)}catch{return e.exports.jsx("pre",{className:D,children:t})}const o=(e,s="root",t=new Set)=>(t.add(s),Array.isArray(e)?e.forEach(((e,r)=>{"object"==typeof e&&null!==e&&o(e,`${s}.${r}`,t)})):"object"==typeof e&&null!==e&&Object.keys(e).forEach((r=>{const l=e[r];"object"==typeof l&&null!==l&&o(l,`${s}.${r}`,t)})),t),[l,i]=s.exports.useState((()=>o(r))),a=e=>{i((s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t}))},n=(s,t,r,o=0)=>{const i=20*o,c=l.has(t);if(null===s)return e.exports.jsxs("div",{style:{marginLeft:`${i}px`,fontSize:"12px",fontFamily:"monospace"},children:[void 0!==r&&e.exports.jsxs("span",{style:{color:"#881391"},children:['"',r,'": ']}),e.exports.jsx("span",{style:{color:"#0000ff"},children:"null"})]});if("boolean"==typeof s)return e.exports.jsxs("div",{style:{marginLeft:`${i}px`,fontSize:"12px",fontFamily:"monospace"},children:[void 0!==r&&e.exports.jsxs("span",{style:{color:"#881391"},children:['"',r,'": ']}),e.exports.jsx("span",{style:{color:"#0000ff"},children:s.toString()})]});if("number"==typeof s)return e.exports.jsxs("div",{style:{marginLeft:`${i}px`,fontSize:"12px",fontFamily:"monospace"},children:[void 0!==r&&e.exports.jsxs("span",{style:{color:"#881391"},children:['"',r,'": ']}),e.exports.jsx("span",{style:{color:"#098658"},children:s})]});if("string"==typeof s)return e.exports.jsxs("div",{style:{marginLeft:`${i}px`,fontSize:"12px",fontFamily:"monospace"},children:[void 0!==r&&e.exports.jsxs("span",{style:{color:"#881391"},children:['"',r,'": ']}),e.exports.jsxs("span",{style:{color:"#a31515"},children:['"',s,'"']})]});if(Array.isArray(s))return e.exports.jsxs("div",{style:{marginLeft:`${i}px`,fontSize:"12px",fontFamily:"monospace"},children:[e.exports.jsxs("div",{style:{cursor:"pointer",userSelect:"none"},onClick:()=>a(t),children:[c?e.exports.jsx(_,{fontSize:12}):e.exports.jsx(E,{fontSize:12}),void 0!==r&&e.exports.jsxs("span",{style:{color:"#881391"},children:['"',r,'": ']}),e.exports.jsxs("span",{children:["[",s.length,"]"]})]}),c&&e.exports.jsx("div",{children:s.map(((e,s)=>n(e,`${t}.${s}`,void 0,o+1)))})]});if("object"==typeof s){const l=Object.keys(s);return e.exports.jsxs("div",{style:{marginLeft:`${i}px`,fontSize:"12px",fontFamily:"monospace"},children:[e.exports.jsxs("div",{style:{cursor:"pointer",userSelect:"none"},onClick:()=>a(t),children:[c?e.exports.jsx(_,{fontSize:12}):e.exports.jsx(E,{fontSize:12}),void 0!==r&&e.exports.jsxs("span",{style:{color:"#881391"},children:['"',r,'": ']}),e.exports.jsx("span",{children:`{${l.length}}`})]}),c&&e.exports.jsx("div",{children:l.map((e=>n(s[e],`${t}.${e}`,e,o+1)))})]})}return null};return e.exports.jsx("div",{className:D,style:{padding:"8px",overflow:"auto"},children:n(r,"root")})},B=`${h}/api`,F=()=>{var _;const[E,h]=s.exports.useState("ffi"),[F,$]=s.exports.useState("GET_PANELS_LIST"),[k,Y]=s.exports.useState([]),[H,U]=s.exports.useState(""),[M,q]=s.exports.useState(""),[J,Q]=s.exports.useState("{}"),[K,X]=s.exports.useState(!1),[Z,ee]=s.exports.useState(""),[se,te]=s.exports.useState(""),[re,oe]=s.exports.useState([]),[le,ie]=s.exports.useState(""),[ae,ne]=s.exports.useState(!1),ce=s.exports.useRef(null);s.exports.useEffect((()=>((async()=>{try{const s=new x({apiBaseUrl:B});try{await s.connect("ffi"),ie("Connected via FFI (HTTP API)"),h("ffi")}catch(e){const t=await s.autoConnect();ie(`Connected via ${t}`),h(t)}ce.current=s}catch(s){ie(`Error: ${s instanceof Error?s.message:"Unknown error"}`)}})(),()=>{ce.current&&ce.current.disconnect()})),[]);const pe=[{value:"GET_PANEL_DATA",label:"0 - GET_PANEL_DATA"},{value:"GET_INITIAL_DATA",label:"1 - GET_INITIAL_DATA"},{value:"SAVE_GRAPHIC_DATA",label:"2 - SAVE_GRAPHIC_DATA"},{value:"UPDATE_ENTRY",label:"3 - UPDATE_ENTRY"},{value:"GET_PANELS_LIST",label:"4 - GET_PANELS_LIST"},{value:"GET_PANEL_RANGE_INFO",label:"5 - GET_PANEL_RANGE_INFO"},{value:"GET_ENTRIES",label:"6 - GET_ENTRIES"},{value:"LOAD_GRAPHIC_ENTRY",label:"7 - LOAD_GRAPHIC_ENTRY"},{value:"OPEN_ENTRY_EDIT_WINDOW",label:"8 - OPEN_ENTRY_EDIT_WINDOW"},{value:"SAVE_IMAGE",label:"9 - SAVE_IMAGE"},{value:"SAVE_LIBRAY_DATA",label:"10 - SAVE_LIBRAY_DATA"},{value:"DELETE_IMAGE",label:"11 - DELETE_IMAGE"},{value:"GET_SELECTED_DEVICE_INFO",label:"12 - GET_SELECTED_DEVICE_INFO"},{value:"BIND_DEVICE",label:"13 - BIND_DEVICE"},{value:"SAVE_NEW_LIBRARY_DATA",label:"14 - SAVE_NEW_LIBRARY_DATA"},{value:"LOGGING_DATA",label:"15 - LOGGING_DATA"},{value:"UPDATE_WEBVIEW_LIST",label:"16 - UPDATE_WEBVIEW_LIST"},{value:"GET_WEBVIEW_LIST",label:"17 - GET_WEBVIEW_LIST"}];return e.exports.jsxs("div",{className:j,children:[e.exports.jsx("div",{className:u,children:e.exports.jsxs("div",{className:A,children:[e.exports.jsxs("div",{className:T,children:[e.exports.jsx(t,{size:200,weight:"semibold",children:"Transport Type:"}),e.exports.jsxs(r,{placeholder:"Transport Type",value:"websocket"===E?"WebSocket":"ffi"===E?"FFI":"WebView2",disabled:!0,style:{minWidth:"150px",fontSize:"12px"},size:"small",children:[e.exports.jsx(o,{value:"websocket",text:"WebSocket",children:e.exports.jsx("span",{style:{fontSize:"12px"},children:"WebSocket"})}),e.exports.jsx(o,{value:"ffi",text:"FFI",children:e.exports.jsx("span",{style:{fontSize:"12px"},children:"FFI"})}),e.exports.jsx(o,{value:"webview2",text:"WebView2",children:e.exports.jsx("span",{style:{fontSize:"12px"},children:"WebView2"})})]}),le&&e.exports.jsx(t,{size:200,style:{marginLeft:"8px",color:le.includes("Error")?"#d13438":"#107c10"},children:le})]}),e.exports.jsxs("div",{className:T,children:[e.exports.jsx(t,{size:200,weight:"semibold",children:"Message Type:"}),e.exports.jsx(r,{placeholder:"Select message type",value:(null==(_=pe.find((e=>e.value===F)))?void 0:_.label)||F,onOptionSelect:(e,s)=>s.optionValue&&$(s.optionValue),style:{minWidth:"280px",fontSize:"12px"},size:"small",children:pe.map((s=>e.exports.jsx(o,{value:s.value,text:s.label,children:e.exports.jsx("span",{style:{fontSize:"12px"},children:s.label})},s.value)))})]}),e.exports.jsx(l,{appearance:"primary",icon:e.exports.jsx(i,{fontSize:14}),onClick:async()=>{if(ce.current){X(!0),ee("");try{const s=Date.now(),t={GET_PANEL_DATA:d.GET_PANEL_DATA,GET_INITIAL_DATA:d.GET_INITIAL_DATA,SAVE_GRAPHIC_DATA:d.SAVE_GRAPHIC_DATA,UPDATE_ENTRY:d.UPDATE_ENTRY,GET_PANELS_LIST:d.GET_PANELS_LIST,GET_PANEL_RANGE_INFO:d.GET_PANEL_RANGE_INFO,GET_ENTRIES:d.GET_ENTRIES,LOAD_GRAPHIC_ENTRY:d.LOAD_GRAPHIC_ENTRY,OPEN_ENTRY_EDIT_WINDOW:d.OPEN_ENTRY_EDIT_WINDOW,SAVE_IMAGE:d.SAVE_IMAGE,SAVE_LIBRAY_DATA:d.SAVE_LIBRAY_DATA,DELETE_IMAGE:d.DELETE_IMAGE,GET_SELECTED_DEVICE_INFO:d.GET_SELECTED_DEVICE_INFO,BIND_DEVICE:d.BIND_DEVICE,SAVE_NEW_LIBRARY_DATA:d.SAVE_NEW_LIBRARY_DATA,LOGGING_DATA:d.LOGGING_DATA,UPDATE_WEBVIEW_LIST:d.UPDATE_WEBVIEW_LIST,GET_WEBVIEW_LIST:d.GET_WEBVIEW_LIST}[F];if(void 0===t)throw new Error(`Unknown action: ${F}`);let r={};if("GET_PANELS_LIST"!==F&&(H&&(r.panelId=parseInt(H)),M&&(r.serialNumber=parseInt(M)),"{}"!==J))try{const e=JSON.parse(J);r={...r,...e}}catch(e){}const o=()=>{const e=navigator.userAgent;return e.indexOf("Firefox")>-1?"Firefox":e.indexOf("Chrome")>-1?"Chrome":e.indexOf("Safari")>-1?"Safari":e.indexOf("Edge")>-1?"Edge":"Unknown"},l={action:t,msgId:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,from:o(),...r};te(JSON.stringify(l,null,2));const i=await fetch(`${B}/t3000/ffi/call`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),a=await i.json(),n=Date.now()-s,c=i.ok&&!a.error;if("GET_PANELS_LIST"===F&&c&&a.data){let e=Array.isArray(a.data)?a.data:[];e=e.filter((e=>e&&"object"==typeof e&&void 0!==e.panel_number&&null!==e.panel_number)),Y(e)}ee(JSON.stringify(a,null,2));const p={id:Date.now().toString(),timestamp:new Date,action:F,request:l,response:a,duration:n,status:c?"success":"error"};oe((e=>[p,...e].slice(0,50)))}catch(s){const e={success:!1,error:s instanceof Error?s.message:"Request failed",details:s instanceof Error?s.stack:void 0};ee(JSON.stringify(e,null,2));const t={id:Date.now().toString(),timestamp:new Date,action:F,request:{action:F},response:e,duration:0,status:"error"};oe((e=>[t,...e].slice(0,50)))}finally{X(!1)}}else ee(JSON.stringify({success:!1,error:"Transport not initialized. Please wait for connection."},null,2))},disabled:K,size:"small",children:K?"Sending...":"Send Message"})]})}),e.exports.jsx("div",{className:y,children:e.exports.jsxs("div",{className:S,children:[e.exports.jsxs("div",{className:f,children:[e.exports.jsx("div",{className:N,children:e.exports.jsx(t,{size:200,weight:"semibold",children:"Message"})}),"GET_PANELS_LIST"===F?e.exports.jsxs("div",{className:v,children:[e.exports.jsxs("div",{className:b,children:[e.exports.jsx(t,{size:300,weight:"semibold",style:{marginBottom:"8px"},children:"Description"}),e.exports.jsx(t,{size:200,style:{color:"#605e5c",lineHeight:"1.5"},children:"Retrieves the list of all available panels/devices in the network."})]}),e.exports.jsxs("div",{className:b,children:[e.exports.jsx(t,{size:300,weight:"semibold",style:{marginBottom:"8px"},children:"Parameters"}),e.exports.jsx(t,{size:200,style:{color:"#605e5c"},children:"None required"})]}),e.exports.jsxs("div",{className:b,children:[e.exports.jsx(t,{size:300,weight:"semibold",style:{marginBottom:"8px"},children:"Returns"}),e.exports.jsx(t,{size:200,style:{color:"#605e5c",lineHeight:"1.5"},children:"Array of panels with:"}),e.exports.jsxs("ul",{style:{margin:"4px 0 0 0",padding:"0 0 0 20px",fontSize:"12px",color:"#605e5c"},children:[e.exports.jsx("li",{children:"Panel Number"}),e.exports.jsx("li",{children:"Serial Number"}),e.exports.jsx("li",{children:"Panel Name"}),e.exports.jsx("li",{children:"Object Instance"}),e.exports.jsx("li",{children:"Last Online Time"}),e.exports.jsx("li",{children:"PID (Panel Type)"})]})]}),e.exports.jsx("div",{className:b,children:e.exports.jsx(t,{size:200,style:{color:"#0078d4",fontStyle:"italic"},children:"ðŸ’¡ This is typically the first message you should send to discover available devices."})})]}):e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsxs("div",{className:I,style:{gridColumn:"1 / -1"},children:[e.exports.jsx(t,{size:200,weight:"semibold",children:"Panel ID"}),k.length>0?e.exports.jsx(r,{placeholder:"Select a panel",value:(()=>{const e=k.find((e=>e.panel_number.toString()===H));return e?`${e.panel_name||"Unknown"}, Panel Number: ${e.panel_number}`:H})(),onOptionSelect:(e,s)=>s.optionValue&&U(s.optionValue),size:"small",style:{width:"100%"},children:k.filter((e=>e&&void 0!==e.panel_number)).map((s=>e.exports.jsx(o,{value:s.panel_number.toString(),children:e.exports.jsxs("span",{style:{fontSize:"12px"},children:[s.panel_name||"Unknown",", Panel Number: ",s.panel_number]})},s.panel_number)))}):e.exports.jsx(m,{value:H,onChange:(e,s)=>U(s.value),placeholder:"Run GET_PANELS_LIST first",size:"small",disabled:!0,style:{width:"100%"}})]}),e.exports.jsxs("div",{className:I,style:{gridColumn:"1 / -1"},children:[e.exports.jsx(t,{size:200,weight:"semibold",children:"Serial Number (optional)"}),e.exports.jsx(m,{value:M,onChange:(e,s)=>q(s.value),placeholder:"Leave empty for broadcast",size:"small",style:{width:"100%"}})]})]})]}),e.exports.jsxs("div",{className:w,children:[e.exports.jsxs("div",{className:N,children:[e.exports.jsx(t,{size:200,weight:"semibold",children:"Response"}),Z&&e.exports.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.exports.jsx(l,{appearance:"subtle",size:"small",icon:e.exports.jsx(a,{}),onClick:()=>{navigator.clipboard.writeText(Z)},title:"Copy JSON to clipboard"}),e.exports.jsx(l,{appearance:"subtle",size:"small",icon:e.exports.jsx(n,{}),onClick:()=>ne(!ae),title:ae?"Switch to text view":"Switch to tree view"})]})]}),K&&e.exports.jsx("div",{className:L,children:e.exports.jsx(c,{size:"small",label:"Waiting for response..."})}),!K&&!Z&&e.exports.jsx("div",{className:L,children:e.exports.jsx(t,{size:300,children:"Send a message to see response"})}),!K&&Z&&(ae?e.exports.jsx(W,{json:Z}):e.exports.jsx("pre",{className:D,children:Z}))]}),e.exports.jsxs("div",{className:g,children:[e.exports.jsxs("div",{className:G,children:[e.exports.jsx("div",{className:N,children:e.exports.jsx(t,{size:200,weight:"semibold",children:"Request Payload"})}),!se&&e.exports.jsx("div",{className:L,children:e.exports.jsx(t,{size:300,children:"Request details will appear here"})}),se&&e.exports.jsx("pre",{className:P,children:se})]}),e.exports.jsxs("div",{className:z,children:[e.exports.jsxs("div",{className:N,children:[e.exports.jsx(t,{size:200,weight:"semibold",children:"History"}),e.exports.jsx(l,{appearance:"subtle",size:"small",icon:e.exports.jsx(p,{}),onClick:()=>{oe([])},children:"Clear"})]}),e.exports.jsxs("div",{className:R,children:[0===re.length&&e.exports.jsx("div",{className:O,children:e.exports.jsx(t,{size:300,children:"No messages sent yet"})}),re.map((s=>e.exports.jsxs("div",{className:C,children:[e.exports.jsxs("div",{className:V,children:[e.exports.jsx(t,{size:200,weight:"semibold",children:s.action}),e.exports.jsxs(t,{size:200,style:{color:"success"===s.status?"#107c10":"#d13438"},children:[s.duration,"ms"]})]}),e.exports.jsx(t,{size:100,style:{color:"#605e5c"},children:s.timestamp.toLocaleTimeString()})]},s.id)))]})]})]})]})})]})};export{F as TransportTesterPage,F as default};

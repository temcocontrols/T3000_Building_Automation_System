import{Q as e}from"./QChip.e0f2eff0.js";import{c as t,h as a,w as n,X as i,d as l,a as o,a7 as r,o as s,n as u,e as d,a1 as c,a8 as p,a9 as v,a3 as m,C as g,a4 as h,u as f,a2 as y,a5 as b,au as D,F as w,aa as I,aH as _,aJ as T}from"./index.43a69561.js";import{d as S}from"./dayjs.min.a4094c4f.js";import{C}from"./auto.4ae97206.js";import"./chartjs-adapter-date-fns.esm.6cd07d05.js";import{s as E}from"./RefConstant.5def7c1d.js";import{h as O}from"./T3Data.de2b1c3e.js";import{fa as x,f3 as A}from"./Hvac.f9bb192f.js";import{_ as L}from"./plugin-vue_export-helper.21dcd24c.js";import{Z as R,X as M,a9 as k,a8 as $}from"./index.c36a7bea.js";import{L as P,R as N,C as H,F}from"./ReloadOutlined.e0a6cb50.js";import{A as j}from"./AntdIcon.53cf09ff.js";import{C as U}from"./CheckOutlined.78ae8c86.js";import{al as z,am as B}from"./index.c8614cb4.js";var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"};function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){Y(e,t,a[t])}))}return e}function Y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var q=function(e,a){var n=W({},e,a.attrs);return t(j,W({},n,{icon:V}),null)};q.displayName="BarChartOutlined",q.inheritAttrs=!1;var G=q,K={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832.6 191.4c-84.6-84.6-221.5-84.6-306 0l-96.9 96.9 51 51 96.9-96.9c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204l-96.9 96.9 51.1 51.1 96.9-96.9c84.4-84.6 84.4-221.5-.1-306.1zM446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l96.9-96.9-51.1-51.1-96.9 96.9c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l96.9-96.9-51-51-96.8 97zM260.3 209.4a8.03 8.03 0 00-11.3 0L209.4 249a8.03 8.03 0 000 11.3l554.4 554.4c3.1 3.1 8.2 3.1 11.3 0l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3L260.3 209.4z"}}]},name:"disconnect",theme:"outlined"};function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){Z(e,t,a[t])}))}return e}function Z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var X=function(e,a){var n=J({},e,a.attrs);return t(j,J({},n,{icon:K}),null)};X.displayName="DisconnectOutlined",X.inheritAttrs=!1;var Q=X,ee={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"}}]},name:"export",theme:"outlined"};function te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){ae(e,t,a[t])}))}return e}function ae(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ne=function(e,a){var n=te({},e,a.attrs);return t(j,te({},n,{icon:ee}),null)};ne.displayName="ExportOutlined",ne.inheritAttrs=!1;var ie=ne,le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"};function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){re(e,t,a[t])}))}return e}function re(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var se=function(e,a){var n=oe({},e,a.attrs);return t(j,oe({},n,{icon:le}),null)};se.displayName="FileExcelOutlined",se.inheritAttrs=!1;var ue=se,de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"};function ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){pe(e,t,a[t])}))}return e}function pe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ve=function(e,a){var n=ce({},e,a.attrs);return t(j,ce({},n,{icon:de}),null)};ve.displayName="FileImageOutlined",ve.inheritAttrs=!1;var me=ve,ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M841 370c3-3.3 2.7-8.3-.6-11.3a8.24 8.24 0 00-5.3-2.1h-72.6c-2.4 0-4.6 1-6.1 2.8L633.5 504.6a7.96 7.96 0 01-13.4-1.9l-63.5-141.3a7.9 7.9 0 00-7.3-4.7H380.7l.9-4.7 8-42.3c10.5-55.4 38-81.4 85.8-81.4 18.6 0 35.5 1.7 48.8 4.7l14.1-66.8c-22.6-4.7-35.2-6.1-54.9-6.1-103.3 0-156.4 44.3-175.9 147.3l-9.4 49.4h-97.6c-3.8 0-7.1 2.7-7.8 6.4L181.9 415a8.07 8.07 0 007.8 9.7H284l-89 429.9a8.07 8.07 0 007.8 9.7H269c3.8 0 7.1-2.7 7.8-6.4l89.7-433.1h135.8l68.2 139.1c1.4 2.9 1 6.4-1.2 8.8l-180.6 203c-2.9 3.3-2.6 8.4.7 11.3 1.5 1.3 3.4 2 5.3 2h72.7c2.4 0 4.6-1 6.1-2.8l123.7-146.7c2.8-3.4 7.9-3.8 11.3-1 .9.8 1.6 1.7 2.1 2.8L676.4 784c1.3 2.8 4.1 4.7 7.3 4.7h64.6a8.02 8.02 0 007.2-11.5l-95.2-198.9c-1.4-2.9-.9-6.4 1.3-8.8L841 370z"}}]},name:"function",theme:"outlined"};function he(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){fe(e,t,a[t])}))}return e}function fe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ye=function(e,a){var n=he({},e,a.attrs);return t(j,he({},n,{icon:ge}),null)};ye.displayName="FunctionOutlined",ye.inheritAttrs=!1;var be=ye,De={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};function we(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){Ie(e,t,a[t])}))}return e}function Ie(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _e=function(e,a){var n=we({},e,a.attrs);return t(j,we({},n,{icon:De}),null)};_e.displayName="ImportOutlined",_e.inheritAttrs=!1;var Te=_e,Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"};function Ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){Ee(e,t,a[t])}))}return e}function Ee(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Oe=function(e,a){var n=Ce({},e,a.attrs);return t(j,Ce({},n,{icon:Se}),null)};Oe.displayName="LineChartOutlined",Oe.inheritAttrs=!1;var xe=Oe,Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};function Le(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){Re(e,t,a[t])}))}return e}function Re(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Me=function(e,a){var n=Le({},e,a.attrs);return t(j,Le({},n,{icon:Ae}),null)};Me.displayName="SyncOutlined",Me.inheritAttrs=!1;var ke=Me;const $e={digital:[{id:1,label:"Off/On",off:"Off",on:"On",direct:null},{id:2,label:"Close/Open",off:"Close",on:"Open",direct:null},{id:3,label:"Stop/Start",off:"Stop",on:"Start",direct:null},{id:4,label:"Disable/Enable",off:"Disable",on:"Enable",direct:null},{id:5,label:"Normal/Alarm",off:"Normal",on:"Alarm",direct:null},{id:6,label:"Normal/High",off:"Normal",on:"High",direct:null},{id:7,label:"Normal/Low",off:"Normal",on:"Low",direct:null},{id:8,label:"No/Yes",off:"No",on:"Yes",direct:null},{id:9,label:"Cool/Heat",off:"Cool",on:"Heat",direct:null},{id:10,label:"Unoccupy/Occupy",off:"Unoccupy",on:"Occupy",direct:null},{id:11,label:"Low/High",on:"Low",off:"High",direct:null},{id:12,label:"On/Off",on:"Off",off:"On",direct:!0},{id:13,label:"Open/Close",on:"Close",off:"Open",direct:!0},{id:14,label:"Start/Stop",on:"Stop",off:"Start",direct:!0},{id:15,label:"Enable/Disable",on:"Disable",off:"Enable",direct:!0},{id:16,label:"Alarm/Normal",on:"Normal",off:"Alarm",direct:!0},{id:17,label:"High/Normal",on:"Normal",off:"High",direct:!0},{id:18,label:"Low/Normal",on:"Normal",off:"Low",direct:!0},{id:19,label:"Yes/No",on:"No",off:"Yes",direct:!0},{id:20,label:"Heat/Cool",on:"Cool",off:"Heat",direct:!0},{id:21,label:"Occupy/Unoccupy",on:"Unoccupy",off:"Occupy",direct:!0},{id:22,label:"High/Low",on:"Low",off:"High",direct:!0}],analog:{input:[{id:0,unit:"",label:"Unused"},{id:1,unit:"Deg.C",label:"Y3K -40 to 150"},{id:2,unit:"Deg.F",label:"Y3K -40 to 300"},{id:3,unit:"Deg.C",label:"10K Type2"},{id:4,unit:"Deg.F",label:"10K Type2"},{id:5,unit:"Deg.C",label:"G3K -40 to 120"},{id:6,unit:"Deg.F",label:"G3K -40 to 250"},{id:7,unit:"Deg.C",label:"10K Type3"},{id:8,unit:"Deg.F",label:"10K Type3"},{id:9,unit:"Deg.C",label:"PT 1K -200 to 300"},{id:10,unit:"Deg.F",label:"PT 1K -200 to 570"},{id:11,unit:"Volts",label:"0.0 to 5.0"},{id:12,unit:"Amps",label:"0.0 to 100"},{id:13,unit:"ma",label:"4 to 20"},{id:14,unit:"psi",label:"4 to 20"},{id:15,unit:"counts",label:"Pulse Count (Slow 1Hz)"},{id:16,unit:"%",label:"0 to 100"},{id:17,unit:"%",label:"0 to 100"},{id:18,unit:"%",label:"0 to 100"},{id:19,unit:"Volts",label:"0.0 to 10.0"},{id:25,unit:"counts",label:"Pulse Count (Fast 100Hz)"},{id:26,unit:"Hz",label:"Frequency"},{id:27,unit:"%",label:"Humidty %"},{id:28,unit:"PPM",label:"CO2  PPM"},{id:29,unit:"RPM",label:"Revolutions Per Minute"},{id:30,unit:"PPB",label:"TVOC PPB"},{id:31,unit:"ug/m3",label:"ug/m3"},{id:32,unit:"#/cm3",label:"#/cm3"},{id:33,unit:"dB",label:"dB"},{id:34,unit:"Lux",label:"Lux"}],output:[{id:0,unit:"",label:"Unused"},{id:1,unit:"Volts",label:"0.0 to 10.0"},{id:2,unit:"%Open",label:"0.0 to 100"},{id:3,unit:"psi",label:"4 to 20"},{id:4,unit:"%",label:"0 to 100"},{id:5,unit:"%Cls",label:"0 to 100"},{id:6,unit:"ma",label:"4 to 20"},{id:7,unit:"%PWM",label:"0 to 100"},{id:8,unit:"%",label:"2 to 10"}],variable:[{id:0,unit:"Unused",label:"Unused"},{id:1,unit:"Deg.C",label:"Deg.C"},{id:2,unit:"Deg.F",label:"Deg.F"},{id:3,unit:"Feet per Min",label:"Feet per Min"},{id:4,unit:"Pascals",label:"Pascals"},{id:5,unit:"KPascals",label:"KPascals"},{id:6,unit:"lbs/sqr.inch",label:"lbs/sqr.inch"},{id:7,unit:"inches of WC",label:"inches of WC"},{id:8,unit:"Watts",label:"Watts"},{id:9,unit:"KWatts",label:"KWatts"},{id:10,unit:"KWH",label:"KWH"},{id:11,unit:"Volts",label:"Volts"},{id:12,unit:"KV",label:"KV"},{id:13,unit:"Amps",label:"Amps"},{id:14,unit:"ma",label:"ma"},{id:15,unit:"CFM",label:"CFM"},{id:16,unit:"Seconds",label:"Seconds"},{id:17,unit:"Minutes",label:"Minutes"},{id:18,unit:"Hours",label:"Hours"},{id:19,unit:"Days",label:"Days"},{id:20,unit:"Time",label:"Time"},{id:21,unit:"Ohms",label:"Ohms"},{id:22,unit:"%",label:"%"},{id:23,unit:"%RH",label:"%RH"},{id:24,unit:"p/min",label:"p/min"},{id:25,unit:"Counts",label:"Counts"},{id:26,unit:"%Open",label:"%Open"},{id:27,unit:"Kg",label:"Kg"},{id:28,unit:"L/Hour",label:"L/Hour"},{id:29,unit:"GPH",label:"GPH"},{id:30,unit:"GAL",label:"GAL"},{id:31,unit:"CF",label:"CF"},{id:32,unit:"BTU",label:"BTU"},{id:33,unit:"CMH",label:"CMH"}]}};const Pe=new class{constructor(){this.dataReadiness=a("NOT_INITIALIZED"),this.lastUpdateTime=a(0),this.pendingRequests=new Map,this.dataFlowHistory=[],this.DEFAULT_TIMEOUT=3e4,this.MAX_RETRY_ATTEMPTS=3,this.MAX_HISTORY=50,this.initializeManager()}initializeManager(){var e;this.trackDataFlow("INIT",(null==(e=O.value.panelsData)?void 0:e.length)||0),n((()=>O.value.panelsData),((e,t)=>{this.handlePanelsDataChange(e,t)}),{deep:!0}),n((()=>O.value.loadingPanel),((e,t)=>{this.handleLoadingStateChange(e,t)})),this.assessCurrentDataState()}trackDataFlow(e,t,a,n){const i={timestamp:Date.now(),action:e,entryCount:t,source:a,details:n};this.dataFlowHistory.push(i),this.dataFlowHistory.length>this.MAX_HISTORY&&this.dataFlowHistory.shift()}handlePanelsDataChange(e,t){var a,n;const l=Date.now();this.lastUpdateTime.value=l;const o=(null==e?void 0:e.length)||0,r=(null==t?void 0:t.length)||0;this.trackDataFlow("UPDATE",o,this.detectChangeSource(),{previousCount:r,countDelta:o-r}),i.Debug("= T3DataManager: T3000_DATA UPDATED - Full data details:",{updateInfo:{timestamp:(new Date).toISOString(),source:this.detectChangeSource(),previousCount:r,newCount:o,countDelta:o-r},fullT3000Data:{panelsData:{length:o,data:e},panelsList:{length:(null==(a=O.value.panelsList)?void 0:a.length)||0,data:O.value.panelsList},panelsRanges:{length:(null==(n=O.value.panelsRanges)?void 0:n.length)||0,data:O.value.panelsRanges},loadingPanel:O.value.loadingPanel},dataAnalysis:{uniquePanels:Array.from(new Set((null==e?void 0:e.map((e=>e.pid)))||[])),sampleEntries:(null==e?void 0:e.slice(0,5).map((e=>({pid:e.pid,type:e.type,id:e.id,label:e.label,value:e.value,units:e.units}))))||[]}}),this.isDataComplete(e)&&(this.setDataReadiness("READY"),this.resolvePendingRequests())}detectChangeSource(){try{const e=(new Error).stack;return e?e.includes("WebViewClient")?"WebViewClient":e.includes("WebSocketClient")?"WebSocketClient":e.includes("IndexPage")?"IndexPage":e.includes("demoDeviceData")?"DemoData":"unknown":"unknown"}catch{return"unknown"}}handleLoadingStateChange(e,t){null!==e&&null===t?this.setDataReadiness("LOADING"):null===e&&null!==t&&this.isDataComplete(O.value.panelsData)&&this.setDataReadiness("READY")}setDataReadiness(e){this.dataReadiness.value,this.dataReadiness.value=e,"READY"===e?this.resolvePendingRequests():"ERROR"===e&&this.rejectPendingRequests("Data loading failed")}isDataComplete(e){if(!e||!Array.isArray(e))return!1;const t=e.length>0,a=null===O.value.loadingPanel;return t&&a}assessCurrentDataState(){const e=O.value.panelsData;null!==O.value.loadingPanel?this.setDataReadiness("LOADING"):this.isDataComplete(e)?this.setDataReadiness("READY"):this.setDataReadiness("NOT_INITIALIZED")}async waitForDataReady(e={}){const{timeout:t=this.DEFAULT_TIMEOUT,retryAttempts:a=this.MAX_RETRY_ATTEMPTS,specificEntries:n=[]}=e;if("READY"===this.dataReadiness.value){const e=await this.validateData(n);if(e.isValid)return e}return new Promise(((e,a)=>{const i=`req_${Date.now()}_${Math.random()}`,l=setTimeout((()=>{this.pendingRequests.delete(i),a(new Error(`Data not ready within ${t}ms timeout`))}),t);this.pendingRequests.set(i,{resolve:async()=>{clearTimeout(l),this.pendingRequests.delete(i);try{const t=await this.validateData(n);e(t)}catch(t){a(t)}},reject:e=>{clearTimeout(l),this.pendingRequests.delete(i),a(new Error(e))},timeout:l})}))}async validateData(e=[]){var t;const a=O.value.panelsData||[],n=Date.now();if(!Array.isArray(a))return{isValid:!1,timestamp:n,panelsCount:0,entriesCount:0};let i=!0;if(e.length>0)for(const l of e){if(!a.find((e=>{var t;return e.id===l||e.label===l||(null==(t=e.description)?void 0:t.includes(l))}))){i=!1;break}}return{isValid:i&&a.length>0,timestamp:n,panelsCount:(null==(t=O.value.panelsList)?void 0:t.length)||0,entriesCount:a.length}}async getEntry(e,t={}){if(!(await this.waitForDataReady({...t,specificEntries:[e]})).isValid)throw new Error(`Entry ${e} not available or invalid`);const a=O.value.panelsData.find((t=>{var a;return t.id===e||t.label===e||(null==(a=t.description)?void 0:a.includes(e))}));if(!a)throw new Error(`Entry ${e} not found in panelsData`);return a}async getEntryByPid(e,t,a={}){if(!(await this.waitForDataReady({...a,specificEntries:[e]})).isValid)throw new Error(`Entry ${e} not available or invalid`);const n=O.value.panelsData.filter((e=>e.pid===t));if(0===n.length)throw new Error(`No entries found with PID ${t}`);const i=n.find((t=>{var a;return t.id===e||t.label===e||(null==(a=t.description)?void 0:a.includes(e))}));if(!i)throw new Error(`Entry ${e} not found in PID ${t} filtered data`);return i}async getEntriesMatching(e,t={}){if(!(await this.waitForDataReady(t)).isValid)throw new Error("Data not available for filtering");return O.value.panelsData.filter(e)}resolvePendingRequests(){this.pendingRequests.forEach((e=>{e.resolve()})),this.pendingRequests.clear()}rejectPendingRequests(e){this.pendingRequests.forEach((t=>{t.reject(e)})),this.pendingRequests.clear()}getDataFlowHistory(){return[...this.dataFlowHistory]}getDataStateInfo(){var e;const t=O.value.panelsData||[];return{readiness:this.dataReadiness.value,entryCount:t.length,panelCount:(null==(e=O.value.panelsList)?void 0:e.length)||0,lastUpdate:this.lastUpdateTime.value,isLoading:null!==O.value.loadingPanel,pendingRequests:this.pendingRequests.size}}getReadinessState(){return this.dataReadiness.value}get isReady(){return"READY"===this.dataReadiness.value}get loadingProgress(){var e;const t=O.value.loadingPanel,a=(null==(e=O.value.panelsList)?void 0:e.length)||0;return null===t||0===a?100:Math.round((t+1)/a*100)}clearDataFlowHistory(){this.dataFlowHistory=[]}forceRefresh(){this.assessCurrentDataState()}destroy(){this.rejectPendingRequests("Manager destroyed"),this.dataFlowHistory=[],this.dataReadiness.value="NOT_INITIALIZED"}};function Ne(){const e=a(!1),t=a(null);return{isLoading:e,error:t,getTrendlogHistory:async a=>{e.value=!0,t.value=null;try{const t=await fetch(`http://localhost:9103/api/t3_device/devices/${a.serial_number}/trendlogs/${a.trendlog_id}/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error(`API request failed: ${t.status}`);return await t.json()}catch(n){const e=n instanceof Error?n.message:"Failed to fetch trendlog history";return t.value=e,null}finally{e.value=!1}},saveRealtimeData:async e=>{try{return(await fetch("http://localhost:9103/api/t3_device/trendlog-data/realtime",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok}catch(t){return!1}},saveRealtimeBatch:async e=>{try{const t=await fetch("http://localhost:9103/api/t3_device/trendlog-data/realtime/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Batch save failed: ${t.status}`);return(await t.json()).rows_affected||0}catch(t){return 0}},getRecentData:async(e,t,a,n=100)=>{try{const i=new URLSearchParams({panel_id:t.toString(),limit:n.toString()});a&&a.length>0&&i.set("point_types",a.join(","));const l=await fetch(`http://localhost:9103/api/t3_device/devices/${e}/trendlog-data/recent?${i}`);if(!l.ok)throw new Error(`Failed to fetch recent data: ${l.status}`);return(await l.json()).data||[]}catch(i){return[]}},getDataStatistics:async(e,t)=>{try{const a=new URLSearchParams({panel_id:t.toString()}),n=await fetch(`http://localhost:9103/api/t3_device/devices/${e}/trendlog-data/stats?${a}`);if(!n.ok)throw new Error(`Failed to fetch statistics: ${n.status}`);return await n.json()}catch(a){return null}},getSmartTrendlogData:async e=>{try{const t=await fetch(`http://localhost:9103/devices/${e.serial_number}/trendlog-data/smart`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Failed to fetch smart trendlog data: ${t.status}`);const a=await t.json();return{data:a.data||[],total_points:a.total_points||0,sources_used:a.sources_used||[],consolidation_applied:a.consolidation_applied||!1,has_historical_data:a.has_historical_data||!1}}catch(t){return null}},formatSocketDataForSave:(e,t,a)=>e&&Array.isArray(e.data)?e.data.map((e=>{var n,i,l;return{serial_number:t,panel_id:a,point_id:e.id||`${e.type||"UNK"}${e.index||0}`,point_index:e.index||0,point_type:e.type||"UNKNOWN",value:(null==(n=e.value)?void 0:n.toString())||"0",range_field:null==(i=e.range)?void 0:i.toString(),digital_analog:null==(l=e.digital_analog)?void 0:l.toString(),units:e.units}})):[]}}const He={class:"top-controls-bar"},Fe={class:"timeseries-container"},je={class:"left-panel"},Ue={class:"control-section"},ze={class:"data-series-header"},Be={class:"header-line-1"},Ve={class:"data-source-indicator"},We={key:0,class:"source-badge loading"},Ye={key:1,class:"source-badge realtime"},qe={key:2,class:"source-badge historical"},Ge={key:3,class:"source-badge error"},Ke={class:"header-line-2"},Je={class:"left-controls"},Ze={class:"auto-scroll-toggle"},Xe={class:"series-list"},Qe={key:0,class:"series-empty-state"},et={class:"empty-state-content"},tt={key:0,class:"empty-state-icon"},at={key:1,class:"empty-state-icon"},nt={key:2,class:"empty-state-icon"},it={key:3,class:"empty-state-text"},lt={key:4,class:"empty-state-text"},ot={key:5,class:"empty-state-text"},rt={key:6,class:"empty-state-subtitle"},st={key:7,class:"empty-state-subtitle"},ut={key:8,class:"empty-state-subtitle"},dt=["onClick"],ct={class:"series-info"},pt={class:"series-name-line"},vt={class:"series-name-container"},mt={class:"series-name"},gt={class:"series-inline-tags"},ht={class:"series-controls"},ft={key:0,class:"series-stats"},yt={class:"stat-item"},bt={class:"stat-value"},Dt={class:"stat-item"},wt={class:"stat-value"},It={class:"stat-item"},_t={class:"stat-value"},Tt={class:"stat-item"},St={class:"stat-value"},Ct={class:"right-panel"},Et={class:"oscilloscope-container"},Ot={class:"combined-analog-chart"},xt=["id"],At={key:0,class:"loading-overlay"},Lt={class:"custom-date-modal"},Rt={class:"quick-actions"},Mt={key:0,class:"range-summary"},kt={class:"range-text"};var $t=L(l({__name:"TrendLogChart",props:{itemData:{default:null},title:{default:"Trend Log Chart"}},setup(l){const L=e=>{const t=(e=>{var t;if(e>=0&&e<=22){const t=$e.digital.find((t=>t.id===e));return{type:"digital",id:e,range:t}}const a={31:{category:"variable",id:1},32:{category:"variable",id:2},34:{category:"variable",id:4},35:{category:"variable",id:5},36:{category:"variable",id:6},37:{category:"variable",id:7},38:{category:"variable",id:8},39:{category:"variable",id:9},40:{category:"variable",id:10},41:{category:"variable",id:11},42:{category:"variable",id:12},43:{category:"variable",id:13},44:{category:"variable",id:14},45:{category:"variable",id:15},33:{category:"variable",id:3},46:{category:"variable",id:16},47:{category:"variable",id:17},48:{category:"variable",id:18},49:{category:"variable",id:19},50:{category:"variable",id:20},51:{category:"variable",id:21},52:{category:"variable",id:22},53:{category:"variable",id:23},54:{category:"variable",id:24},55:{category:"variable",id:25},56:{category:"variable",id:26},57:{category:"variable",id:27},58:{category:"variable",id:28},59:{category:"variable",id:29},60:{category:"variable",id:30},61:{category:"variable",id:31},62:{category:"variable",id:32},63:{category:"variable",id:33}}[e];if(a){const e=null==(t=$e.analog[a.category])?void 0:t.find((e=>e.id===a.id));return{type:"analog",category:a.category,id:a.id,range:e}}return{type:"analog"}})(e);return t.range?"digital"===t.type?t.range.label||"":t.range.unit||"":""},j=e=>({1:{name:"Output",category:"OUT"},2:{name:"Input",category:"IN"},3:{name:"Variable",category:"VAR"},4:{name:"Program",category:"PRG"},5:{name:"Controller",category:"CON"},6:{name:"Screen",category:"SCR"},7:{name:"Holiday",category:"HOL"},8:{name:"Schedule",category:"SCH"},9:{name:"Monitor",category:"MON"}}[e]||{name:`Type_${e}`,category:""}),V=e=>e.name||"Unknown",W=(e,t,a)=>{const n=O.value.panelsData,i=O.value.panelsRanges;if(!(null==n?void 0:n.length))return"";const l=j(t);if(!(null==l?void 0:l.category))return"";const o=`${l.category}${a+1}`,r=n.find((t=>String(t.pid)===String(e)&&t.id===o));if(!r||void 0===r.unit)return"";if(null==i?void 0:i.length){const t=i.find((t=>String(t.pid)===String(e)&&t.index===r.range));if("digital"===(null==t?void 0:t.type)&&(t.on||t.off))return`${t.off}/${t.on}`}let s=[];"IN"===l.category?s=$e.analog.input:"OUT"===l.category?s=$e.analog.output:"VAR"===l.category&&(s=$e.analog.variable);const u=s.find((e=>e.id===r.unit));if(u)return u.unit||u.label;const d=$e.digital.find((e=>e.id===r.unit));return d?`${d.off}/${d.on}`:""},Y=e=>e.includes("/")?e.split("/"):void 0,q=e=>{const t=$e.digital.find((t=>t.id===e));return t?!1===t.direct?[t.on,t.off]:[t.off,t.on]:["LOW","HIGH"]},K=e=>{if("digital"!==e.unitType)return e.unit||"";const t=e.unitCode;if("number"!=typeof t||t<0)return"";let a=t;0===t&&(a=1);const n=$e.digital.find((e=>e.id===a));return n?n.label:""},J=e=>new Date(e>1e10?e:1e3*e).toLocaleString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/(\d{4})-(\d{2})-(\d{2}), (\d{2}):(\d{2}):(\d{2})/,"$1-$2-$3 $4:$5:$6"),Z=l,X=o((()=>Z.itemData||E.value)),ee=a("5m"),te=a(1);a(1);const ae=a(null),ne=a(null),le=a(null),oe=a(null),re=a(!1),se=a(!0),de=e=>{if(!e)return 6e4;const{hour_interval_time:t=0,minute_interval_time:a=0,second_interval_time:n=0}=e,i=3600*t+60*a+n;return i>0?Math.max(1e3*i,15e3):6e4},ce=o((()=>de(Se.value))),pe=a(!1),ve=a(!0),ge=a(!1),he=a(!1),fe=a(!1),ye=a("No data synced yet"),De=Ne(),we=a("realtime"),Ie=a(!1),_e=r(),Se=a(null);a("connected"),a({visible:!1,message:""});const Ce=a(new Set),Ee=(e,t,a)=>{const n=O.value.panelsData;if(!(null==n?void 0:n.length))return i.Debug("‚ö†Ô∏è TrendLogChart: No panelsData available for device description",{panelId:e,pointType:t,pointNumber:a}),"";const l=j(t);if(!(null==l?void 0:l.category))return"";const o=`${l.category}${a+1}`,r=n.find((t=>String(t.pid)===String(e)&&t.id===o));if(!r)return i.Debug("‚ö†Ô∏è TrendLogChart: Device not found in panelsData",{panelId:e,pointType:t,pointNumber:a,idToFind:o,availableDevices:n.map((e=>({pid:e.pid,id:e.id}))).slice(0,5)}),"";const s=r.label||r.command||r.fullLabel||r.description||r.id||"";return s||i.Debug("‚ö†Ô∏è TrendLogChart: Device found but no description fields available",{device:r}),s},Oe=(e,t,a)=>{var n;const i=O.value.panelsData;if(!(null==i?void 0:i.length))return 1;const l=j(t);if(!(null==l?void 0:l.category))return 1;const o=`${l.category}${a+1}`,r=i.find((t=>String(t.pid)===String(e)&&t.id===o));return null!=(n=null==r?void 0:r.digital_analog)?n:1},Ae=["#FF0000","#0000FF","#00AA00","#FF8000","#AA00AA","#00AAAA","#CC6600","#AA0000","#0066AA","#AA6600","#6600AA","#006600","#FF6600","#0000AA"],Le=a([]),Re=()=>{const e=(()=>{var e,t,a,n;const l=null==(t=null==(e=Z.itemData)?void 0:e.t3Entry)?void 0:t.input,o=null==(n=null==(a=Z.itemData)?void 0:a.t3Entry)?void 0:n.range;if(!(null==l?void 0:l.length)||!(null==o?void 0:o.length))return[];const r=Math.min(l.length,o.length);if(0===r)return[];const s=[];for(let u=0;u<r;u++){const e=l[u],{panel:t,point_type:a,point_number:n}=e,r=j(a),d=Oe(t,a,n),c=W(t,a,n),p=Ee(t,a,n),v=p;if(!p&&0===t){i.Info("üö´ TrendLogChart: Filtering out placeholder data (no description + panel 0)",{inputItem:e,pointType:a,pointNumber:n,panelId:t,potentialSeriesName:v});continue}if(!p){i.Info("üö´ TrendLogChart: Filtering out undescribed data (prevents demo names)",{inputItem:e,pointType:a,pointNumber:n,panelId:t,potentialSeriesName:v,reason:"No device description - likely demo/test data"});continue}if(v&&(v.includes("(P0)")||v.match(/^\d+\s*\([P]\d+\)$/))){i.Info("üö´ TrendLogChart: Filtering out explicit demo data (demo pattern)",{inputItem:e,potentialSeriesName:v,reason:'Series name matches demo data pattern like "1 (P0)" or contains (P0)'});continue}const m=0===d?"digital":"analog",g=p,h=`${r.category} - ${p}`;i.Debug(`‚úÖ TrendLogChart: Including real T3000 data series: "${g}"`,{panelId:t,pointType:a,pointNumber:n,unitType:m,hasDescription:!!p});const f=`${t}${r.category}${n+1}`,y=`${r.category}${n+1}`,b={name:g,color:Ae[s.length%Ae.length],data:[],visible:!0,unit:c,isEmpty:!1,unitType:m,unitCode:o[u],itemType:f,prefix:r.category,description:h,pointType:a,pointNumber:n,panelId:t,id:y};s.push(b)}return i.Info("üìä TrendLogChart: Generated series with filtering",{totalInputItems:r,validSeriesCount:s.length,filteredOut:r-s.length}),s})(),t=new Map;Le.value.forEach((e=>{const a=`${e.id}_${e.panelId}`;t.set(a,e)}));const a=e.map((e=>{const a=`${e.id}_${e.panelId}`,n=t.get(a);if(n){return n.name!==e.name||n.unitType!==e.unitType||n.unitCode!==e.unitCode||n.pointType!==e.pointType||n.description!==e.description?{...e,data:n.data||[],visible:n.visible,color:n.color||e.color}:{...n,color:n.color||e.color}}return{...e,data:[],visible:!0}}));e.length,Le.value.filter((t=>e.some((e=>e.id===t.id&&e.panelId===t.panelId)))).length,Le.value.length,e.filter((e=>Le.value.some((t=>t.id===e.id&&t.panelId===e.panelId)))).length,Le.value=a};n(X,(e=>{e&&Re()}),{immediate:!0,deep:!0}),n(Le,((e,t)=>{}),{deep:!0}),n((()=>Z.itemData),((e,t)=>{}),{deep:!0}),n((()=>{var e;return null==(e=O.value)?void 0:e.panelsData}),((e,t)=>{var a;if(e&&e.length>0){X.value&&Re();const t=e.flat();if(Ha(t),se.value&&t.length>0&&(null==(a=Le.value)?void 0:a.length)>0){const e=Le.value.map((e=>({id:e.id,panelId:e.panelId,pointType:e.pointType,pointNumber:e.pointNumber,seriesName:e.name}))).filter((e=>e.id&&e.panelId)),a=t.filter((t=>t&&"object"==typeof t&&t.hasOwnProperty("value")&&null!==t.value&&void 0!==t.value&&t.id&&e.some((e=>t.id===e.id&&t.pid===e.panelId))));Na(t.length,a.length,Le.value.length),a.length>0?Pa(a):i.Warn("‚ö†Ô∏è No chart-relevant items found for storage",{totalItems:t.length,chartSeriesCount:Le.value.length,sampleTotalItem:t[0],sampleChartSeries:e[0]})}}}),{deep:!0}),n(E,((e,t)=>{}),{deep:!0}),n(ee,(async(e,t)=>{i.Info("= TLChart: timeBase changed - Data Loading with Auto Scroll State Preserved",{oldTimeBase:t,newTimeBase:e,autoScrollState:se.value,timestamp:(new Date).toISOString()});try{pe.value=!0,Le.value.forEach((e=>{e.data=[]})),se.value?(i.Info(`üìä ${e} timebase: Auto Scroll ON - Loading real-time + historical data`),await Ea(),await ka(),jt||(i.Info(`üîÑ Starting real-time updates for ${e} timebase`),sn())):(i.Info(`üìö ${e} timebase: Auto Scroll OFF - Loading historical data only`),await ka()),i.Info("üé® Updating charts with loaded data",{totalSeries:Le.value.length,seriesWithData:Le.value.filter((e=>e.data.length>0)).length,autoScrollEnabled:se.value}),await u(),Le.value=[...Le.value],setTimeout((()=>{i.Info("üé® Executing delayed chart update after timebase data load"),Ya()}),100)}catch(a){i.Error("Error loading data for new timebase:",a)}finally{pe.value=!1}i.Info("‚úÖ Timebase change completed",{newTimeBase:e,autoScrollState:se.value,dataSeriesCount:Le.value.length,totalDataPoints:Le.value.reduce(((e,t)=>e+t.data.length),0)})}),{immediate:!1}),n((()=>{var e;return null==(e=O.value)?void 0:e.panelsList}),(async(e,t)=>{const a=e&&e.length>0?e[0].sn:null,n=t&&t.length>0?t[0].sn:null,l=e&&e.length>0?e[0].panel_number:null,o=t&&t.length>0?t[0].panel_number:null;if(a&&n&&a!==n||l&&o&&l!==o){i.Info("üîÑ Device changed - Reloading historical data",{oldSN:n,newSN:a,oldPanelId:o,newPanelId:l,serialChanged:a!==n,panelChanged:l!==o,timestamp:(new Date).toISOString()});try{pe.value=!0,Le.value.forEach((e=>{e.data=[]})),await ka(),Ya()}catch(r){i.Error("Error loading historical data for new device:",r)}finally{pe.value=!1}}}),{deep:!0,immediate:!1});const Me=e=>({"5m":{stepMinutes:1,unit:"minute"},"10m":{stepMinutes:2,unit:"minute"},"30m":{stepMinutes:5,unit:"minute"},"1h":{stepMinutes:10,unit:"minute"},"4h":{stepMinutes:30,unit:"minute"},"12h":{stepMinutes:60,unit:"hour"},"1d":{stepMinutes:120,unit:"hour"},"4d":{stepMinutes:480,unit:"hour"}}[e]||{stepMinutes:10,unit:"minute"}),$t=(e,t,a)=>{const n=new Date(e),i=Fa(ee.value)>1440,l=()=>`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getDate().toString().padStart(2,"0")} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`,o=()=>`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`,r=0===t,s=t===a.length-1;return i?r||s?l():o():r?l():o()};o((()=>{const e=(()=>{var e,t,a,n;const i=60*((null==(t=null==(e=Z.itemData)?void 0:e.t3Entry)?void 0:t.minute_interval_time)||0)+((null==(n=null==(a=Z.itemData)?void 0:a.t3Entry)?void 0:n.second_interval_time)||0);return i>0?i:60*ba(ee.value)})();return{internalSec:e,roundedSec:(e=>{if(e<=5)return 5;if(e<=10)return 10;if(e<=15)return 15;if(e<=20)return 20;if(e<=30)return 30;if(e<=60)return 60;const t=e/60;return t<=5?300:t<=10?600:t<=15?900:t<=20?1200:t<=30?1800:60*Math.round(t/60)*60})(e)}})),a();const Pt=a(),Nt=a([]);let Ht=null,Ft={},jt=null;const Ut=o((()=>{var e,t,a,n,i;return Z.title||(null==(t=null==(e=Z.itemData)?void 0:e.t3Entry)?void 0:t.description)||(null==(n=null==(a=Z.itemData)?void 0:a.t3Entry)?void 0:n.label)||(null==(i=Z.itemData)?void 0:i.title)||"Trend Log Chart"}));o((()=>Le.value.reduce(((e,t)=>e+t.data.length),0)));const zt=o((()=>Le.value.filter((e=>e.visible)).length)),Bt=o((()=>({"5m":"Last 5 minutes","10m":"Last 10 minutes","30m":"Last 30 minutes","1h":"Last 1 hour","4h":"Last 4 hours","12h":"Last 12 hours","1d":"Last 1 day","4d":"Last 4 days"}[ee.value]||""))),Vt=["5m","10m","30m","1h","4h","12h","1d","4d"],Wt=o((()=>Vt.indexOf(ee.value)>0)),Yt=o((()=>{const e=Vt.indexOf(ee.value);return e>=0&&e<Vt.length-1})),qt=o((()=>Le.value.some((e=>e.visible)))),Gt=o((()=>Le.value.some((e=>!e.visible)))),Kt=o((()=>Le.value.filter((e=>"analog"===e.unitType)))),Jt=o((()=>Le.value.filter((e=>"digital"===e.unitType)))),Zt=o((()=>Le.value.filter((e=>2===e.pointType)))),Xt=o((()=>Le.value.filter((e=>1===e.pointType)))),Qt=o((()=>Le.value.filter((e=>3===e.pointType)))),ea=o((()=>Kt.value.length>0)),ta=o((()=>Jt.value.length>0)),aa=o((()=>Zt.value.length>0)),na=o((()=>Xt.value.length>0)),ia=o((()=>Qt.value.length>0)),la=o((()=>Kt.value.length)),oa=o((()=>Jt.value.length)),ra=o((()=>Zt.value.length)),sa=o((()=>Xt.value.length)),ua=o((()=>Qt.value.length)),da=o((()=>{var e,t;const a=null==(t=null==(e=Z.itemData)?void 0:e.t3Entry)?void 0:t.input;return a&&a.length>0&&0===Le.value.length})),ca=o((()=>pe.value||da.value)),pa=o((()=>Kt.value.length>0&&Kt.value.every((e=>e.visible)))),va=o((()=>Jt.value.length>0&&Jt.value.every((e=>e.visible)))),ma=o((()=>Zt.value.length>0&&Zt.value.every((e=>e.visible)))),ga=o((()=>Xt.value.length>0&&Xt.value.every((e=>e.visible)))),ha=o((()=>Qt.value.length>0&&Qt.value.every((e=>e.visible)))),fa=o((()=>Kt.value.filter((e=>e.visible)))),ya=o((()=>Jt.value.filter((e=>e.visible)))),ba=e=>({"5m":1,"10m":1,"30m":2,"1h":5,"4h":15,"12h":30,"1d":60,"4d":240}[e]||1),Da=()=>{const e=Le.value.filter((e=>e.visible)).flatMap((e=>e.data)).map((e=>e.timestamp));return 0===e.length?{min:void 0,max:void 0}:{min:Math.min(...e),max:Math.max(...e)}},wa={id:"yAxisUnits",afterDraw:e=>{const t=e.scales.y;if(!t)return;const a=e.ctx;a.save();const n=new Map,i=fa.value;if(i.forEach((e=>{e.unit&&!n.has(e.unit)&&n.set(e.unit,{color:e.color,count:0}),e.unit&&n.has(e.unit)&&n.get(e.unit).count++})),0===n.size)return void a.restore();const l=Array.from(n.keys());let o="",r=t.left;const s=e.chartArea.top-15;if(a.font="11px Inter, Helvetica, Arial, sans-serif",a.textAlign="left",a.textBaseline="middle",1===l.length){const e=l[0],t=n.get(e),u=i.length;a.fillStyle=t.color,o=t.count===u&&u>1?`${e} (${u} sensors)`:e,a.fillText(o,r,s)}else if(l.length<=3)l.forEach(((e,t)=>{const i=n.get(e);a.fillStyle=i.color,a.fillText(e,r,s);const o=a.measureText(e).width;r+=o,t<l.length-1&&(a.fillStyle="#666666",a.fillText(" | ",r,s),r+=a.measureText(" | ").width)}));else{for(let e=0;e<2;e++){const t=l[e],i=n.get(t);a.fillStyle=i.color,a.fillText(t,r,s);const o=a.measureText(t).width;r+=o,e<1&&(a.fillStyle="#666666",a.fillText(" | ",r,s),r+=a.measureText(" | ").width)}const t=l.length-2;a.fillStyle="#999999",a.fillText(` ... +${t} more`,r,s),e.fullUnitInfo=n}a.restore()}},Ia=a(0),_a=()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),0,0),a=new Date(t.getTime()+60*Ia.value*1e3),n=new Date(a.getTime()+6e4),i=Fa(ee.value);return{min:new Date(n.getTime()-60*i*1e3).getTime(),max:n.getTime()}},Ta=()=>{var e,t;return"ms-appx-web:"===window.location.protocol||void 0!==(null==(e=window.chrome)?void 0:e.webview)||void 0!==(null==(t=window.external)?void 0:t.sendMessage)?new x:A.WsClient},Sa=async()=>{var e,t,a,n,l;try{i.Info("üì° fetchRealTimeMonitorData: Starting data fetch",{hasMonitorConfig:!!Se.value,hasPanelsData:!!(null==(e=O.value.panelsData)?void 0:e.length),panelsDataLength:(null==(t=O.value.panelsData)?void 0:t.length)||0,timestamp:(new Date).toISOString()}),pe.value=!0;const o=Se.value;if(!o)return i.Error("‚ùå fetchRealTimeMonitorData: No monitor config available"),pe.value=!1,[];const r=O.value.panelsData||[];let s=!1;if(s=r.length>0||await(async(e=1e4)=>{const t=Date.now();for(;Date.now()-t<e;){if((O.value.panelsData||[]).length>0)return!0;await new Promise((e=>setTimeout(e,200)))}return!1})(5e3),!s)return i.Error("‚ùå fetchRealTimeMonitorData: Timeout waiting for panels data",{waitTimeout:"5000ms",currentPanelsDataLength:(null==(a=O.value.panelsData)?void 0:a.length)||0,T3000DataExists:!!O.value}),pe.value=!1,[];const u=Ta();if(i.Info("üîå fetchRealTimeMonitorData: Data client initialized",{hasDataClient:!!u,clientType:(null==(n=null==u?void 0:u.constructor)?void 0:n.name)||"unknown",isBuiltInBrowser:"ms-appx-web:"===window.location.protocol||void 0!==(null==(l=window.chrome)?void 0:l.webview)}),!u)return i.Error("‚ùå fetchRealTimeMonitorData: Failed to initialize data client"),[];const d=O.value.panelsList||[],c=d.length>0?d[0].panel_number:1,p=(O.value.panelsData||[]).filter((e=>String(e.pid)===String(c)));if(!p)return[];let v=p;if(!Array.isArray(v)||0===v.length)return[];return await Ca(u,o,{panelId:c,panelData:v})}catch(o){return[]}finally{pe.value=!1}},Ca=async(e,t,a)=>{var n;try{i.Info("üì¶ TrendLogChart: fetchAllItemsDataBatch called",{inputItemsCount:(null==(n=t.inputItems)?void 0:n.length)||0,panelId:a.panelId,timestamp:(new Date).toISOString()});const o=[],r=[];if(t.inputItems.forEach(((e,n)=>{const l=n,s=t.ranges[l]||0,u=Oa(e,a.panelData);if(u){const t=parseInt(u.index)||0,d=e.point_type;o.push({panelId:a.panelId,index:t,type:d}),r.push({inputItem:e,matchingDevice:u,rangeValue:s,itemIndex:l}),i.Info(`üì¶ Added item ${n} to batch request`,{deviceIndex:t,deviceType:d,panelId:a.panelId})}else i.Warn(`‚ö†Ô∏è No matching device found for item ${n}`),r.push(null)})),0===o.length)return i.Warn("‚ö†Ô∏è No valid items for batch request"),[];if(i.Info("üì° Sending BATCH GET_ENTRIES request",{itemCount:o.length,requestData:o}),e&&e.GetEntries)try{e.GetEntries(a.panelId,null,o),i.Info("ÔøΩ?BATCH GET_ENTRIES request sent successfully",{panelId:a.panelId,itemCount:o.length})}catch(l){i.Error("ÔøΩ?Error sending batch GET_ENTRIES request:",l)}const s=[];return r.forEach(((e,t)=>{if(e){const t=Ma(e.matchingDevice,e.rangeValue);s.push([{timestamp:Date.now(),value:t.value}])}else s.push([{timestamp:Date.now(),value:0}])})),s}catch(l){return i.Error("ÔøΩ?Error in fetchAllItemsDataBatch:",l),[]}},Ea=async()=>{var e,t;i.Info("üîß initializeRealDataSeries: Starting initialization",{hasMonitorConfig:!!Se.value,monitorConfigData:Se.value,hasPanelsData:!!(null==(e=O.value.panelsData)?void 0:e.length),panelsDataLength:(null==(t=O.value.panelsData)?void 0:t.length)||0,hasConnectionError:Ie.value,timestamp:(new Date).toISOString()});const a=Se.value;if(!a)return i.Warn("‚ùå initializeRealDataSeries: No monitor config available",{monitorConfig:Se.value,T3000DataExists:!!O.value,propsItemData:!!Z.itemData}),void(Le.value=[]);try{const e=await Sa();if(!e.some((e=>e.length>0)))return void(Le.value=[]);const t=[];for(let n=0;n<a.inputItems.length;n++){const l=a.inputItems[n],o=j(l.point_type),r=a.ranges[n]||0,s=e[n]||[],u=o.category,d=Ee(l.panel,l.point_type,l.point_number);if(0===s.length){i.Debug("üö´ Skipping item with no data:",{itemIndex:n,panel:l.panel,point_type:l.point_type,point_number:l.point_number,hasDescription:!!d});continue}const c=d||`${l.point_number+1} (P${l.panel})`,p=d||`${l.point_number+1}`,v=Oe(l.panel,l.point_type,l.point_number),m=0===v;let g,h;i.Info("= TLChart: Series generation - Digital/Analog analysis",{inputItemIndex:n,panelId:l.panel,pointType:l.point_type,pointNumber:l.point_number,digitalAnalog:v,isDigital:m}),m?(g="digital",h=W(l.panel,l.point_type,l.point_number)):(g="analog",h=W(l.panel,l.point_type,l.point_number)),i.Info("= TLChart: Series generation - Unit determination result",{unitType:g,unitSymbol:h});const f={name:c,color:`hsl(${360*t.length/a.inputItems.length}, 70%, 50%)`,data:s,visible:!0,isEmpty:!1,unit:h,unitType:g,unitCode:r,itemType:o.name,prefix:u,description:p,pointType:l.point_type,pointNumber:l.point_number,panelId:l.panel,id:Aa(l.point_type,l.point_number)};t.push(f)}i.Info("= TLChart: initializeRealDataSeries updating dataSeries",{previousSeriesCount:Le.value.length,newSeriesCount:t.length,newSeriesNames:t.map((e=>e.name)),timestamp:(new Date).toISOString()}),Le.value.length>0&&(i.Info("üîÑ Preserving existing historical data while updating series structure",{existingSeriesCount:Le.value.length,existingDataPoints:Le.value.reduce(((e,t)=>{var a;return e+((null==(a=t.data)?void 0:a.length)||0)}),0)}),t.forEach((e=>{const t=Le.value.find((t=>t.id===e.id));t&&t.data&&t.data.length>0&&(e.data=t.data,i.Info(`üìà Preserved ${t.data.length} historical data points for ${e.name}`,{seriesId:e.id,timeRange:t.data.length>0?{first:new Date(t.data[0].timestamp).toISOString(),last:new Date(t.data[t.data.length-1].timestamp).toISOString()}:null}))}))),Le.value=t,ye.value=(new Date).toLocaleTimeString()}catch(n){i.Error("= TLChart: Error initializing real data series:",n),i.Warn("= TLChart: Keeping loading state - data might still be loading"),Le.value=[]}},Oa=(e,t)=>{const a=Aa(e.point_type,e.point_number),n=t.find((e=>e.id===a));return n||(i.Warn("= TLChart: Device not found in panelsData",{deviceId:a}),null)},xa=e=>e>=1e3?e/1e3:e,Aa=(e,t)=>`${La(e)}${t+1}`,La=e=>{switch(e-1){case 0:return"OUT";case 1:return"IN";case 2:return"VAR";case 3:return"PID";case 4:return"SCH";case 5:return"HOL";case 6:return"PRG";case 7:return"TBL";case 8:return"DMON";case 9:return"AMON";case 10:return"GRP";case 11:return"AY";case 12:return"ALARMM";case 13:return"UNIT";case 14:return"USER_NAME";case 15:return"ALARMS";case 16:return"WR_TIME";case 17:return"AR_Y";default:return""}},Ra=e=>{switch(e-1){case 0:return"OUTPUT";case 1:return"INPUT";case 2:return"VARIABLE";case 3:return"PID";case 4:return"SCHEDULE";case 5:return"HOLIDAY";case 6:return"PROGRAM";case 7:return"TABLE";case 8:return"DMON";case 9:return"AMON";case 10:return"GROUP";case 11:return"ARRAY";case 12:return"ALARMM";case 13:return"UNIT";case 14:return"USER_NAME";case 15:return"ALARMS";case 16:return"WR_TIME";case 17:return"AR_Y";default:return"UNKNOWN"}},Ma=(e,t)=>{const a=((e,t)=>{if(e&&void 0!==e.digital_analog)return 1===e.digital_analog;const a=0===t;return e&&e.control,a})(e,t),n=((e,t)=>{let a;if(t)a=xa(parseFloat(e.value)||0);else if("OUT1"===e.id||"OUT2"===e.id){const t=xa(parseFloat(e.control)||0),n=xa(parseFloat(e.value)||0),i=xa(parseFloat(e.auto_manual)||0);a=n>0?n:i>0?i:t}else a=xa(parseFloat(e.control)||0);return a})(e,a);if(a){let t;t=n>1e3?n/1e3:n;const a=((e,t)=>{if(t){const a=t.toLowerCase();if($e.analog[a]){const t=$e.analog[a].find((t=>t.id===e));if(t)return t.unit}}return L(e)})(e.range,e.type);return{value:t,displayValue:`${t.toFixed(2)}`,unit:a}}{const t=q(e.range);return{value:n,displayValue:n>0?`1 (${t[1]})`:`0 (${t[0]})`,unit:""}}},ka=async()=>{var e,t;try{const a=O.value.panelsList||[],n=a.length>0?a[0].panel_number:1,l=a.length>0?a[0].serial_number:0;if(!l)return void i.Debug("No serial number available for historical data loading");const o=Se.value;if(!(null==(e=null==o?void 0:o.inputItems)?void 0:e.length))return void i.Debug("No monitor configuration available for historical data loading");const r=Fa(ee.value),s=new Date,u=new Date(s.getTime()+60*Ia.value*1e3),d=new Date(u.getTime()-60*r*1e3),c=u,p=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`,v=p(d),m=p(c);let g=[];Le.value&&Le.value.length>0&&Le.value.forEach(((e,t)=>{if(e.id&&"1"!==e.id&&e.name&&!e.name.includes("(P0)")&&!e.name.match(/^\d+\s*\([P]\d+\)$/)&&e.description){let a="VARIABLE",i=t,l=e.id;if(e.id.startsWith("VAR")){a="VARIABLE";const n=e.id.match(/VAR(\d+)/);i=n?parseInt(n[1])-1:t,l=e.id}else if(e.id.startsWith("IN")){a="INPUT";const n=e.id.match(/IN(\d+)/);i=n?parseInt(n[1])-1:t,l=e.id}else if(e.id.startsWith("OUT")){a="OUTPUT";const n=e.id.match(/OUT(\d+)/);i=n?parseInt(n[1])-1:t,l=e.id}g.push({point_id:l,point_type:a,point_index:i,panel_id:n})}})),0===g.length&&(i.Warn("No valid data series found, using minimal working point set"),g=[{point_id:"VAR1",point_type:"VARIABLE",point_index:0,panel_id:n},{point_id:"VAR3",point_type:"VARIABLE",point_index:2,panel_id:n}]);let h="1";if(o.id&&"string"==typeof o.id){const e=o.id.match(/MON(\d+)|TRL(\d+)/i);if(e){h=(parseInt(e[1]||e[2])-1).toString()}}i.Debug("üîç Trendlog ID extraction for historical data request:",{originalId:o.id,extractedId:h,willUseUrl:`/trendlogs/${h}/history`});const f=r/60,y=12,b=Math.ceil(f*y*g.length),D=Math.max(200,1.5*b),w={serial_number:l,panel_id:n,trendlog_id:h,start_time:v,end_time:m,limit:D,point_types:["INPUT","OUTPUT","VARIABLE","MONITOR"],specific_points:g};i.Debug("üîç Historical data request:",{timeRange:`${v} to ${m}`,timeRangeMinutes:r,pointsCount:g.length,limit:w.limit,trendlogId:h});const I=await De.getTrendlogHistory(w);(null==(t=null==I?void 0:I.data)?void 0:t.length)>0?(i.Info("üìö Historical data loaded:",{dataPointsCount:I.data.length,timeRange:`${r} minutes`}),$a(I.data)):i.Debug("üì≠ No historical data found for current timebase")}catch(a){i.Error("Failed to load historical data from database:",a)}},$a=e=>{try{const t=new Map;e.forEach((e=>{const a=`${e.point_id}_${e.point_type}`;t.has(a)||t.set(a,[]),t.get(a).push(e)})),i.Info("üîç Starting historical data population",{totalHistoricalItems:e.length,availableDataSeries:Le.value.length,seriesIds:Le.value.map((e=>e.id)),dataGroupKeys:Array.from(t.keys())}),Le.value.forEach(((e,a)=>{var n;const l=`${e.id}_${Ra(e.pointType||1)}`,o=t.get(l)||[];if(i.Debug(`üìä Processing series ${a}: ${e.name}`,{seriesId:e.id,seriesKey:l,pointType:e.pointType,mappedPointType:Ra(e.pointType||1),historicalDataCount:o.length,currentDataCount:(null==(n=e.data)?void 0:n.length)||0}),o.length>0){const t=o.map((e=>({timestamp:new Date(e.time).getTime(),value:parseFloat(e.value)||0,id:e.point_id,type:e.point_type,digital_analog:e.digital_analog||1,description:`Historical: ${e.point_id}`}))).sort(((e,t)=>e.timestamp-t.timestamp));e.data=t,i.Info(`üìà Successfully loaded ${t.length} historical points for ${e.name}`,{seriesIndex:a,timeRange:t.length>0?{first:new Date(t[0].timestamp).toISOString(),last:new Date(t[t.length-1].timestamp).toISOString()}:null})}else i.Warn(`üì≠ No historical data found for series: ${e.name}`,{seriesKey:l,availableKeys:Array.from(t.keys())})})),i.Info("üìä Historical data population completed",{seriesWithData:Le.value.filter((e=>e.data.length>0)).length,totalSeries:Le.value.length})}catch(t){i.Error("Error populating data series with historical data:",t)}},Pa=async e=>{try{i.Info("üîÑ storeRealtimeDataToDatabase called",{itemsCount:e.length,timestamp:(new Date).toISOString(),sampleItems:e.slice(0,2)});const t=O.value.panelsList||[],a=t.length>0?t[0].panel_number:1,n=t.length>0?t[0].serial_number:0;if(i.Info("üìä Device info for storage",{panelsListLength:t.length,currentPanelId:a,currentSN:n,hasPanelsList:!!t.length}),!n)return void i.Warn("‚ùå No serial number available for data storage",{panelsList:t.slice(0,2),T3000DataExists:!!O.value});const l=e.map((e=>{var t,l,o,r,s,u,d,c,p;const v=e.id||"UNKNOWN",m=((e,t)=>e.startsWith("IN")?"INPUT":e.startsWith("OUT")?"OUTPUT":e.startsWith("VAR")?"VARIABLE":e.startsWith("PID")?"PID":e.startsWith("SCH")?"SCHEDULE":e.startsWith("HOL")?"HOLIDAY":e.startsWith("PRG")?"PROGRAM":e.startsWith("TBL")?"TABLE":t?Ra(t):"INPUT")(v,e.point_type),g=(e=>{const t=e.match(/(\d+)$/);return t?parseInt(t[1],10):0})(v),h=((e,t)=>{const a=Le.value.find((e=>e.id===t));return(null==a?void 0:a.unit)?a.unit:e.units||void 0})(e,v),f=(()=>{var e;let t=null,a="fallback";if(Se.value?(t=Se.value,a="monitorConfig"):(null==(e=Z.itemData)?void 0:e.t3Entry)&&(t=Z.itemData.t3Entry,a="itemData.t3Entry"),t){const e=t.hour_interval_time||0,n=t.minute_interval_time||0,l=t.second_interval_time||0,o=3600*e+60*n+l,r=o>0?Math.max(o,15):60;return i.Debug("üïê Calculating sync interval from T3000 config",{dataSource:a,hourInterval:e,minuteInterval:n,secondInterval:l,totalSeconds:o,syncIntervalSeconds:r,timeBase:ee.value,configExists:!!t}),r}const n=ce.value,l=Math.round(n/1e3);return i.Debug("üïê Using fallback sync interval calculation",{dataSource:"updateInterval computed",fallbackMs:n,fallbackSeconds:l,timeBase:ee.value}),l})();return i.Debug("üîß Processing item for database storage",{pointId:v,rawPointType:e.point_type,mappedPointType:m,calculatedIndex:g,rawIndex:e.index,rawValue:e.value,rawUnits:e.units,calculatedUnits:h,digitalAnalog:e.digital_analog,range:e.range,syncInterval:f,timeBase:ee.value,t3000Intervals:{hour:(null==(t=Se.value)?void 0:t.hour_interval_time)||(null==(o=null==(l=Z.itemData)?void 0:l.t3Entry)?void 0:o.hour_interval_time)||0,minute:(null==(r=Se.value)?void 0:r.minute_interval_time)||(null==(u=null==(s=Z.itemData)?void 0:s.t3Entry)?void 0:u.minute_interval_time)||0,second:(null==(d=Se.value)?void 0:d.second_interval_time)||(null==(p=null==(c=Z.itemData)?void 0:c.t3Entry)?void 0:p.second_interval_time)||0}}),{serial_number:n,panel_id:e.pid||a,point_id:v,point_index:g,point_type:m,value:String(e.value||0),range_field:e.range?String(e.range):void 0,digital_analog:e.digital_analog?String(e.digital_analog):void 0,units:h,data_source:"REALTIME",created_by:"FRONTEND",sync_interval:f}}));if(l.length>0){i.Info("üì§ Sending real-time batch to API",{pointsCount:l.length,serialNumber:n,apiEndpoint:"localhost:9103/api/trendlog/realtime/batch",sampleDataPoint:l[0],detailedDataPoints:l.map((e=>({point_id:e.point_id,panel_id:e.panel_id,point_index:e.point_index,point_type:e.point_type,value:e.value,digital_analog:e.digital_analog,units:e.units,range_field:e.range_field,data_source:e.data_source,created_by:e.created_by,sync_interval:e.sync_interval})))});const e=await De.saveRealtimeBatch(l);i.Info(`‚úÖ Successfully stored ${e} real-time data points`,{pointsCount:l.length,rowsAffected:e,serialNumber:n,timestamp:(new Date).toISOString(),success:e>0})}else i.Warn("‚ö†Ô∏è No valid data points to store",{originalItemsCount:e.length,serialNumber:n})}catch(t){i.Error("Failed to store real-time data to database:",t)}},Na=(e,t,a)=>{i.Info("üîç Filtering validation results",{originalDataCount:e,filteredDataCount:t,chartSeriesCount:a,reductionRatio:t>0?`${(t/e*100).toFixed(1)}%`:"0%",expectedRange:`‚â§ ${a} items`,isReasonableFilter:t>0&&t<=a&&t<e,message:0===t?"No matches found - check filtering logic":t>a?"More items than chart series - check filtering logic":t===e?"No filtering occurred - check filtering logic":"Filtering working correctly"})},Ha=e=>{var t,a;if(!(null==(t=Le.value)?void 0:t.length)||!Array.isArray(e)||!e.length)return void i.Debug("üìà TrendLogChart: No data to process",{hasSeriesConfig:!!(null==(a=Le.value)?void 0:a.length),dataItemsCount:(null==e?void 0:e.length)||0});const n=new Date;let l=0,o=0;Le.value.forEach(((t,a)=>{if(!t.id||!t.panelId)return i.Debug(`‚ö†Ô∏è Series ${a} missing id or panelId`,{seriesName:t.name,hasId:!!t.id,hasPanelId:!!t.panelId}),void o++;const r=e.find((e=>e.id===t.id&&e.pid===t.panelId));if(!r)return i.Debug(`No match found for series ${t.name}`,{searchingFor:{id:t.id,panelId:t.panelId},seriesIndex:a}),void o++;let s;s=1===r.digital_analog?r.value:r.control;const u=s||0,d=xa(u);u>=1e3&&i.Info(`üîç Value Scaling Analysis for ${t.name}`,{rawValue:u,scaledValue:d,precisionLoss:u-1e3*d,seriesName:t.name,note:"Large values scaled down - check for precision loss"});const c={timestamp:n.getTime(),value:d,id:r.id,type:r.type,digital_analog:r.digital_analog||1,description:r.description||r.label||`Point ${r.id}`};t.data=t.data||[];const p=t.data.findIndex((e=>Math.abs(e.timestamp-c.timestamp)<1e3));p>=0?t.data[p]=c:(t.data.push(c),t.data.sort(((e,t)=>e.timestamp-t.timestamp))),t.data.length>200&&(t.data=t.data.slice(-200)),r.description&&!t.description&&(t.description=r.description),r.label&&t.name===t.description&&(t.name=r.label),l++,i.Debug(`‚úÖ Matched series ${t.name}`,{matchedItem:{id:r.id,pid:r.pid,digital_analog:r.digital_analog,rawValue:1===r.digital_analog?r.value:r.control,scaledValue:s}})})),i.Debug("üìä TrendLogChart: Data processing complete",{matched:l,unmatched:o,totalSeries:Le.value,validDataItems:e}),Ht||Object.keys(Ft).length>0?Ya():i.Debug("‚ö†Ô∏è Chart instances not available for update")},Fa=e=>({"5m":5,"10m":10,"30m":30,"1h":60,"4h":240,"12h":720,"1d":1440,"4d":5760}[e]||60),ja=async()=>{var e,t,a,n;i.Info("= TLChart: Starting hybrid data initialization (DB + real-time)",{currentDataSeriesLength:Le.value.length,hasMonitorConfig:!!Se.value,timeBase:ee.value}),we.value="realtime";const l=Se.value;if(l&&l.inputItems&&l.inputItems.length>0)try{pe.value=!0,i.Info("üìö Loading historical data from database for current timebase"),await ka(),i.Info("üì° Starting real-time data monitoring"),await Ea(),Ya(),u((()=>{Ya()})),pe.value=!1}catch(o){i.Error("= TLChart: Error in hybrid data initialization:",o),Ie.value=!0,Le.value=[],pe.value=!1}else i.Info("üìä Empty State Configuration:",{configExists:!!l,hasInputItems:!!(null==l?void 0:l.inputItems),inputItemsLength:(null==(e=null==l?void 0:l.inputItems)?void 0:e.length)||0,scheduleDataExists:!!X.value,scheduleId:null==(a=null==(t=X.value)?void 0:t.t3Entry)?void 0:a.id,panelsDataLength:(null==(n=O.value.panelsData)?void 0:n.length)||0,dataType:"NO_DATA_AVAILABLE"}),Ie.value=!0,Le.value=[],pe.value=!1;0!==Le.value.length?Ie.value?i.Info("üìä TrendLogChart: Skipping data generation - connection error (should show empty chart)"):(i.Info("üìä TrendLogChart: Mock/demo data generation removed - chart will only show real data"),Ya()):i.Info("üìä TrendLogChart: No data series available - maintaining empty state",{dataSeriesLength:Le.value.length,hasMonitorConfig:!!Se.value})},Ua=async()=>{if(i.Info("üîÑ addRealtimeDataPoint CALLED",{isRealTime:se.value,dataSeriesLength:Le.value.length,hasMonitorConfig:!!Se.value,timestamp:(new Date).toISOString()}),!se.value)return void i.Warn("‚ùå addRealtimeDataPoint: Not in real-time mode");if(0===Le.value.length)return void i.Warn("‚ùå addRealtimeDataPoint: No data series exist");const e=Se.value;if(e)if(e.inputItems&&0!==e.inputItems.length){try{i.Info("üì° addRealtimeDataPoint: About to send batch request"),await(async e=>{var t;i.Info("üöÄ sendPeriodicBatchRequest CALLED",{hasMonitorConfig:!!e,inputItemsCount:(null==(t=null==e?void 0:e.inputItems)?void 0:t.length)||0,timestamp:(new Date).toISOString()});try{const t=O.value.panelsList||[],a=t.length>0?t[0].panel_number:1,n=(O.value.panelsData||[]).filter((e=>String(e.pid)===String(a)));if(!n||0===n.length)return void i.Debug("GET_ENTRIES Batch Request -> No panel data available");const l=Ta();if(!l)return void i.Debug("GET_ENTRIES Batch Request -> No data client available");const o=[];if(e.inputItems.forEach(((e,t)=>{const i=Oa(e,n);var l;i&&o.push({panelId:a,index:parseInt(i.index)||0,type:(l=e.point_type,l-1)})})),i.Debug("GET_ENTRIES Batch Request -> Sending periodic batch:",{itemCount:o.length,panelId:a,batchSample:o.slice(0,3),timestamp:(new Date).toISOString(),monitorConfigData:e}),0===o.length)return void i.Debug("GET_ENTRIES Batch Request -> No valid items for batch request");l.GetEntries?(i.Info("üì° Sending GET_ENTRIES request",{panelId:a,itemCount:o.length,timestamp:(new Date).toISOString()}),l.GetEntries(a,null,o)):i.Error("GET_ENTRIES Batch Request -> ERROR: GetEntries method not available")}catch(a){i.Error("GET_ENTRIES Batch Request -> ERROR in sendBatchGetEntriesRequest:",a)}})(e),ye.value=(new Date).toLocaleTimeString(),Ie.value&&(i.Info("TrendLogChart: Auto-recovering from connection error - batch request sent successfully"),Ie.value=!1)}catch(t){i.Warn("TrendLogChart: Failed to send batch request, setting connection error:",t),Ie.value=!0}Ya()}else i.Warn("‚ùå addRealtimeDataPoint: No input items in monitor config");else i.Warn("‚ùå addRealtimeDataPoint: No monitor config data")},za=()=>{Ba(),Va()},Ba=()=>{if(!Pt.value)return;if(0===Pt.value.offsetWidth||0===Pt.value.offsetHeight)return void setTimeout((()=>Ba()),100);const e=Pt.value.getContext("2d");if(e)try{Ht&&Ht.destroy();Ht=new C(e,{type:"line",data:{datasets:[]},plugins:[wa],options:{responsive:!0,maintainAspectRatio:!1,animation:!1,elements:{line:{borderWidth:2,skipNull:!1}},layout:{padding:{left:10,right:20,top:10,bottom:10}},interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"top",labels:{color:"#000000",font:{size:11,family:"Inter, Helvetica, Arial, sans-serif"},usePointStyle:!1,boxWidth:2,boxHeight:12}},tooltip:{backgroundColor:"#ffffff",titleColor:"#000000",bodyColor:"#000000",borderColor:"#d9d9d9",borderWidth:1,cornerRadius:4,displayColors:!0,usePointStyle:!0,callbacks:{title:e=>{const t=e[0].parsed.x;return"number"==typeof t&&t>1e9?J(t):new Date(t).toLocaleString()},label:e=>{const t=fa.value.find((t=>t.name===e.dataset.label));if(!t)return`${e.dataset.label}: ${e.parsed.y}`;const a=t.description||t.prefix||e.dataset.label,n=t.unit||"";return`${a}: ${e.parsed.y.toFixed(2)} ${n}`}}}},scales:{x:{type:"time",display:!0,grid:{color:"#e0e0e0",display:!0,lineWidth:1},ticks:{color:"#595959",font:{size:11,family:"Inter, Helvetica, Arial, sans-serif"},maxRotation:0,minRotation:0,maxTicksLimit:14,autoSkip:!1,callback:$t}},y:{grid:{color:"#e0e0e0",display:!0,lineWidth:1},ticks:{color:"#595959",font:{size:11,family:"Inter, Helvetica, Arial, sans-serif"},padding:8,callback:function(e){return Number(e).toFixed(2)}},afterDataLimits:function(e){const t=e.chart.data.datasets;if(0===t.length)return;const a=[];if(t.forEach((e=>{e.data&&e.data.length>0&&e.data.forEach((e=>{e&&"number"==typeof e.y&&a.push(e.y)}))})),0===a.length)return;const n=Math.min(...a),i=Math.max(...a),l=i-n;if(l>0&&l<2){const t=(n+i)/2,a=Math.max(2*l,1);e.min=t-a/2,e.max=t+a/2}}}}}})}catch(t){}},Va=()=>{Object.values(Ft).forEach((e=>{e.destroy()})),Ft={},ya.value.forEach(((e,t)=>{const a=Nt.value[t];if(!a)return;const n=a.getContext("2d");if(n)try{const a=((e,t=!1)=>{const a=q(e.unitCode||1);return{type:"line",data:{datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,animation:!1,elements:{line:{borderWidth:2,skipNull:!1}},layout:{padding:{left:10,right:20,top:5,bottom:5}},interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!1},tooltip:{backgroundColor:"#ffffff",titleColor:"#000000",bodyColor:"#000000",borderColor:"#d9d9d9",borderWidth:1,cornerRadius:4,displayColors:!0,usePointStyle:!0,callbacks:{title:e=>{const t=e[0].parsed.x;return"number"==typeof t&&t>1e9?J(t):new Date(t).toLocaleString()},label:t=>{const n=1===t.parsed.y?1:0,i=a[n];return`${e.name}: ${i}`}}}},scales:{x:{type:"time",display:!0,grid:{color:"#e0e0e0",display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0},ticks:{display:!0,color:t?"#595959":"transparent",font:{size:10,family:"Inter, Helvetica, Arial, sans-serif"},maxRotation:0,minRotation:0,callback:$t}},y:{min:-.5,max:1.5,display:!0,grid:{color:"#F0F0F0",display:!0,lineWidth:.3},ticks:{display:!0,color:"#595959",font:{size:8,family:"Inter, Helvetica, Arial, sans-serif"},padding:5,maxTicksLimit:2,callback:function(e){return e>.5?a[1]:a[0]}}}}}}})(e,t===ya.value.length-1);Ft[t]=new C(n,a)}catch(i){}}))},Wa=()=>{Ht&&(Ht.destroy(),Ht=null),Object.values(Ft).forEach((e=>{e.destroy()})),Ft={}},Ya=()=>{i.Info("üé® updateCharts: Starting chart updates",{hasAnalogChart:!!Ht,digitalChartsCount:Object.keys(Ft).length,totalDataSeries:Le.value.length,seriesWithData:Le.value.filter((e=>e.data.length>0)).length}),qa(),Ga(),i.Info("üé® updateCharts: Chart updates completed")},qa=()=>{var e,t;if(!Ht)return void i.Debug("üìä updateAnalogChart: No analog chart instance available");const a=fa.value.filter((e=>e.data.length>0));if(i.Info("üìä updateAnalogChart: Processing analog series",{totalVisibleSeries:fa.value.length,seriesWithData:a.length,seriesDetails:fa.value.map((e=>({name:e.name,id:e.id,dataCount:e.data.length,visible:e.visible})))}),Ht.data.datasets=a.map((e=>{const t=e.data.slice().sort(((e,t)=>e.timestamp-t.timestamp)).map((e=>({x:e.timestamp,y:e.value})));return{label:e.name,data:t,borderColor:e.color,backgroundColor:e.color+"20",borderWidth:2,fill:!1,tension:he.value?.4:0,pointRadius:fe.value?3:0,pointHoverRadius:6,pointBackgroundColor:e.color,pointBorderColor:"#fff",pointBorderWidth:2,pointStyle:"circle",spanGaps:!1}})),null==(e=Ht.options.scales)?void 0:e.x){const e=Ht.options.scales.x,t=Me(ee.value),a=(ee.value,"yyyy-MM-dd HH:mm");e.time={unit:t.unit,stepSize:t.stepMinutes,displayFormats:{minute:a,hour:a,day:"yyyy-MM-dd HH:mm"},minUnit:"second"};const n={"5m":6,"10m":6,"30m":7,"1h":7,"4h":9,"12h":13,"1d":13,"4d":13};e.ticks={...e.ticks,maxTicksLimit:n[ee.value]||7,maxRotation:0,minRotation:0,callback:$t,includeBounds:!0},e.grid={color:ve.value?"#e0e0e0":"transparent",display:ve.value,lineWidth:1};const i=_a();e.min=i.min,e.max=i.max}if(null==(t=Ht.options.scales)?void 0:t.y){Ht.options.scales.y.grid={color:ve.value?"#e0e0e0":"transparent",display:ve.value,lineWidth:1}}Ht.update("none")},Ga=()=>{ya.value.forEach(((e,t)=>{var a;const n=Ft[t];if(!n||0===e.data.length)return;const i=e.data.slice().sort(((e,t)=>e.timestamp-t.timestamp)).map((e=>({x:e.timestamp,y:e.value>.5?1.2:.2})));if(n.data.datasets=[{label:e.name,data:i,borderColor:e.color,backgroundColor:"transparent",borderWidth:2,fill:!1,stepped:"middle",pointRadius:0,pointHoverRadius:4,spanGaps:!1}],null==(a=n.options.scales)?void 0:a.x){const e=n.options.scales.x,t=Me(ee.value),a=(ee.value,"yyyy-MM-dd HH:mm");e.time={unit:t.unit,stepSize:t.stepMinutes,displayFormats:{minute:a,hour:a,day:"yyyy-MM-dd HH:mm"},minUnit:"second"};const i={"5m":6,"10m":6,"30m":7,"1h":7,"4h":9,"12h":13,"1d":13,"4d":13};e.ticks={...e.ticks,maxTicksLimit:i[ee.value]||7,maxRotation:0,minRotation:0,callback:$t,includeBounds:!0},e.grid={color:ve.value?"#e0e0e0":"transparent",display:ve.value,lineWidth:.5};const l=_a();e.min=l.min,e.max=l.max}n.update("none")}))},Ka=async()=>{if(se.value)return;const e=Fa(ee.value);Ia.value-=e,await ja()},Ja=async()=>{if(se.value)return;const e=Fa(ee.value);Ia.value+=e,await ja()},Za=()=>{const e=Vt.indexOf(ee.value);if(e>0){const t=Vt[e-1];ee.value=t,i.Info(`üîç Zoom In: Changed timebase to ${t}`,{autoScrollState:se.value,note:"Auto Scroll state unchanged by zoom operation"}),se.value?ja():rn()}},Xa=()=>{const e=Vt.indexOf(ee.value);if(e>=0&&e<Vt.length-1){const t=Vt[e+1];ee.value=t,i.Info(`üîç Zoom Out: Changed timebase to ${t}`,{autoScrollState:se.value,note:"Auto Scroll state unchanged by zoom operation"}),se.value?ja():rn()}},Qa=()=>{ee.value="5m",Ia.value=0,i.Info("üîÑ Reset to default timebase (5m)",{autoScrollState:se.value,note:"Auto Scroll state preserved during reset"}),se.value?ja():rn()},en=e=>{te.value=e;const t={1:{showGrid:!0,showLegend:!1,smoothLines:!1,showPoints:!1,title:"Standard View",description:"Grid lines enabled for comprehensive data analysis"},2:{showGrid:!1,showLegend:!1,smoothLines:!0,showPoints:!1,title:"Clean View",description:"Minimalist display with smooth lines for focused viewing"},3:{showGrid:!0,showLegend:!1,smoothLines:!0,showPoints:!1,title:"Detailed View",description:"All features enabled for maximum data visualization detail"}}[e];t&&(ve.value=t.showGrid,ge.value=t.showLegend,he.value=t.smoothLines,fe.value=t.showPoints,(Ht||Object.keys(Ft).length>0)&&(Wa(),za()))},tn=()=>{if(ae.value&&ne.value&&le.value&&oe.value){const e=ae.value.hour(le.value.hour()).minute(le.value.minute()).second(0).millisecond(0),t=ne.value.hour(oe.value.hour()).minute(oe.value.minute()).second(0).millisecond(0);if(t.isBefore(e))return void z.error("End time must be after start time");ae.value=e,ne.value=t,ee.value="custom",se.value=!1,re.value=!1,(async()=>{if("custom"===ee.value&&ae.value&&ne.value){const e=mn();if(Math.floor((ne.value.valueOf()-ae.value.valueOf())/36e5),e.sn&&null!==e.panel_id&&null!==e.trendlog_id){const t={startTime:ae.value.toISOString(),endTime:ne.value.toISOString(),durationMinutes:Math.floor((ne.value.valueOf()-ae.value.valueOf())/6e4),expectedDataPoints:Math.floor((ne.value.valueOf()-ae.value.valueOf())/15e3),timebaseLabel:`Custom Range (${ae.value.format("DD/MM HH:mm")} - ${ne.value.format("DD/MM HH:mm")})`};await gn(e,t)}else await ja();(Ht||Object.keys(Ft).length>0)&&(Wa(),za())}})(),z.success("Custom date range applied successfully")}else z.error("Please select both start and end date/time")},an=()=>{re.value=!1},nn=e=>{const t=S();switch(e){case"today":ae.value=t.startOf("day"),ne.value=t.endOf("day"),le.value=S().hour(0).minute(0),oe.value=S().hour(23).minute(59);break;case"yesterday":const e=t.subtract(1,"day");ae.value=e.startOf("day"),ne.value=e.endOf("day"),le.value=S().hour(0).minute(0),oe.value=S().hour(23).minute(59);break;case"thisWeek":ae.value=t.startOf("week"),ne.value=t.endOf("week"),le.value=S().hour(0).minute(0),oe.value=S().hour(23).minute(59);break;case"lastWeek":const a=t.subtract(1,"week");ae.value=a.startOf("week"),ne.value=a.endOf("week"),le.value=S().hour(0).minute(0),oe.value=S().hour(23).minute(59)}},ln=()=>{if(ae.value&&ne.value&&le.value&&oe.value){const e=ae.value.hour(le.value.hour()).minute(le.value.minute()),t=ne.value.hour(oe.value.hour()).minute(oe.value.minute());return`${e.format("DD/MM/YYYY HH:mm")} - ${t.format("DD/MM/YYYY HH:mm")}`}return""},on=e=>{var t,a;i.Info("üîÑ TrendLogModal: Auto Scroll toggle - "+(e?"ON":"OFF"),{currentDataSeriesLength:Le.value.length,hasRealData:!!(null==(a=null==(t=Se.value)?void 0:t.inputItems)?void 0:a.length)}),e?(Ia.value=0,ja(),sn()):(un(),i.Info("üìä TrendLogModal: Auto Scroll OFF - switching to historical data only"),rn())},rn=async()=>{i.Info("üìö TLChart: Loading historical data only (Auto Scroll disabled)",{currentDataSeriesLength:Le.value.length,hasMonitorConfig:!!Se.value,timeBase:ee.value});const e=Se.value;if(e&&e.inputItems&&e.inputItems.length>0)try{pe.value=!0,i.Info("üìö Loading historical data from database for current timebase"),await ka(),Ya(),u((()=>{Ya()})),pe.value=!1}catch(t){i.Error("= TLChart: Error in historical data initialization:",t),Ie.value=!0,Le.value=[],pe.value=!1}else i.Info("üìä No monitor configuration available for historical data"),Ie.value=!0,Le.value=[],pe.value=!1},sn=()=>{i.Info("üîÑ startRealTimeUpdates CALLED",{hasExistingInterval:!!jt,isRealTime:se.value,hasMonitorConfig:!!Se.value,timestamp:(new Date).toISOString()}),jt&&clearInterval(jt);const e=Se.value,t=(null==e?void 0:e.dataIntervalMs)||ce.value,a=new Date,n=a.toLocaleTimeString()+"."+a.getMilliseconds().toString().padStart(3,"0");if(i.Info(`üîÑ TrendLogModal: Starting real-time updates [${n}] with detailed interval analysis:`,{"monitorConfig.value exists":!!Se.value,monitorConfigData:e,"monitorConfigData?.dataIntervalMs":null==e?void 0:e.dataIntervalMs,"updateInterval.value (computed)":ce.value,"actualInterval selected":t,intervalSeconds:t/1e3,intervalMinutes:t/6e4,"Raw monitorConfig":Se.value}),!(null==e?void 0:e.dataIntervalMs)){i.Info("üìä TrendLogModal: Using computed updateInterval, calculating from monitorConfig:");const e=de(Se.value);i.Info("üìä TrendLogModal: Calculated interval result:",e)}i.Info(`ÔøΩ?TrendLogModal: Setting up polling timer [${n}] - Next request expected at: ${new Date(Date.now()+t).toLocaleTimeString()}`),jt=setInterval(Ua,t)},un=()=>{jt&&(clearInterval(jt),jt=null)},dn=({key:e})=>{var t;"custom"!==(t=e)?(ee.value=t,se.value="5m"===t):re.value=!0},cn=({key:e})=>{switch(e){case"enable-all":Le.value.forEach((e=>{e.visible=!0})),Ya();break;case"disable-all":Le.value.forEach((e=>{e.visible=!1})),Ya()}},pn=({key:e})=>{switch(e){case"png":In();break;case"jpg":_n();break;case"csv":wn();break;case"json":Tn()}},vn=({key:e})=>{switch(e){case"toggle-analog":(()=>{const e=!pa.value;debugDataSeriesFlow(`Before toggle analog (enabling: ${e})`),Le.value.forEach((t=>{"analog"===t.unitType&&(t.visible=e)})),debugDataSeriesFlow(`After toggle analog (enabled: ${e})`),Ya()})();break;case"toggle-digital":(()=>{const e=!va.value;Le.value.forEach((t=>{"digital"===t.unitType&&(t.visible=e)})),Ya()})();break;case"toggle-input":(()=>{const e=!ma.value;Le.value.forEach((t=>{2===t.pointType&&(t.visible=e)})),Ya()})();break;case"toggle-output":(()=>{const e=!ga.value;Le.value.forEach((t=>{1===t.pointType&&(t.visible=e)})),Ya()})();break;case"toggle-variable":(()=>{const e=!ha.value;Le.value.forEach((t=>{3===t.pointType&&(t.visible=e)})),Ya()})()}},mn=()=>{var e;let t=null,a=null,n=null;try{_e.query.sn&&(t=parseInt(_e.query.sn)),_e.query.panel_id&&(a=parseInt(_e.query.panel_id)),_e.query.trendlog_id&&(n=parseInt(_e.query.trendlog_id))}catch(i){}if(null==(e=Z.itemData)?void 0:e.t3Entry){const e=Z.itemData.t3Entry;if(null===a&&(a=e.pid||null),null===n&&e.id&&"string"==typeof e.id){const t=e.id.match(/MON(\d+)|TRL(\d+)/i);if(t){n=parseInt(t[1]||t[2])-1}}}return!t&&O.value.panelsList&&O.value.panelsList.length>0&&(t=O.value.panelsList[0].serial_number),!a&&O.value.panelsList&&O.value.panelsList.length>0&&(a=O.value.panelsList[0].panel_number),{sn:t,panel_id:a,trendlog_id:n}},gn=async(e,t)=>{try{pe.value=!0,we.value="api",se.value=!1;const a=(()=>{const e=[];return Le.value&&0!==Le.value.length?(Le.value.forEach(((t,a)=>{try{const n=t.itemType||`${mn().panel_id}VAR${a+1}`,i=n.match(/^(\d+)/),l=i?parseInt(i[1]):mn().panel_id||2;let o,r,s;if(n.includes("Input")){o="INPUT";const e=n.match(/Input(\d+)$/);r=e?parseInt(e[1])-1:a}else if(n.includes("Output")){o="OUTPUT";const e=n.match(/Output(\d+)$/);r=e?parseInt(e[1])-1:a}else if(n.includes("VAR")){o="VARIABLE";const e=n.match(/VAR(\d+)$/);r=e?parseInt(e[1])-1:a}else if(n.includes("HOL")){o="MONITOR";const e=n.match(/HOL(\d+)$/);r=e?parseInt(e[1])-1:a}else o="VARIABLE",r=a;s="INPUT"===o?`IN${r+1}`:"OUTPUT"===o?`OUT${r+1}`:"VARIABLE"===o?`VAR${r+1}`:"MONITOR"===o?`HOL${r+1}`:`VAR${r+1}`,e.push({point_id:s,point_type:o,point_index:r,panel_id:l})}catch(n){const t=mn();e.push({point_id:`VAR${a+1}`,point_type:"VARIABLE",point_index:a,panel_id:t.panel_id||2})}})),e):e})(),n={serial_number:e.sn,panel_id:e.panel_id,trendlog_id:e.trendlog_id.toString(),start_time:t.startTime,end_time:t.endTime,limit:Math.min(2*t.expectedDataPoints,5e3),point_types:["INPUT","OUTPUT","VARIABLE","MONITOR"],specific_points:a},i=await De.getTrendlogHistory(n);if(i&&i.data&&i.data.length>0){const e=hn(i.data,t);Le.value=e,Ya(),ye.value=S().format("HH:mm:ss")}else Ie.value=!0,Le.value=[],await ja()}catch(a){Ie.value=!0,Le.value=[],B.error({message:"Historical Data Error",description:`Failed to load historical data: ${a instanceof Error?a.message:"Unknown error"}`,duration:4.5}),await ja()}finally{pe.value=!1}},hn=(e,t)=>{const a=Le.value||[],n=new Map;e.forEach((e=>{const t=`${e.point_type}_${e.point_id}`;n.has(t)||n.set(t,[]),n.get(t).push(e)}));const i=[],l=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9","#F8C471","#82E0AA","#F1948A","#85C1E9","#F4D03F"];return a.forEach(((e,t)=>{let a,o;if(n.forEach(((n,i)=>{if(a)return;const[l,r]=i.split("_");if(e.itemType&&e.itemType.includes(r))return a=n,void(o=i);if(e.name.includes(r))return a=n,void(o=i);if(e.prefix===l){if(r===`${"INPUT"===l?"IN":"OUTPUT"===l?"OUT":"VARIABLE"===l?"VAR":"UNK"}${t+1}`)return a=n,void(o=i)}})),a&&o){n.delete(o),a.sort(((e,t)=>new Date(e.time).getTime()-new Date(t.time).getTime()));const r=a.map((e=>({timestamp:new Date(e.time).getTime(),value:"number"==typeof e.value?e.value:parseFloat(e.value)||0}))),s={name:e.name,color:e.color||l[t%l.length],data:r,visible:!1!==e.visible,unit:e.unit||"",unitType:e.unitType,unitCode:e.unitCode,itemType:e.itemType,prefix:e.prefix,description:e.description};i.push(s)}else{const a={name:e.name,color:e.color||l[t%l.length],data:[],visible:!1!==e.visible,unit:e.unit||"",unitType:e.unitType,unitCode:e.unitCode,itemType:e.itemType,prefix:e.prefix,description:e.description,isEmpty:!0};i.push(a)}})),i},fn=(e,t)=>{if(0===e.length)return"N/A";const a=e[e.length-1].value;if("digital"===(null==t?void 0:t.unitType)){const e=1===a?1:0;return`${q(t.unitCode||1)[e]} (${a})`}{const e=(null==t?void 0:t.unit)||"";return a.toFixed(2)+e}},yn=(e,t)=>{if(0===e.length)return"N/A";const a=e.reduce(((e,t)=>e+t.value),0)/e.length;if("digital"===(null==t?void 0:t.unitType)){return`${(e.filter((e=>1===e.value)).length/e.length*100).toFixed(1)}% High`}{const e=(null==t?void 0:t.unit)||"";return a.toFixed(2)+e}},bn=(e,t)=>{if(0===e.length)return"N/A";const a=Math.min(...e.map((e=>e.value)));if("digital"===(null==t?void 0:t.unitType)){const e=1===a?1:0;return`${q(t.unitCode||1)[e]} (${a})`}{const e=(null==t?void 0:t.unit)||"";return a.toFixed(2)+e}},Dn=(e,t)=>{if(0===e.length)return"N/A";const a=Math.max(...e.map((e=>e.value)));if("digital"===(null==t?void 0:t.unitType)){const e=1===a?1:0;return`${q(t.unitCode||1)[e]} (${a})`}{const e=(null==t?void 0:t.unit)||"";return a.toFixed(2)+e}},wn=()=>{const e=Le.value.filter((e=>e.visible&&!e.isEmpty));if(0===e.length)return void z.warning("No visible data series to export");const t=[],a=["Timestamp",...e.map((e=>`${e.name} (${e.unit||e.unitType})`))];t.push(a.join(",")),Math.max(...e.map((e=>e.data.length)));const n=new Set;e.forEach((e=>{e.data.forEach((e=>{e.timestamp&&n.add(e.timestamp)}))}));const i=Array.from(n).sort(((e,t)=>e-t));i.forEach((a=>{const n=[];"number"==typeof a&&a>1e9?n.push(J(a)):n.push(new Date(a).toLocaleString()),e.forEach((e=>{const t=e.data.find((e=>e.timestamp===a));if(t)if("digital"===e.unitType){const a=Y(e.unit||"");a?n.push(1===t.value?a[1]:a[0]):n.push(1===t.value?"HIGH":"LOW")}else n.push(t.value.toFixed(2));else n.push("")})),t.push(n.join(","))}));const l=new Blob([t.join("\n")],{type:"text/csv"}),o=document.createElement("a");o.download=`${Ut.value}_AllSeries_${S().format("YYYY-MM-DD_HH-mm-ss")}.csv`,o.href=URL.createObjectURL(l),o.click(),z.success(`Data exported successfully (${e.length} series, ${i.length} data points)`)},In=async()=>{var e;try{const t=[];if(Ht&&fa.value.length>0&&t.push({instance:Ht,canvas:Pt.value,type:"analog",height:(null==(e=Pt.value)?void 0:e.offsetHeight)||400}),ya.value.forEach(((e,a)=>{const n=Ft[a],i=Nt.value[a];n&&i&&t.push({instance:n,canvas:i,type:"digital",height:i.offsetHeight||100,seriesName:e.name})})),0===t.length)return void z.warning("No charts available to export");const a=document.createElement("canvas"),n=a.getContext("2d");if(!n)return;const i=Math.max(...t.map((e=>{var t;return(null==(t=e.canvas)?void 0:t.offsetWidth)||800}))),l=t.reduce(((e,t)=>e+t.height+20),40);a.width=i,a.height=l,n.fillStyle="#ffffff",n.fillRect(0,0,i,l);const o=Da();let r="";if(o.min&&o.max){const e=J(o.min).split(" ")[1],t=J(o.max).split(" ")[1],a=J(o.min).split(" ")[0],n=J(o.max).split(" ")[0];r=a===n?` (${a} ${e} - ${t})`:` (${a} ${e} - ${n} ${t})`}else r=` (${ee.value})`;n.fillStyle="#000000",n.font="bold 16px Arial",n.textAlign="center",n.fillText(`${Ut.value}${r}`,i/2,25);let s=50;for(const e of t){const t=document.createElement("canvas"),a=t.getContext("2d");if(!a||!e.canvas)continue;t.width=e.canvas.width,t.height=e.canvas.height,a.fillStyle="#ffffff",a.fillRect(0,0,t.width,t.height);const l=e.instance.toBase64Image("image/png",1),o=new Image;await new Promise((e=>{o.onload=()=>{a.drawImage(o,0,0),e()},o.src=l})),"digital"===e.type&&e.seriesName&&(n.fillStyle="#333333",n.font="bold 12px Arial",n.textAlign="left",n.fillText(`${e.seriesName}`,10,s-5),s+=15);const r=i,u=e.canvas.height*i/e.canvas.width;n.drawImage(t,0,s,r,u),s+=u+10}const u=document.createElement("a");u.download=`${Ut.value}_${S().format("YYYY-MM-DD_HH-mm-ss")}.png`,u.href=a.toDataURL("image/png",1),u.click(),z.success("Chart exported as PNG successfully")}catch(t){z.error("Failed to export chart as PNG")}},_n=async()=>{var e;try{const t=[];if(Ht&&fa.value.length>0&&t.push({instance:Ht,canvas:Pt.value,type:"analog",height:(null==(e=Pt.value)?void 0:e.offsetHeight)||400}),ya.value.forEach(((e,a)=>{const n=Ft[a],i=Nt.value[a];n&&i&&t.push({instance:n,canvas:i,type:"digital",height:i.offsetHeight||100,seriesName:e.name})})),0===t.length)return void z.warning("No charts available to export");const a=document.createElement("canvas"),n=a.getContext("2d");if(!n)return;const i=Math.max(...t.map((e=>{var t;return(null==(t=e.canvas)?void 0:t.offsetWidth)||800}))),l=t.reduce(((e,t)=>e+t.height+20),40);a.width=i,a.height=l,n.fillStyle="#f5f5f5",n.fillRect(0,0,i,l);const o=Da();let r="";if(o.min&&o.max){const e=J(o.min).split(" ")[1],t=J(o.max).split(" ")[1],a=J(o.min).split(" ")[0],n=J(o.max).split(" ")[0];r=a===n?` (${a} ${e} - ${t})`:` (${a} ${e} - ${n} ${t})`}else r=` (${ee.value})`;n.fillStyle="#000000",n.font="bold 16px Arial",n.textAlign="center",n.fillText(`${Ut.value}${r}`,i/2,25);let s=50;for(const e of t){const t=document.createElement("canvas"),a=t.getContext("2d");if(!a||!e.canvas)continue;t.width=e.canvas.width,t.height=e.canvas.height,a.fillStyle="#f5f5f5",a.fillRect(0,0,t.width,t.height);const l=e.instance.toBase64Image("image/png",1),o=new Image;await new Promise((e=>{o.onload=()=>{a.drawImage(o,0,0),e()},o.src=l})),"digital"===e.type&&e.seriesName&&(n.fillStyle="#222222",n.font="bold 12px Arial",n.textAlign="left",n.fillText(`${e.seriesName}`,10,s-5),s+=15);const r=i,u=e.canvas.height*i/e.canvas.width;n.drawImage(t,0,s,r,u),s+=u+10}const u=document.createElement("a");u.download=`${Ut.value}_${S().format("YYYY-MM-DD_HH-mm-ss")}.jpg`,u.href=a.toDataURL("image/jpeg",.9),u.click(),z.success("Chart exported as JPG successfully")}catch(t){z.error("Failed to export chart as JPG")}},Tn=()=>{const e=Le.value.filter((e=>e.visible&&!e.isEmpty));if(0===e.length)return void z.warning("No visible data series to export");const t=e.flatMap((e=>e.data.map((e=>e.timestamp)))).filter((e=>e)),a={start:t.length>0?Math.min(...t):null,end:t.length>0?Math.max(...t):null,startFormatted:t.length>0?J(Math.min(...t)):null,endFormatted:t.length>0?J(Math.max(...t)):null},n={title:Ut.value,exportedAt:(new Date).toISOString(),exportType:"multi-canvas-chart",timeBase:ee.value,totalDataPoints:t.length,timeRange:a,chartTypes:{analog:{count:e.filter((e=>"analog"===e.unitType)).length,series:e.filter((e=>"analog"===e.unitType)).map((e=>e.name))},digital:{count:e.filter((e=>"digital"===e.unitType)).length,series:e.filter((e=>"digital"===e.unitType)).map((e=>e.name))}},series:e.map((e=>({name:e.name,id:e.id,unit:e.unit,type:e.unitType,color:e.color,panelId:e.panelId,pointType:e.pointType,pointNumber:e.pointNumber,prefix:e.prefix,description:e.description,itemType:e.itemType,dataPoints:e.data.length,data:e.data.map((t=>({timestamp:t.timestamp,timestampFormatted:J(t.timestamp),value:t.value,..."digital"===e.unitType&&{digitalState:(()=>{const a=Y(e.unit||"");return a?1===t.value?a[1]:a[0]:1===t.value?"HIGH":"LOW"})()}})))})))},i=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),l=document.createElement("a");l.download=`${Ut.value}_AllSeries_${S().format("YYYY-MM-DD_HH-mm-ss")}.json`,l.href=URL.createObjectURL(i),l.click(),z.success(`Data exported as JSON successfully (${e.length} series, ${t.length} total data points)`)};return n([ve,ge,he,fe],(()=>{(Ht||Object.keys(Ft).length>0)&&(Wa(),za())})),n(ya,(async(e,t)=>{const a=Object.keys(Ft).length>0,n=e.length>0;e.length===(null==t?void 0:t.length)&&a===n||(await u(),Va(),Ga())}),{deep:!0}),s((async()=>{var e,t,a,n,l,o;try{i.Info("üöÄ TrendLogChart: Starting component initialization",{hasProps:!!Z,hasItemData:!!Z.itemData,itemDataId:null==(t=null==(e=Z.itemData)?void 0:e.t3Entry)?void 0:t.id,itemDataPid:null==(n=null==(a=Z.itemData)?void 0:a.t3Entry)?void 0:n.pid,currentItemDataExists:!!X.value,T3000DataExists:!!O.value,hasPanelsData:!!(null==(l=O.value.panelsData)?void 0:l.length),timestamp:(new Date).toISOString()});const r=await(async()=>{var e,t,a,n,l;const o=null==(t=null==(e=X.value)?void 0:e.t3Entry)?void 0:t.id,r=null==(n=null==(a=X.value)?void 0:a.t3Entry)?void 0:n.pid;if(i.Info("üîç getMonitorConfigFromT3000Data: Extracting config parameters",{monitorId:o,panelId:r,hasCurrentItemData:!!X.value,currentItemDataType:typeof X.value,t3EntryExists:!!(null==(l=X.value)?void 0:l.t3Entry),propsItemData:!!Z.itemData,timestamp:(new Date).toISOString()}),!o)return i.Warn("‚ùå getMonitorConfigFromT3000Data: No monitor ID available",{currentItemData:X.value,propsItemData:Z.itemData}),null;if(!r&&0!==r)return i.Warn("‚ùå getMonitorConfigFromT3000Data: No panel ID available",{monitorId:o,panelId:r,currentItemData:X.value}),null;try{if(!(await Pe.waitForDataReady({timeout:15e3,specificEntries:[o]})).isValid)return null;const e=await Pe.getEntryByPid(o,r);if(!e)return null;const t=de(e),a=[],n=[];if(e.input&&Array.isArray(e.input))for(let i=0;i<e.input.length;i++){const t=e.input[i];if(t&&void 0!==t.panel&&void 0!==t.point_number){a.push({panel:t.panel,point_number:t.point_number,index:i,point_type:t.point_type,network:t.network,sub_panel:t.sub_panel});const l=e.range&&e.range[i]?e.range[i]:0;n.push(l)}}return 0===a.length||0===a.filter((e=>void 0!==e.panel&&void 0!==e.point_number&&e.point_number>=0)).length?null:{id:e.id,label:e.label||e.description||`Monitor ${o}`,pid:e.pid,type:e.type,status:e.status,numInputs:a.length,inputItems:a,ranges:n,dataIntervalMs:t,originalConfig:e}}catch(s){return null}})();i.Info("üìä TrendLogChart: Monitor config result",{hasMonitorConfig:!!r,monitorConfigType:typeof r,monitorConfigKeys:r?Object.keys(r):[],inputItemsLength:(null==(o=null==r?void 0:r.inputItems)?void 0:o.length)||0}),r?(Se.value=r,Ta(),i.Info("‚úÖ TrendLogChart: Initialization completed successfully")):i.Warn("‚ö†Ô∏è TrendLogChart: No monitor config data available - keeping loading state")}catch(r){i.Error("‚ùå TrendLogChart: Initialization failed:",r),r.message&&!r.message.includes("timeout")&&(Ie.value=!0)}en(1),u((async()=>{var e;if((null==(e=window.chrome)?void 0:e.webview)||await new Promise((e=>setTimeout(e,150))),Pt.value){Pt.value.offsetWidth>0&&Pt.value.offsetHeight>0||await new Promise((e=>setTimeout(e,300)))}await ja(),za(),se.value&&sn()}))})),d((()=>{un(),Wa()})),(a,n)=>{const l=I("a-typography-text"),o=I("a-button"),r=I("a-menu-item"),s=I("a-menu-divider"),u=I("a-menu"),d=I("a-dropdown"),S=I("a-flex"),C=I("a-button-group"),E=I("a-tag"),O=I("h7"),x=I("a-switch"),A=I("a-spin"),L=I("a-col"),j=I("a-date-picker"),z=I("a-time-picker"),B=I("a-row"),W=I("a-space"),Y=I("a-alert"),q=I("a-modal"),J=I("a-config-provider");return c(),p(J,{theme:{token:{colorPrimary:"#0064c8",colorBgBase:"#ffffff",colorText:"#000000",colorBorder:"#d9d9d9"}}},{default:v((()=>[m("div",He,[t(S,{wrap:"wrap",gap:"small",class:"controls-main-flex"},{default:v((()=>[t(S,{align:"center",gap:"small",class:"control-group"},{default:v((()=>[t(l,{class:"control-label",style:{"font-size":"11px"}},{default:v((()=>[...n[13]||(n[13]=[g("Time Base:",-1)])])),_:1}),t(d,{placement:"bottomRight"},{overlay:v((()=>[t(u,{onClick:dn,class:"timebase-dropdown-menu"},{default:v((()=>[t(r,{key:"5m"},{default:v((()=>[...n[14]||(n[14]=[g("5 minutes",-1)])])),_:1}),t(r,{key:"10m"},{default:v((()=>[...n[15]||(n[15]=[g("10 minutes",-1)])])),_:1}),t(r,{key:"30m"},{default:v((()=>[...n[16]||(n[16]=[g("30 minutes",-1)])])),_:1}),t(r,{key:"1h"},{default:v((()=>[...n[17]||(n[17]=[g("1 hour",-1)])])),_:1}),t(r,{key:"4h"},{default:v((()=>[...n[18]||(n[18]=[g("4 hours",-1)])])),_:1}),t(r,{key:"12h"},{default:v((()=>[...n[19]||(n[19]=[g("12 hours",-1)])])),_:1}),t(r,{key:"1d"},{default:v((()=>[...n[20]||(n[20]=[g("1 day",-1)])])),_:1}),t(r,{key:"4d"},{default:v((()=>[...n[21]||(n[21]=[g("4 days",-1)])])),_:1}),t(s),t(r,{key:"custom"},{default:v((()=>[...n[22]||(n[22]=[g("Custom Define",-1)])])),_:1})])),_:1})])),default:v((()=>[t(o,{size:"small",style:{display:"flex","align-items":"center"}},{default:v((()=>[m("span",null,h({"5m":"5 minutes","10m":"10 minutes","30m":"30 minutes","1h":"1 hour","4h":"4 hours","12h":"12 hours","1d":"1 day","4d":"4 days",custom:"Custom Define"}[ee.value]||"1 hour"),1),t(f(R),{style:{"margin-left":"4px"}})])),_:1})])),_:1})])),_:1}),t(S,{align:"center",class:"control-group"},{default:v((()=>[t(C,{size:"small"},{default:v((()=>[t(o,{onClick:Ka,disabled:se.value},{icon:v((()=>[t(f(P))])),_:1},8,["disabled"]),t(o,{onClick:Ja,disabled:se.value},{icon:v((()=>[t(f(M))])),_:1},8,["disabled"])])),_:1})])),_:1}),t(S,{align:"center",class:"control-group"},{default:v((()=>[t(C,{size:"small"},{default:v((()=>[t(o,{onClick:Xa,disabled:!Yt.value,title:"Zoom Out (Longer timebase)",style:{display:"flex","align-items":"center",gap:"2px"}},{default:v((()=>[t(f(k)),n[23]||(n[23]=m("span",null,"Zoom Out",-1))])),_:1},8,["disabled"]),t(o,{onClick:Za,disabled:!Wt.value,title:"Zoom In (Shorter timebase)",style:{display:"flex","align-items":"center",gap:"2px"}},{default:v((()=>[t(f($)),n[24]||(n[24]=m("span",null,"Zoom In",-1))])),_:1},8,["disabled"])])),_:1})])),_:1}),t(S,{align:"center",class:"control-group"},{default:v((()=>[t(o,{onClick:Qa,size:"small",title:"Reset to default 5 minutes timebase",style:{display:"flex","align-items":"center",gap:"2px"}},{default:v((()=>[t(f(N)),n[25]||(n[25]=m("span",null,"Reset",-1))])),_:1})])),_:1}),t(S,{align:"center",class:"control-group"},{default:v((()=>[t(C,{size:"small"},{default:v((()=>[t(o,{type:1===te.value?"primary":"default",onClick:n[0]||(n[0]=e=>en(1))},{default:v((()=>[...n[26]||(n[26]=[g(" View 1 ",-1)])])),_:1},8,["type"]),t(o,{type:2===te.value?"primary":"default",onClick:n[1]||(n[1]=e=>en(2))},{default:v((()=>[...n[27]||(n[27]=[g(" View 2 ",-1)])])),_:1},8,["type"]),t(o,{type:3===te.value?"primary":"default",onClick:n[2]||(n[2]=e=>en(3))},{default:v((()=>[...n[28]||(n[28]=[g(" View 3 ",-1)])])),_:1},8,["type"])])),_:1})])),_:1}),t(S,{align:"center",wrap:"wrap",gap:"small",class:"control-group status-tags"},{default:v((()=>[se.value?(c(),p(E,{key:0,color:"green",size:"small"},{icon:v((()=>[t(f(ke),{spin:!0})])),default:v((()=>[g(" Live - "+h(ye.value),1)])),_:1})):(c(),p(E,{key:1,color:"blue",size:"small"},{icon:v((()=>[t(f(H))])),default:v((()=>[n[29]||(n[29]=g(" Historical ",-1))])),_:1})),t(E,{size:"small"},{default:v((()=>[g(h("custom"===ee.value?"Custom":Bt.value),1)])),_:1})])),_:1}),t(S,{align:"center",class:"control-group export-options"},{default:v((()=>[t(d,{placement:"bottomRight"},{overlay:v((()=>[t(u,{class:"export-options-menu",onClick:pn},{default:v((()=>[t(r,{key:"png"},{default:v((()=>[t(f(me)),n[31]||(n[31]=g(" Export as PNG ",-1))])),_:1}),t(s),t(r,{key:"csv"},{default:v((()=>[t(f(ue)),n[32]||(n[32]=g(" Export Data (CSV) ",-1))])),_:1}),t(r,{key:"json"},{default:v((()=>[t(f(F)),n[33]||(n[33]=g(" Export Data (JSON) ",-1))])),_:1})])),_:1})])),default:v((()=>[t(o,{size:"small",style:{display:"flex","align-items":"center"}},{default:v((()=>[t(f(ie),{style:{"margin-right":"4px"}}),n[30]||(n[30]=m("span",null,"Export",-1)),t(f(R),{style:{"margin-left":"4px"}})])),_:1})])),_:1})])),_:1})])),_:1})]),m("div",Fe,[m("div",je,[m("div",Ue,[m("div",ze,[m("div",Be,[t(O,null,{default:v((()=>[g(h(Ut.value)+" ("+h(zt.value)+"/"+h(Le.value.length)+")",1)])),_:1}),m("div",Ve,[ca.value?(c(),y("span",We," Loading... ")):"realtime"===we.value?(c(),y("span",Ye," üì° Live ")):"api"===we.value?(c(),y("span",qe," üìö Historical ("+h(ee.value)+") ",1)):Ie.value?(c(),y("span",Ge," ‚ùå Connection Error ")):b("",!0)])]),m("div",Ke,[m("div",Je,[t(d,null,{overlay:v((()=>[t(u,{onClick:cn,class:"all-dropdown-menu"},{default:v((()=>[t(r,{key:"enable-all",disabled:!Gt.value},{default:v((()=>[t(f(U)),n[35]||(n[35]=g(" Enable All ",-1))])),_:1},8,["disabled"]),t(r,{key:"disable-all",disabled:!qt.value},{default:v((()=>[t(f(Q)),n[36]||(n[36]=g(" Disable All ",-1))])),_:1},8,["disabled"])])),_:1})])),default:v((()=>[t(o,{size:"small",style:{display:"flex","align-items":"center"}},{default:v((()=>[n[34]||(n[34]=m("span",null,"All",-1)),t(f(R),{style:{"margin-left":"4px"}})])),_:1})])),_:1}),t(d,null,{overlay:v((()=>[t(u,{onClick:vn,class:"bytype-dropdown-menu"},{default:v((()=>[t(r,{key:"toggle-analog",disabled:!ea.value},{default:v((()=>[t(f(xe)),g(" "+h(pa.value?"Disable":"Enable")+" Analog ("+h(la.value)+") ",1)])),_:1},8,["disabled"]),t(r,{key:"toggle-digital",disabled:!ta.value},{default:v((()=>[t(f(G)),g(" "+h(va.value?"Disable":"Enable")+" Digital ("+h(oa.value)+") ",1)])),_:1},8,["disabled"]),t(r,{key:"toggle-input",disabled:!aa.value},{default:v((()=>[t(f(Te)),g(" "+h(ma.value?"Disable":"Enable")+" Input ("+h(ra.value)+") ",1)])),_:1},8,["disabled"]),t(r,{key:"toggle-output",disabled:!na.value},{default:v((()=>[t(f(ie)),g(" "+h(ga.value?"Disable":"Enable")+" Output ("+h(sa.value)+") ",1)])),_:1},8,["disabled"]),t(r,{key:"toggle-variable",disabled:!ia.value},{default:v((()=>[t(f(be)),g(" "+h(ha.value?"Disable":"Enable")+" Variable ("+h(ua.value)+") ",1)])),_:1},8,["disabled"])])),_:1})])),default:v((()=>[t(o,{size:"small",style:{display:"flex","align-items":"center"}},{default:v((()=>[n[37]||(n[37]=m("span",null,"By Type",-1)),t(f(R),{style:{"margin-left":"4px"}})])),_:1})])),_:1})]),m("div",Ze,[t(l,{class:"toggle-label"},{default:v((()=>[...n[38]||(n[38]=[g("Auto Scroll:",-1)])])),_:1}),t(x,{checked:se.value,"onUpdate:checked":n[3]||(n[3]=e=>se.value=e),size:"small",onChange:on},null,8,["checked"])])])]),m("div",Xe,[0===Le.value.length?(c(),y("div",Qe,[m("div",et,[ca.value?(c(),y("div",tt,[t(A,{size:"small"})])):Ie.value?(c(),y("div",at,"‚ùå")):(c(),y("div",nt,"üìä")),ca.value?(c(),y("div",it,"Loading T3000 device data...")):Ie.value?(c(),y("div",lt,"Data Connection Error")):(c(),y("div",ot,"No valid trend log data available")),ca.value?(c(),y("div",rt," Connecting to your T3000 devices to retrieve trend data... ")):Ie.value?(c(),y("div",st," Unable to load real-time or historical data. Check system connections. ")):(c(),y("div",ut,"Configure monitor points with valid T3000 devices to see data series"))])])):b("",!0),(c(!0),y(w,null,D(Le.value,((a,l)=>(c(),y("div",{key:a.name,class:_(["series-item",{"series-disabled":!a.visible}])},[m("div",{class:"series-header",onClick:e=>((e,t)=>{t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),Le.value[e].isEmpty||(Le.value[e].visible=!Le.value[e].visible,Ya(),i.Debug(`Toggled visibility for series ${Le.value[e].name} to ${Le.value[e].visible}`))})(l,e)},[m("div",{class:_(["series-toggle-indicator",{active:a.visible,inactive:!a.visible}]),style:T({backgroundColor:a.visible?a.color:"#d9d9d9"})},[m("div",{class:_(["toggle-inner",{visible:a.visible}])},null,2)],6),m("div",ct,[m("div",pt,[m("div",vt,[m("span",mt,h(V(a)),1),a.prefix?(c(),p(e,{key:0,label:a.prefix,color:"grey-4","text-color":"grey-8",size:"xs",dense:"",class:"series-prefix-tag-small"},null,8,["label"])):b("",!0)]),m("span",gt,[m("span",{class:"unit-info",style:T({color:a.color})},h(K(a)),5)])])]),m("div",ht,[t(o,{size:"small",type:"text",class:"expand-toggle",onClick:e=>((e,t)=>{t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),Le.value[e].isEmpty||(Ce.value.has(e)?Ce.value.delete(e):Ce.value.add(e))})(l,e)},{icon:v((()=>[Ce.value.has(l)?(c(),p(f(R),{key:0,class:"expand-icon expanded"})):(c(),p(f(M),{key:1,class:"expand-icon"}))])),_:2},1032,["onClick"])])],8,dt),Ce.value.has(l)?(c(),y("div",ft,[m("div",yt,[n[39]||(n[39]=m("span",{class:"stat-label"},"Last:",-1)),m("span",bt,h(fn(a.data,a)),1)]),m("div",Dt,[n[40]||(n[40]=m("span",{class:"stat-label"},"Avg:",-1)),m("span",wt,h(yn(a.data,a)),1)]),m("div",It,[n[41]||(n[41]=m("span",{class:"stat-label"},"Min:",-1)),m("span",_t,h(bn(a.data,a)),1)]),m("div",Tt,[n[42]||(n[42]=m("span",{class:"stat-label"},"Max:",-1)),m("span",St,h(Dn(a.data,a)),1)])])):b("",!0)],2)))),128))])])]),m("div",Ct,[m("div",Et,[m("div",Ot,[m("canvas",{ref_key:"analogChartCanvas",ref:Pt,id:"analog-chart"},null,512)]),(c(!0),y(w,null,D(ya.value,((e,t)=>(c(),y("div",{key:e.name,class:"channel-chart"},[m("canvas",{ref_for:!0,ref:e=>((e,t)=>{e&&"tagName"in e&&"CANVAS"===e.tagName&&(Nt.value[t]=e)})(e,t),id:`digital-${t}-chart`},null,8,xt)])))),128))])])]),pe.value?(c(),y("div",At,[t(A,{size:"large"}),n[43]||(n[43]=m("div",{class:"loading-text"},"Loading trend log data...",-1))])):b("",!0),t(q,{visible:re.value,"onUpdate:visible":n[12]||(n[12]=e=>re.value=e),title:"X Axis",width:320,centered:"",onOk:tn,onCancel:an},{default:v((()=>[m("div",Lt,[t(B,{gutter:8,class:"date-time-row"},{default:v((()=>[t(L,{span:4,class:"label-col"},{default:v((()=>[...n[44]||(n[44]=[m("label",{class:"time-label"},"Start:",-1)])])),_:1}),t(L,{span:11},{default:v((()=>[t(j,{value:ae.value,"onUpdate:value":n[4]||(n[4]=e=>ae.value=e),placeholder:"Date",size:"small",style:{width:"100%","font-size":"11px"},format:"DD/MM/YYYY"},null,8,["value"])])),_:1}),t(L,{span:9},{default:v((()=>[t(z,{value:le.value,"onUpdate:value":n[5]||(n[5]=e=>le.value=e),placeholder:"Time",size:"small",style:{width:"100%","font-size":"11px"},format:"HH:mm"},null,8,["value"])])),_:1})])),_:1}),t(B,{gutter:8,class:"date-time-row"},{default:v((()=>[t(L,{span:4,class:"label-col"},{default:v((()=>[...n[45]||(n[45]=[m("label",{class:"time-label"},"End:",-1)])])),_:1}),t(L,{span:11},{default:v((()=>[t(j,{value:ne.value,"onUpdate:value":n[6]||(n[6]=e=>ne.value=e),placeholder:"Date",size:"small",style:{width:"100%","font-size":"11px"},format:"DD/MM/YYYY"},null,8,["value"])])),_:1}),t(L,{span:9},{default:v((()=>[t(z,{value:oe.value,"onUpdate:value":n[7]||(n[7]=e=>oe.value=e),placeholder:"Time",size:"small",style:{width:"100%","font-size":"11px"},format:"HH:mm"},null,8,["value"])])),_:1})])),_:1}),m("div",Rt,[t(W,{size:"small"},{default:v((()=>[t(o,{size:"small",onClick:n[8]||(n[8]=e=>nn("today"))},{default:v((()=>[...n[46]||(n[46]=[g("Today",-1)])])),_:1}),t(o,{size:"small",onClick:n[9]||(n[9]=e=>nn("yesterday"))},{default:v((()=>[...n[47]||(n[47]=[g("Yesterday",-1)])])),_:1}),t(o,{size:"small",onClick:n[10]||(n[10]=e=>nn("thisWeek"))},{default:v((()=>[...n[48]||(n[48]=[g("This Week",-1)])])),_:1}),t(o,{size:"small",onClick:n[11]||(n[11]=e=>nn("lastWeek"))},{default:v((()=>[...n[49]||(n[49]=[g("Last Week",-1)])])),_:1})])),_:1})]),ae.value&&ne.value&&le.value&&oe.value?(c(),y("div",Mt,[t(Y,{type:"info","show-icon":"",size:"small"},{message:v((()=>[m("span",kt,h(ln()),1)])),_:1})])):b("",!0)])])),_:1},8,["visible"])])),_:1})}}}),[["__scopeId","data-v-f99da4d6"]]);export{$t as T,Pe as t,Ne as u};

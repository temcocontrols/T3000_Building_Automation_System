import{j as e}from"./react.8639cc86.js";import{r as t,R as o}from"./client.58f92968.js";import{R as n,aN as r,M as i,aO as s,t as a,l,T as d,aP as c,aQ as p,B as x,aR as g,aS as u,at as h,au as m,aT as f,z as b,aU as v,aV as j,aW as y,N as I,aX as C,aY as N,aZ as S,s as T,S as w,$ as _,a_ as k,a$ as A,n as $,b0 as z,Z as L,Q as D,b1 as E,K as P,a0 as F,a3 as O,a4 as B,y as R,P as M,I as U,U as W,V as H,X as V,x as G}from"./App.7c34790a.js";import"./index.e8ef0632.js";import{i as q}from"./install.00f124f0.js";import{T as X}from"./Tag.514c13c1.js";import{c as Y,D as J,a as Z,b as Q,d as K,e as ee,f as te}from"./DataGridHeaderCell.ec45a911.js";import{T as oe}from"./TableCellLayout.d4b0b796.js";class ne{static async refreshAllFromDevice(e){return n.refreshAllTrendlogs(e)}static async refreshSingleFromDevice(e,t){return n.refreshSingleTrendlog(e,t)}static async loadAllFromDB(e){return new r(`${i}/api`).trendlogs.getAll(e)}static async loadFromDB(e,t){const o=new r(`${i}/api`);return(await o.trendlogs.getAll(e)).find((e=>e.Trendlog_ID===t))}static async loadByIdFromDB(e){const[t,o]=e.split("-"),n=parseInt(t),s=parseInt(o);if(isNaN(n)||isNaN(s))return;const a=new r(`${i}/api`);return await a.trendlogs.get(n,s)||void 0}static async validate(e){const t=[];return(e.index<0||e.index>15)&&t.push("Index must be between 0-15"),e.label&&""!==e.label.trim()||t.push("Label is required"),{valid:0===t.length,errors:t}}}const re=s({chartContainer:{width:"100%",height:"100%",backgroundColor:a.colorNeutralBackground1},chartContainerMain:{minHeight:"400px"},chartContainerOscilloscope:{minHeight:"60px"}}),ie=["#FF0000","#0000FF","#00AA00","#FF8000","#AA00AA","#CC6600","#AA0000","#0066AA","#AA6600","#6600AA","#006600","#FF6600","#0000AA","#FF00FF","#008080","#800080","#808000","#FF1493","#4B0082","#DC143C","#00AAAA","#00CED1","#8B4513","#2F4F4F","#B22222"],se={"5m":{stepMinutes:1,divisions:5,totalMinutes:5},"10m":{stepMinutes:2,divisions:5,totalMinutes:10},"30m":{stepMinutes:5,divisions:6,totalMinutes:30},"1h":{stepMinutes:15,divisions:4,totalMinutes:60},"4h":{stepMinutes:60,divisions:4,totalMinutes:240},"12h":{stepMinutes:120,divisions:6,totalMinutes:720},"1d":{stepMinutes:240,divisions:6,totalMinutes:1440},"4d":{stepMinutes:960,divisions:6,totalMinutes:5760}},ae=({series:o,timeBase:n,showGrid:r=!0,chartType:i="analog",onTimeRangeChange:s})=>{var a;const l=re(),d=t.exports.useRef(null),c=t.exports.useRef(null),p=o.filter((e=>"Analog"===e.digitalAnalog&&!1!==e.visible)),x=o.filter((e=>"Digital"===e.digitalAnalog&&!1!==e.visible)),g="digital"===i&&1===o.length&&"Digital"===(null==(a=o[0])?void 0:a.digitalAnalog),u=t.exports.useCallback((e=>{const t=[];if(e.forEach((e=>{e.data.forEach((e=>{isFinite(e.value)&&e.value>-99999&&e.value<999999&&t.push(e.value)}))})),0===t.length)return{min:0,max:100};const o=Math.min(...t),n=Math.max(...t),r=n-o;if(0===r)return{min:.9*o,max:1.1*n};if(r<2){const e=(o+n)/2,t=Math.max(3*r,1);return{min:e-t/2,max:e+t/2}}{const e=.1*r;return{min:o-e,max:n+e}}}),[]),h=t.exports.useCallback(((e,t)=>{const o=new Date(e),n=o.getHours().toString().padStart(2,"0"),r=o.getMinutes().toString().padStart(2,"0"),i=(o.getMonth()+1).toString().padStart(2,"0"),s=o.getDate().toString().padStart(2,"0");return"5m"===t||"10m"===t||"30m"===t||"1h"===t?`${n}:${r}`:`${i}-${s} ${n}:${r}`}),[]);return t.exports.useEffect((()=>{if(!d.current)return;let e=c.current;e||(e=q(d.current),c.current=e);const t=se[n],i=u(p),a=p.map(((e,t)=>({name:e.name,type:"line",smooth:!1,symbol:"none",lineStyle:{width:2,color:e.color||ie[t%ie.length]},itemStyle:{color:e.color||ie[t%ie.length]},emphasis:{lineStyle:{width:3}},data:e.data.map((e=>[e.timestamp,e.value])),xAxisIndex:0,yAxisIndex:0,animation:!1}))),l=x.map(((e,t)=>({name:e.name,type:"line",step:"end",smooth:!1,symbol:"none",lineStyle:{width:2,color:e.color||ie[(p.length+t)%ie.length]},itemStyle:{color:e.color||ie[(p.length+t)%ie.length]},data:e.data.map((e=>[e.timestamp,e.value])),xAxisIndex:1,yAxisIndex:1,animation:!1}))),m=Date.now(),f=m-60*t.totalMinutes*1e3,b={backgroundColor:"transparent",animation:!1,grid:g?[{left:"60px",right:"20px",top:"10px",bottom:"40px",containLabel:!1}]:[{left:"60px",right:"20px",top:"35px",bottom:x.length>0?"35%":"40px",containLabel:!1},...x.length>0?[{left:"60px",right:"20px",top:"70%",bottom:"40px",containLabel:!1}]:[]],tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"#d9d9d9",width:1}},backgroundColor:"#ffffff",borderColor:"#d9d9d9",borderWidth:1,textStyle:{color:"#000000",fontSize:11,fontFamily:"Inter, Helvetica, Arial, sans-serif"},padding:8,formatter:e=>{if(!Array.isArray(e)||0===e.length)return"";const t=e[0].value[0];let r=`<div style="font-weight: 500; margin-bottom: 6px; color: #000000;">${h(t,n)}</div>`;return e.forEach((e=>{const t=e.value[1],n=o.find((t=>t.name===e.seriesName)),i=(null==n?void 0:n.unit)||"",s="Digital"===(null==n?void 0:n.digitalAnalog)?1===t?"ON":"OFF":`${t.toFixed(2)} ${i}`;r+=`\n              <div style="display: flex; align-items: center; margin: 3px 0;">\n                <span style="display: inline-block; width: 8px; height: 8px; background: ${e.color}; border-radius: 50%; margin-right: 6px;"></span>\n                <span style="color: #595959;">${s}</span>\n              </div>\n            `})),r}},legend:{show:!1},xAxis:g?[{type:"time",gridIndex:0,min:f,max:m,axisLabel:{formatter:e=>h(e,n),color:"#595959",fontSize:11,fontFamily:"Inter, Helvetica, Arial, sans-serif"},axisLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1}},axisTick:{show:!0,lineStyle:{color:"#e0e0e0"}},splitLine:{show:r,lineStyle:{color:"#e0e0e0",width:1}},splitNumber:t.divisions}]:[{type:"time",gridIndex:0,min:f,max:m,axisLabel:{formatter:e=>h(e,n),color:"#595959",fontSize:11,fontFamily:"Inter, Helvetica, Arial, sans-serif"},axisLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1}},axisTick:{show:!0,lineStyle:{color:"#e0e0e0"}},splitLine:{show:r,lineStyle:{color:"#e0e0e0",width:1}},splitNumber:t.divisions},...x.length>0?[{type:"time",gridIndex:1,min:f,max:m,axisLabel:{formatter:e=>h(e,n),color:"#595959",fontSize:11,fontFamily:"Inter, Helvetica, Arial, sans-serif"},axisLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1}},axisTick:{show:!0,lineStyle:{color:"#e0e0e0"}},splitLine:{show:r,lineStyle:{color:"#e0e0e0",width:1}},splitNumber:t.divisions}]:[]],yAxis:g?[{type:"value",gridIndex:0,min:0,max:1,interval:1,axisLabel:{formatter:e=>(0===e?"OFF":1===e?"ON":"").padStart(5," "),color:"#595959",fontSize:8,fontFamily:"Inter, Helvetica, Arial, sans-serif",align:"end"},axisLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1}},axisTick:{show:!0,lineStyle:{color:"#e0e0e0"}},splitLine:{show:r,lineStyle:{color:"#F0F0F0",width:.3}}}]:[{type:"value",gridIndex:0,min:i.min,max:i.max,splitNumber:10,axisLabel:{formatter:e=>Math.round(e).toString().padStart(5," "),color:"#595959",fontSize:11,fontFamily:"Inter, Helvetica, Arial, sans-serif",align:"right"},axisLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1}},axisTick:{show:!0,lineStyle:{color:"#e0e0e0"}},splitLine:{show:r,lineStyle:{color:"#e0e0e0",width:1}}},...x.length>0?[{type:"value",gridIndex:1,min:-.1,max:1.1,interval:1,axisLabel:{formatter:e=>0===e?"OFF":1===e?"ON":"",color:"#595959",fontSize:11,fontFamily:"Inter, Helvetica, Arial, sans-serif"},axisLine:{show:!0,lineStyle:{color:"#e0e0e0",width:1}},axisTick:{show:!0,lineStyle:{color:"#e0e0e0"}},splitLine:{show:r,lineStyle:{color:"#e0e0e0",width:1}}}]:[]],dataZoom:[{type:"inside",xAxisIndex:g?[0]:[0,...x.length>0?[1]:[]],filterMode:"none",zoomOnMouseWheel:"ctrl",moveOnMouseMove:"shift"}],series:g?x.map(((e,t)=>({name:e.name,type:"line",step:"end",smooth:!1,symbol:"none",lineStyle:{width:2,color:e.color||ie[t%ie.length]},itemStyle:{color:e.color||ie[t%ie.length]},data:e.data.map((e=>[e.timestamp,e.value])),xAxisIndex:0,yAxisIndex:0,animation:!1}))):[...a,...l]};e.setOption(b,!0),s&&e.on("datazoom",(()=>{const t=e.getOption().xAxis;t&&t[0]&&s(t[0].min,t[0].max)}));const v=()=>{null==e||e.resize()};return window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v),null==e||e.off("datazoom")}}),[o,n,r,p,x,u,h,s]),t.exports.useEffect((()=>()=>{var e;null==(e=c.current)||e.dispose(),c.current=null}),[]),e.exports.jsx("div",{ref:d,className:`${l.chartContainer} ${g?l.chartContainerOscilloscope:l.chartContainerMain}`})};class le{static async getTrendHistory(e){try{const t=await fetch(`${i}/api/t3_device/devices/${e.serial_number}/trendlogs/${e.trendlog_id}/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Failed to fetch trend history: ${t.statusText}`);return await t.json()}catch(t){throw console.error("âŒ Error fetching trend history:",t),t}}static async getRealtimeData(e,t,o){try{const n=await fetch(`${i}/api/t3_device/trendlog-data/realtime`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({serial_number:e,panel_id:t,points:o})});if(!n.ok)throw new Error(`Failed to fetch realtime data: ${n.statusText}`);return await n.json()}catch(n){throw console.error("âŒ Error fetching realtime data:",n),n}}static async storeRealtimeData(e){try{const t=await fetch(`${i}/api/t3_device/trendlog-data/realtime/batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Failed to store realtime data: ${t.statusText}`)}catch(t){throw console.error("âŒ Error storing realtime data:",t),t}}}const de=s({container:{display:"flex",flexDirection:"column",height:"100%",backgroundColor:a.colorNeutralBackground1,gap:"0",overflow:"hidden"},topControlsBar:{padding:"8px 12px",backgroundColor:a.colorNeutralBackground2,borderBottom:`1px solid ${a.colorNeutralStroke1}`,flexShrink:0},controlsMainFlex:{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},analogArea:{display:"flex",flexDirection:"row",flex:2,minHeight:"200px",gap:"6px",overflow:"hidden",padding:"4px",backgroundColor:"#f5f5f5",border:`1px solid ${a.colorNeutralStroke1}`,borderRadius:"4px"},leftPanel:{width:"clamp(210px, 23vw, 330px)",backgroundColor:"#fafafa",border:`1px solid ${a.colorNeutralStroke2}`,borderRadius:"0px",overflowY:"auto",overflowX:"hidden",flexShrink:0,display:"flex",flexDirection:"column",position:"relative"},rightPanel:{flex:1,backgroundColor:"#fafafa",border:"none",borderRadius:"0px",display:"flex",flexDirection:"column",minWidth:"200px",overflowY:"auto",overflowX:"hidden"},resizableDivider:{height:"3px",background:"linear-gradient(to bottom, #e1e4e8 0%, #d1d5da 50%, #e1e4e8 100%)",cursor:"row-resize",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",zIndex:10,transition:"background 0.2s ease",":hover":{background:"linear-gradient(to bottom, #c6cbd1 0%, #959da5 50%, #c6cbd1 100%)"}},dividerGrip:{width:"40px",height:"1.5px",background:"#959da5",borderRadius:"2px",boxShadow:"0 -1px 0 rgba(255, 255, 255, 0.5), 0 1px 0 rgba(255, 255, 255, 0.5)"},digitalArea:{flex:1,minHeight:"150px",backgroundColor:"#f5f5f5",border:`1px solid ${a.colorNeutralStroke1}`,borderRadius:"4px",padding:"4px",display:"flex",flexDirection:"row",gap:"6px",overflow:"hidden"},digitalLeftPanel:{width:"clamp(210px, 23vw, 330px)",backgroundColor:"#fafafa",border:`1px solid ${a.colorNeutralStroke2}`,borderRadius:"0px",overflowY:"auto",overflowX:"hidden",flexShrink:0,display:"flex",flexDirection:"column",position:"relative"},digitalRightPanel:{flex:1,backgroundColor:"#fafafa",border:"none",borderRadius:"0px",display:"flex",flexDirection:"column",minWidth:"200px",overflowY:"auto",overflowX:"hidden"},seriesPanelHeader:{padding:"4px",backgroundColor:"transparent",display:"flex",flexDirection:"column",gap:"8px",flexShrink:0},seriesPanelToolbar:{padding:"4px",backgroundColor:"#ffffff",borderBottom:`1px solid ${a.colorNeutralStroke1}`,display:"flex",flexDirection:"column",gap:"8px",flexShrink:0},headerLine:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},headerControls:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",width:"100%"},leftControls:{display:"flex",alignItems:"center",gap:"6px",paddingLeft:"2px"},autoScrollToggle:{display:"flex",alignItems:"center",gap:"2px",flexShrink:0,whiteSpace:"nowrap"},seriesPanel:{flex:1,display:"flex",flexDirection:"column",gap:"0",padding:"4px",backgroundColor:a.colorNeutralBackground1,overflowY:"auto",overflowX:"hidden",minHeight:0,border:`1px solid ${a.colorNeutralStroke2}`,borderTop:"none"},seriesItem:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 12px",backgroundColor:"transparent",borderBottom:`1px solid ${a.colorNeutralStroke2}`,fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease",position:"relative",minHeight:"48px",":hover":{backgroundColor:a.colorNeutralBackground1Hover},":last-child":{borderBottom:"none"}},seriesItemExpanded:{backgroundColor:a.colorNeutralBackground1Hover},deleteButton:{position:"absolute",top:"6px",right:"6px",minWidth:"24px",width:"24px",height:"24px",padding:"0",zIndex:2,backgroundColor:a.colorNeutralBackground1,borderRadius:a.borderRadiusCircular,":hover":{backgroundColor:a.colorPaletteRedBackground3,color:a.colorNeutralForegroundOnBrand}},colorIndicator:{width:"20px",height:"20px",borderRadius:a.borderRadiusMedium,flexShrink:0,border:`2px solid ${a.colorNeutralStroke1}`,cursor:"pointer",transition:"all 0.2s ease",position:"relative",boxShadow:a.shadow4,backgroundColor:"var(--series-color)",":hover":{transform:"scale(1.1)",boxShadow:a.shadow8}},digitalSeriesLabel:{fontSize:"11px",fontWeight:a.fontWeightBold,marginBottom:"4px",color:"var(--series-color)"},keyboardBadge:{position:"absolute",top:"-6px",right:"-6px",fontSize:"9px",fontWeight:a.fontWeightBold,backgroundColor:a.colorBrandBackground,color:a.colorNeutralForegroundOnBrand,padding:"1px 4px",borderRadius:a.borderRadiusCircular,minWidth:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",border:`2px solid ${a.colorNeutralBackground1}`,boxShadow:a.shadow4},seriesItemContent:{flex:1,minWidth:0,overflow:"hidden",display:"flex",alignItems:"center",gap:"8px"},seriesItemInfo:{flex:1,minWidth:0,overflow:"hidden"},seriesItemName:{display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:a.fontWeightSemibold,fontSize:"12px"},seriesItemMeta:{display:"flex",alignItems:"center",gap:"8px",marginTop:"4px",flexWrap:"wrap"},seriesItemUnit:{color:a.colorNeutralForeground3,fontSize:"11px",fontWeight:a.fontWeightMedium},expandButton:{minWidth:"24px",width:"24px",height:"24px",padding:"0",flexShrink:0,":hover":{backgroundColor:a.colorNeutralBackground1Pressed}},seriesDetails:{padding:"4px 8px 4px 5px",backgroundColor:a.colorNeutralBackground2,borderBottom:`1px solid ${a.colorNeutralStroke2}`,fontSize:"11px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"2px 8px",color:a.colorNeutralForeground2},seriesStats:{display:"contents"},dataSourceIndicator:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",marginLeft:"auto"},colorBox:{width:"14px",height:"14px",borderRadius:"3px",flexShrink:0,border:`1px solid ${a.colorNeutralStroke2}`},chartViewerContainer:{flex:1,display:"flex",flexDirection:"column",minHeight:0,minWidth:0,backgroundColor:a.colorNeutralBackground1,overflow:"hidden",border:`1px solid ${a.colorNeutralStroke1}`,borderRadius:a.borderRadiusMedium},chartViewerHeader:{display:"flex",flexDirection:"column",backgroundColor:a.colorNeutralBackground2,borderBottom:`2px solid ${a.colorNeutralStroke1}`},chartTitle:{padding:"12px 16px 8px 16px",borderBottom:`1px solid ${a.colorNeutralStroke1}`},toolbar:{display:"flex",alignItems:"center",gap:"12px",padding:"8px 2px",flexWrap:"wrap",minHeight:"40px"},chartContainer:{flex:1,display:"flex",flexDirection:"column",minHeight:0,padding:"16px"},oscilloscopeContainer:{display:"flex",flexDirection:"column",width:"100%",height:"100%",gap:"8px"},combinedAnalogChart:{flex:1,minHeight:"300px",position:"relative"},channelChart:{display:"flex",flexDirection:"column",height:"100px",flexShrink:0,position:"relative",borderTop:`1px solid ${a.colorNeutralStroke2}`,paddingTop:"8px"},lastChannel:{borderBottom:`1px solid ${a.colorNeutralStroke2}`,paddingBottom:"8px"},channelLabel:{fontSize:"12px",fontWeight:a.fontWeightSemibold,marginBottom:"4px",paddingLeft:"8px"},controlGroup:{display:"flex",alignItems:"center",gap:"6px"},controlGroupWithIndicator:{display:"flex",alignItems:"center",gap:"6px",paddingLeft:"8px",borderLeft:`3px solid ${a.colorBrandBackground}`,height:"16px"},timeBaseDropdown:{border:"none",borderBottom:`1px solid ${a.colorNeutralStroke1}`,borderRadius:0,"& button":{border:"none",borderBottom:`1px solid ${a.colorNeutralStroke1}`,borderRadius:0}},controlLabel:{fontSize:"11px",fontWeight:a.fontWeightRegular,whiteSpace:"nowrap"},divider:{width:"1px",height:"24px",backgroundColor:a.colorNeutralStroke1,flexShrink:0},statusTags:{display:"flex",alignItems:"center",gap:"6px"},statusTag:{padding:"2px 10px",borderRadius:"4px",fontSize:"11px",fontWeight:"500",fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',display:"inline-flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",border:"1px solid",transition:"all 0.2s ease"},statusTagLive:{backgroundColor:"#f6ffed",border:"1px solid #b7eb8f",color:"#389e0d"},statusTagHistorical:{backgroundColor:"#e6f7ff",border:"1px solid #91d5ff",color:"#0958d9"},statusTagTimeBase:{backgroundColor:"#f5f5f5",border:"1px solid #d9d9d9",color:"#595959"},liveIndicator:{fontSize:"10px",animation:"pulse 1.5s ease-in-out infinite"},spacer:{flex:1},emptyState:{padding:"24px",textAlign:"center"},emptyStateCenter:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",flexDirection:"column",gap:"16px"},resizer:{width:"4px",cursor:"col-resize",backgroundColor:"#e1e1e1",transition:"background-color 0.2s",flexShrink:0,"&:hover":{backgroundColor:"#0078d4"}}}),ce=["#FF0000","#0000FF","#00AA00","#FF8000","#AA00AA","#CC6600","#AA0000","#0066AA","#AA6600","#6600AA","#006600","#FF6600","#0000AA","#FF00FF","#008080","#800080","#808000","#FF1493","#4B0082","#DC143C","#00AAAA","#00CED1","#8B4513","#2F4F4F","#B22222"],pe=n=>{var r,s;const F=de(),{selectedDevice:O}=l(),B=n.serialNumber||(null==O?void 0:O.serialNumber),R=n.panelId||(null==O?void 0:O.panelId)||1,M=n.trendlogId||"0",U=n.isDrawerMode||!1,W=n.onToolbarRender,[H,V]=t.exports.useState([]),[G,q]=t.exports.useState("5m"),[Y]=t.exports.useState(!0),[J,Z]=t.exports.useState(!0),[Q,K]=t.exports.useState(!1),[ee,te]=t.exports.useState(1),[oe,ne]=t.exports.useState(new Set),[re,ie]=t.exports.useState("loading"),se=t.exports.useRef(null),pe=t.exports.useRef(0),xe=t.exports.useRef(null),ge=t.exports.useRef(null),ue=t.exports.useRef(!1),he=t.exports.useMemo((()=>H.filter((e=>"Analog"===e.digitalAnalog&&!1!==e.visible))),[H]),me=t.exports.useMemo((()=>H.filter((e=>"Digital"===e.digitalAnalog&&!1!==e.visible))),[H]),fe=t.exports.useMemo((()=>H.filter((e=>"Analog"===e.digitalAnalog))),[H]),be=t.exports.useMemo((()=>H.filter((e=>"Digital"===e.digitalAnalog))),[H]),ve=t.exports.useCallback((e=>{ne((t=>{const o=new Set(t);return o.has(e)?o.delete(e):o.add(e),o}))}),[]),je=t.exports.useCallback(((e,t)=>t||e||"N/A"),[]),ye=t.exports.useCallback((()=>{let e=1/0,t=-1/0,o=0;return H.forEach((n=>{n.data.forEach((n=>{n.timestamp<e&&(e=n.timestamp),n.timestamp>t&&(t=n.timestamp),o++}))})),0===o?null:{earliest:e,latest:t,totalPoints:o}}),[H]),Ie=t.exports.useCallback((async()=>{if(B&&R)if(0!==H.length){K(!0);try{const e=Date.now();let t=e-{"5m":3e5,"10m":6e5,"30m":18e5,"1h":36e5,"4h":144e5,"12h":432e5,"1d":864e5,"4d":3456e5}[G],o=e;const n=ye();if(n){if(console.log("ðŸ“Š TrendChartContent: Existing data detected - optimizing load range",{requestedRange:{start:new Date(t).toISOString(),end:new Date(o).toISOString()},existingRange:{start:new Date(n.earliest).toISOString(),end:new Date(n.latest).toISOString()}}),!(t<n.earliest))return console.log("ï¿½?TrendChartContent: All requested data already exists in memory - skipping database load"),void K(!1);o=n.earliest-1e3,console.log("ðŸ” TrendChartContent: Loading historical gap BEFORE existing data",{gapStart:new Date(t).toISOString(),gapEnd:new Date(o).toISOString()})}const r=e=>{const t=new Date(e);return`${t.getUTCFullYear()}-${String(t.getUTCMonth()+1).padStart(2,"0")}-${String(t.getUTCDate()).padStart(2,"0")} ${String(t.getUTCHours()).padStart(2,"0")}:${String(t.getUTCMinutes()).padStart(2,"0")}:${String(t.getUTCSeconds()).padStart(2,"0")}`},i={serial_number:B,panel_id:R,trendlog_id:M,start_time:r(t),end_time:r(o),limit:1e4,point_types:["INPUT","OUTPUT","VARIABLE","MONITOR"],specific_points:H.map((e=>({point_id:e.pointId,point_type:e.pointType,point_index:e.pointIndex,panel_id:R})))};console.log("ðŸ“¥ TrendChartContent: Fetching historical data",i);const s=await le.getTrendHistory(i);console.log("ï¿½?TrendChartContent: Historical data received",{totalRecords:s.total_records,dataPoints:s.data.length});const a=[...H];s.data.forEach((e=>{const t=a.findIndex((t=>t.pointId===e.point_id&&t.pointType===e.point_type));if(-1!==t){const o=new Date(e.timestamp).getTime();a[t].data.some((e=>e.timestamp===o))||a[t].data.push({timestamp:o,value:e.value}),o>pe.current&&(pe.current=o)}})),a.forEach((e=>{e.data.sort(((e,t)=>e.timestamp-t.timestamp))})),V(a),ie("api")}catch(e){console.error("ï¿½?TrendChartContent: Failed to load historical data",e),ie("error")}finally{K(!1)}}else console.warn("âš ï¸ TrendChartContent: No series initialized yet");else console.warn("âš ï¸ TrendChartContent: Missing serialNumber or panelId")}),[B,R,M,G,H,ye]),Ce=t.exports.useCallback((async()=>{var e,t,o,r;if(B&&R)try{if(n.monitorInputs&&n.monitorInputs.length>0){console.log("âœ… TrendChartContent: Initializing series from monitorInputs",{inputCount:n.monitorInputs.length,sampleInput:n.monitorInputs[0],serialNumber:B,panelId:R});const e={};try{const t=new Set(n.monitorInputs.map((e=>"IN"===e.pointType?"INPUT":"OUT"===e.pointType?"OUTPUT":"VARIABLE"))),o=Array.from(t).map((async t=>{const o=`${i}/api/t3_device/devices/${B}/${"INPUT"===t?"input-points":"OUTPUT"===t?"output-points":"variable-points"}`;console.log(`ðŸ“¡ Fetching ${t} points from:`,o);const n=await fetch(o);if(n.ok){const o=await n.json(),r="INPUT"===t?"input_points":"OUTPUT"===t?"output_points":"variable_points";e[t]=o[r]||[],console.log(`âœ… Fetched ${e[t].length} ${t} points`)}else console.error(`âŒ Failed to fetch ${t} points:`,n.status),e[t]=[]}));await Promise.all(o)}catch(s){console.error("âŒ Error fetching point data:",s)}const t=n.monitorInputs.map(((t,o)=>{const n="IN"===t.pointType?"INPUT":"OUT"===t.pointType?"OUTPUT":"VAR"===t.pointType?"VARIABLE":"INPUT",r=t.pointType,i=parseInt(t.pointIndex,10),s=`${r}${i}`;let a="Analog";const l=(e[n]||[]).find((e=>parseInt(e.inputIndex||e.outputIndex||e.variableIndex||"0",10)===i));if(l&&void 0!==l.digitalAnalog&&null!==l.digitalAnalog){const e=l.digitalAnalog;a="0"===e||0===e?"Digital":"Analog",console.log(`âœ… [${s}] Classified as ${a} (raw: ${e})`)}else console.warn(`âš ï¸ [${s}] No digitalAnalog field, defaulting to Analog`);return{name:t.pointLabel||s,pointId:s,pointType:n,pointIndex:i,data:[],color:ce[o%ce.length],unit:"",digitalAnalog:a,visible:!0}}));return V(t),void console.log("âœ… TrendChartContent: Series initialized from monitorInputs",{count:t.length,serialNumber:B,panelId:R,digitalCount:t.filter((e=>"Digital"===e.digitalAnalog)).length,analogCount:t.filter((e=>"Analog"===e.digitalAnalog)).length})}if((null==(t=null==(e=n.itemData)?void 0:e.t3Entry)?void 0:t.input)&&(null==(r=null==(o=n.itemData)?void 0:o.t3Entry)?void 0:r.range)){const e=n.itemData.t3Entry.input,t=n.itemData.t3Entry.range;console.log("ï¿½?TrendChartContent: Initializing series from itemData",{inputCount:e.length,rangeCount:t.length});const o=[],r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const r=e[n],i=t[n],s=r.point_type,a=r.point_number,l=0===s?"INPUT":1===s?"OUTPUT":"VARIABLE",d=`${0===s?"IN":1===s?"OUT":"VAR"}${a+1}`,c=0===i.digital_analog?"Analog":"Digital";o.push({name:d,pointId:d,pointType:l,pointIndex:a+1,data:[],color:ce[n%ce.length],unit:i.units||"",digitalAnalog:c,visible:!0})}return V(o),void console.log("ï¿½?TrendChartContent: Series initialized from itemData",{count:o.length,serialNumber:B,panelId:R})}console.log("âš ï¸ TrendChartContent: No itemData available, using sample series");const a=[{name:"IN1",pointId:"IN1",pointType:"INPUT",pointIndex:1,data:[],color:ce[0],unit:"Â°C",digitalAnalog:"Analog",visible:!0},{name:"IN2",pointId:"IN2",pointType:"INPUT",pointIndex:2,data:[],color:ce[1],unit:"Â°C",digitalAnalog:"Analog",visible:!0},{name:"OUT1",pointId:"OUT1",pointType:"OUTPUT",pointIndex:1,data:[],color:ce[2],unit:"%",digitalAnalog:"Analog",visible:!0}];V(a),console.log("ï¿½?TrendChartContent: Series initialized",{count:a.length,serialNumber:B,panelId:R})}catch(a){console.error("ï¿½?TrendChartContent: Failed to initialize series",a)}}),[B,R,n.itemData]),Ne=t.exports.useCallback((async()=>{if(J&&B&&R&&0!==H.length)try{const e=H.map((e=>({point_id:e.pointId,point_type:e.pointType,point_index:e.pointIndex,panel_id:R}))),t=await le.getRealtimeData(B,R,e);if(t.length>0){const e=[...H];t.forEach((t=>{const o=e.findIndex((e=>e.pointId===t.point_id&&e.pointType===t.point_type));if(-1!==o){const n=new Date(t.timestamp).getTime();e[o].data.some((e=>e.timestamp===n))||e[o].data.push({timestamp:n,value:t.value});const r={"5m":3e5,"10m":6e5,"30m":18e5,"1h":36e5,"4h":144e5,"12h":432e5,"1d":864e5,"4d":3456e5},i=Date.now()-r[G];e[o].data=e[o].data.filter((e=>e.timestamp>=i)),e[o].data.sort(((e,t)=>e.timestamp-t.timestamp))}})),V(e),ie("realtime")}}catch(e){console.error("ï¿½?TrendChartContent: Realtime update failed",e),ie("error")}}),[J,B,R,H,G]);t.exports.useEffect((()=>{const e=async()=>{if(!document.hidden&&J&&pe.current>0){const e=Date.now(),t=Math.floor((e-pe.current)/1e3);t>=10&&(console.log("ðŸ”„ TrendChartContent: Backfilling data gap",{gapSeconds:t,lastTimestamp:new Date(pe.current).toISOString()}),await Ie())}};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[J,Ie]),t.exports.useEffect((()=>{(async()=>{console.log("ðŸš€ TrendChartContent: Starting initialization sequence"),await Ce(),console.log("ï¿½?TrendChartContent: Series initialized, waiting for series state update"),await new Promise((e=>setTimeout(e,100))),console.log("ï¿½?TrendChartContent: Series state updated, loading historical data"),await Ie(),ue.current=!0,console.log("ï¿½?TrendChartContent: Initialization completed")})()}),[]),t.exports.useEffect((()=>{if(0!==H.length){if(ue.current)return xe.current&&(clearTimeout(xe.current),console.log("â¸ï¸ TrendChartContent: Cancelled pending timebase change")),ge.current&&(ge.current.abort(),console.log("ðŸ›‘ TrendChartContent: Aborted previous history API request")),xe.current=setTimeout((async()=>{console.log("ï¿½?TrendChartContent: TimeBase changed - loading data",{timeBase:G,isRealtime:J,seriesCount:H.length});try{ge.current=new AbortController;const e=ye();e&&e.totalPoints>0&&console.log("ï¿½?TrendChartContent: Existing data found - merging with historical",{existingPoints:null==e?void 0:e.totalPoints}),J?(console.log("ðŸ“Š TrendChartContent: Auto Scroll ON - Loading historical + starting real-time"),await Ie(),se.current||(console.log("ðŸ”„ TrendChartContent: Starting real-time updates"),se.current=setInterval(Ne,5e3))):(console.log("ðŸ“š TrendChartContent: Auto Scroll OFF - Loading historical only"),se.current&&(clearInterval(se.current),se.current=null),await Ie()),console.log("ï¿½?TrendChartContent: Timebase change completed",{timeBase:G,isRealtime:J,totalPoints:H.reduce(((e,t)=>e+t.data.length),0)})}catch(e){if("AbortError"===e.name)return void console.log("â¹ï¸ TrendChartContent: History request aborted (newer request started)");console.error("ï¿½?TrendChartContent: Error loading data for new timebase:",e),ie("error")}}),300),()=>{xe.current&&clearTimeout(xe.current),ge.current&&ge.current.abort()};console.log("âš ï¸ TrendChartContent: Initial data not loaded yet, skipping timebase effect")}else console.log("âš ï¸ TrendChartContent: No series yet, skipping timebase effect")}),[G,J]),t.exports.useEffect((()=>{if(ue.current)return console.log("ðŸ”„ TrendChartContent: Auto Scroll state changed",{isRealtime:J}),J?se.current||(console.log("â–¶ï¸ TrendChartContent: Starting real-time updates interval"),se.current=setInterval((()=>{Ne()}),5e3)):se.current&&(console.log("â¸ï¸ TrendChartContent: Stopping real-time updates interval"),clearInterval(se.current),se.current=null),()=>{se.current&&(clearInterval(se.current),se.current=null)};console.log("â¸ï¸ TrendChartContent: Skipping Auto Scroll effect - not initialized yet")}),[J]);const Se=t.exports.useCallback(((e,t)=>{V((o=>{const n=[...o];return n[e].visible=void 0!==t?t:!n[e].visible,n}))}),[]),Te=t.exports.useCallback((()=>{V((e=>e.map((e=>({...e,visible:!0})))))}),[]),we=t.exports.useCallback((()=>{V((e=>e.map((e=>({...e,visible:!1})))))}),[]),_e=t.exports.useCallback((e=>{V((t=>{const o=t.filter((t=>t.digitalAnalog===e)).every((e=>e.visible));return t.map((t=>t.digitalAnalog===e?{...t,visible:!o}:t))}))}),[]),ke=t.exports.useCallback((e=>{V((t=>{const o=t.filter((t=>t.pointType===e)).every((e=>e.visible));return t.map((t=>t.pointType===e?{...t,visible:!o}:t))}))}),[]),Ae=t.exports.useMemo((()=>({analog:H.filter((e=>"Analog"===e.digitalAnalog)).length,digital:H.filter((e=>"Digital"===e.digitalAnalog)).length,input:H.filter((e=>"INPUT"===e.pointType)).length,output:H.filter((e=>"OUTPUT"===e.pointType)).length,variable:H.filter((e=>"VARIABLE"===e.pointType)).length,allEnabled:H.every((e=>e.visible)),allDisabled:H.every((e=>!e.visible)),analogEnabled:H.filter((e=>"Analog"===e.digitalAnalog)).every((e=>e.visible)),digitalEnabled:H.filter((e=>"Digital"===e.digitalAnalog)).every((e=>e.visible)),inputEnabled:H.filter((e=>"INPUT"===e.pointType)).every((e=>e.visible)),outputEnabled:H.filter((e=>"OUTPUT"===e.pointType)).every((e=>e.visible)),variableEnabled:H.filter((e=>"VARIABLE"===e.pointType)).every((e=>e.visible))})),[H]),$e=["5m","10m","30m","1h","4h","12h","1d","4d"],ze=t.exports.useCallback((()=>{const e=$e.indexOf(G);e>0&&q($e[e-1])}),[G]),Le=t.exports.useCallback((()=>{const e=$e.indexOf(G);e<$e.length-1&&q($e[e+1])}),[G]),De=t.exports.useCallback((()=>{q("5m")}),[]),Ee=t.exports.useCallback((()=>{console.log("Export to PNG - Not yet implemented")}),[]),Pe=t.exports.useCallback((()=>{const e=H.map((e=>({name:e.name,pointType:e.pointType,pointIndex:e.pointIndex,unit:e.unit,data:e.data.map((e=>({timestamp:new Date(e.timestamp).toISOString(),value:e.value})))}))),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),o=URL.createObjectURL(t),n=document.createElement("a");n.href=o,n.download=`trend_data_${B}_${(new Date).toISOString()}.json`,n.click(),URL.revokeObjectURL(o)}),[H,B]),Fe=t.exports.useCallback((()=>{const e=[],t=["Timestamp",...H.map((e=>`${e.name} (${e.unit||""})`))];e.push(t.join(","));const o=new Set;H.forEach((e=>{e.data.forEach((e=>o.add(e.timestamp)))}));Array.from(o).sort(((e,t)=>e-t)).forEach((t=>{const o=[new Date(t).toISOString()];H.forEach((e=>{const n=e.data.find((e=>e.timestamp===t));o.push(n?n.value.toFixed(2):"")})),e.push(o.join(","))}));const n=new Blob([e.join("\n")],{type:"text/csv"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`trend_data_${B}_${(new Date).toISOString()}.csv`,i.click(),URL.revokeObjectURL(r)}),[H,B]),Oe=t.exports.useMemo((()=>e.exports.jsxs("div",{className:F.toolbar,children:[e.exports.jsxs("div",{className:F.controlGroupWithIndicator,children:[e.exports.jsx(d,{className:F.controlLabel,children:"Time Base:"}),e.exports.jsxs(c,{value:G,selectedOptions:[G],onOptionSelect:(e,t)=>q(t.optionValue),size:"small",className:F.timeBaseDropdown,style:{fontSize:"11px",minWidth:"100px",fontWeight:"normal"},children:[e.exports.jsx(p,{value:"5m",style:{fontSize:"11px"},children:"5 minutes"}),e.exports.jsx(p,{value:"10m",style:{fontSize:"11px"},children:"10 minutes"}),e.exports.jsx(p,{value:"30m",style:{fontSize:"11px"},children:"30 minutes"}),e.exports.jsx(p,{value:"1h",style:{fontSize:"11px"},children:"1 hour"}),e.exports.jsx(p,{value:"4h",style:{fontSize:"11px"},children:"4 hours"}),e.exports.jsx(p,{value:"12h",style:{fontSize:"11px"},children:"12 hours"}),e.exports.jsx(p,{value:"1d",style:{fontSize:"11px"},children:"1 day"}),e.exports.jsx(p,{value:"4d",style:{fontSize:"11px"},children:"4 days"})]})]}),e.exports.jsx("div",{className:F.divider}),e.exports.jsxs("div",{className:F.controlGroup,children:[e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(g,{fontSize:16}),onClick:()=>console.log("Move time left"),disabled:J||Q,size:"small",style:{minWidth:"20px",padding:"2px",width:"20px"}}),e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(u,{fontSize:16}),onClick:()=>console.log("Move time right"),disabled:J||Q,size:"small",style:{minWidth:"20px",padding:"2px",width:"20px"}})]}),e.exports.jsxs("div",{className:F.controlGroup,children:[e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(h,{fontSize:16}),onClick:ze,disabled:Q,size:"small",style:{fontSize:"11px",padding:"2px 6px",fontWeight:"normal"},children:"Zoom In"}),e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(m,{fontSize:16}),onClick:Le,disabled:Q,size:"small",style:{fontSize:"11px",padding:"2px 6px",fontWeight:"normal"},children:"Zoom Out"})]}),e.exports.jsx("div",{className:F.controlGroup,children:e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(f,{fontSize:16}),onClick:De,disabled:Q,size:"small",style:{fontSize:"11px",padding:"2px 6px",fontWeight:"normal"},children:"Reset"})}),e.exports.jsx("div",{className:F.divider}),e.exports.jsxs("div",{className:F.controlGroup,children:[e.exports.jsx(x,{appearance:1===ee?"primary":"subtle",onClick:()=>te(1),disabled:Q,size:"small",style:{fontSize:"11px",padding:"4px 8px",fontWeight:"normal"},children:"View 1"}),e.exports.jsx(x,{appearance:2===ee?"primary":"subtle",onClick:()=>te(2),disabled:Q,size:"small",style:{fontSize:"11px",padding:"4px 8px",fontWeight:"normal"},children:"View 2"}),e.exports.jsx(x,{appearance:3===ee?"primary":"subtle",onClick:()=>te(3),disabled:Q,size:"small",style:{fontSize:"11px",padding:"4px 8px",fontWeight:"normal"},children:"View 3"}),1!==ee&&e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(b,{}),onClick:()=>console.log("Reconfigure tracked items"),disabled:Q,size:"small",title:"Reconfigure tracked items",style:{fontSize:"9px",padding:"4px",minWidth:"24px"}})]}),e.exports.jsx("div",{className:F.divider}),e.exports.jsxs("div",{className:F.statusTags,children:[e.exports.jsx("div",{className:`${F.statusTag} ${J?F.statusTagLive:F.statusTagHistorical}`,children:J?e.exports.jsxs(e.exports.Fragment,{children:[e.exports.jsx("span",{className:F.liveIndicator,children:"â—"}),`Live-${(new Date).toLocaleTimeString("en-US",{hour12:!1})}`]}):"Historical"}),e.exports.jsx("div",{className:`${F.statusTag} ${F.statusTagTimeBase}`,children:"5m"===G?"5 minutes":"10m"===G?"10 minutes":"30m"===G?"30 minutes":"1h"===G?"1 hour":"4h"===G?"4 hours":"12h"===G?"12 hours":"1d"===G?"1 day":"4d"===G?"4 days":G})]}),e.exports.jsx("div",{className:F.divider}),e.exports.jsx("div",{className:F.controlGroup,children:e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(v,{}),onClick:()=>console.log("Config - Not yet implemented"),disabled:Q,size:"small",style:{fontSize:"11px",padding:"4px 8px",fontWeight:"normal"},children:"Config"})}),e.exports.jsx("div",{className:F.controlGroup,children:e.exports.jsxs(j,{children:[e.exports.jsx(y,{disableButtonEnhancement:!0,children:e.exports.jsx(x,{appearance:"subtle",icon:e.exports.jsx(I,{}),disabled:Q,size:"small",style:{fontSize:"11px",padding:"4px 8px",fontWeight:"normal"},children:"Export"})}),e.exports.jsx(C,{children:e.exports.jsxs(N,{children:[e.exports.jsx(S,{icon:e.exports.jsx(T,{}),onClick:Ee,children:"Export as PNG"}),e.exports.jsx(S,{icon:e.exports.jsx(I,{}),onClick:Fe,children:"Export as CSV"}),e.exports.jsx(S,{icon:e.exports.jsx(I,{}),onClick:Pe,children:"Export as JSON"})]})})]})}),Q&&e.exports.jsx(w,{size:"tiny"})]})),[G,ee,J,Q,ze,Le,De,Ee,Fe,Pe]);return t.exports.useEffect((()=>(U&&W&&W(Oe),()=>{U&&W&&W(null)})),[Oe,U,W]),e.exports.jsxs("div",{className:F.container,children:[he.length>0&&e.exports.jsxs("div",{className:F.analogArea,children:[e.exports.jsxs("div",{className:F.leftPanel,children:[e.exports.jsxs("div",{className:F.seriesPanelHeader,children:[e.exports.jsxs("div",{className:F.headerLine,children:[e.exports.jsxs(d,{size:200,weight:"semibold",children:[(null==(r=n.itemData)?void 0:r.title)||"Trend Monitor"," (",he.length,"/",fe.length,")"]}),e.exports.jsxs("div",{className:F.dataSourceIndicator,children:["loading"===re&&e.exports.jsx(_,{appearance:"tint",color:"informative",size:"small",children:"Loading..."}),"realtime"===re&&e.exports.jsx(_,{appearance:"filled",color:"success",size:"small",icon:e.exports.jsx(k,{}),children:"Live"}),"api"===re&&e.exports.jsx(_,{appearance:"filled",color:"informative",size:"small",icon:e.exports.jsx(A,{}),children:"Historical"}),"error"===re&&e.exports.jsx(_,{appearance:"filled",color:"danger",size:"small",icon:e.exports.jsx($,{}),children:"Error"})]})]}),e.exports.jsxs("div",{className:F.headerControls,children:[e.exports.jsxs("div",{className:F.leftControls,children:[e.exports.jsxs(j,{children:[e.exports.jsx(y,{disableButtonEnhancement:!0,children:e.exports.jsx(x,{size:"small",appearance:"subtle",icon:e.exports.jsx(z,{}),iconPosition:"after",children:"All"})}),e.exports.jsx(C,{children:e.exports.jsxs(N,{children:[e.exports.jsx(S,{onClick:Te,disabled:Ae.allEnabled,children:"Enable All"}),e.exports.jsx(S,{onClick:we,disabled:Ae.allDisabled,children:"Disable All"})]})})]}),e.exports.jsxs(j,{children:[e.exports.jsx(y,{disableButtonEnhancement:!0,children:e.exports.jsx(x,{size:"small",appearance:"subtle",icon:e.exports.jsx(z,{}),iconPosition:"after",children:"By Type"})}),e.exports.jsx(C,{children:e.exports.jsxs(N,{children:[e.exports.jsxs(S,{onClick:()=>_e("Analog"),disabled:0===Ae.analog,children:[Ae.analogEnabled?"Disable":"Enable"," Analog (",Ae.analog,")"]}),e.exports.jsxs(S,{onClick:()=>_e("Digital"),disabled:0===Ae.digital,children:[Ae.digitalEnabled?"Disable":"Enable"," Digital (",Ae.digital,")"]}),e.exports.jsxs(S,{onClick:()=>ke("INPUT"),disabled:0===Ae.input,children:[Ae.inputEnabled?"Disable":"Enable"," Input (",Ae.input,")"]}),e.exports.jsxs(S,{onClick:()=>ke("OUTPUT"),disabled:0===Ae.output,children:[Ae.outputEnabled?"Disable":"Enable"," Output (",Ae.output,")"]}),e.exports.jsxs(S,{onClick:()=>ke("VARIABLE"),disabled:0===Ae.variable,children:[Ae.variableEnabled?"Disable":"Enable"," Variable (",Ae.variable,")"]})]})})]})]}),e.exports.jsxs("div",{className:F.autoScrollToggle,children:[e.exports.jsx(d,{size:100,children:"Auto Scroll:"}),e.exports.jsx(L,{checked:J,onChange:(e,t)=>Z(t.checked)})]})]})]}),e.exports.jsx("div",{className:F.seriesPanel,children:fe.map(((t,n)=>{const r=`${t.pointId}-${t.pointIndex}`,i=oe.has(r);return e.exports.jsxs(o.Fragment,{children:[e.exports.jsxs("div",{className:`${F.seriesItem} ${i?F.seriesItemExpanded:""}`,children:[e.exports.jsx("div",{className:F.colorIndicator,style:{"--series-color":t.color},onClick:()=>Se(n)}),e.exports.jsx(D,{content:t.name,relationship:"label",children:e.exports.jsx("div",{className:F.seriesItemContent,onClick:()=>Se(n),children:e.exports.jsxs("div",{className:F.seriesItemInfo,children:[e.exports.jsx(d,{className:F.seriesItemName,children:t.name}),e.exports.jsxs("div",{className:F.seriesItemMeta,children:[(t.prefix||t.pointType)&&e.exports.jsx(X,{size:"extra-small",appearance:"outline",children:je(t.pointType,t.prefix)}),e.exports.jsx(d,{className:F.seriesItemUnit,children:t.unit||"N/A"})]})]})})}),e.exports.jsx(x,{appearance:"subtle",icon:i?e.exports.jsx(E,{}):e.exports.jsx(P,{}),onClick:e=>{e.stopPropagation(),ve(r)},className:F.expandButton,size:"small"})]}),i&&e.exports.jsx("div",{className:F.seriesDetails,children:e.exports.jsxs("div",{className:F.seriesStats,children:[e.exports.jsxs(d,{size:100,children:[e.exports.jsx("strong",{children:"Last:"})," ",t.data&&t.data.length>0?`${t.data[t.data.length-1].value.toFixed(2)} ${t.unit||""}`:"N/A"]}),e.exports.jsxs(d,{size:100,children:[e.exports.jsx("strong",{children:"Avg:"})," ",t.data&&t.data.length>0?`${(t.data.reduce(((e,t)=>e+t.value),0)/t.data.length).toFixed(2)} ${t.unit||""}`:"N/A"]}),e.exports.jsxs(d,{size:100,children:[e.exports.jsx("strong",{children:"Min:"})," ",t.data&&t.data.length>0?`${Math.min(...t.data.map((e=>e.value))).toFixed(2)} ${t.unit||""}`:"N/A"]}),e.exports.jsxs(d,{size:100,children:[e.exports.jsx("strong",{children:"Max:"})," ",t.data&&t.data.length>0?`${Math.max(...t.data.map((e=>e.value))).toFixed(2)} ${t.unit||""}`:"N/A"]})]})})]},r)}))})]}),e.exports.jsx("div",{className:F.rightPanel,children:e.exports.jsx(ae,{series:he,timeBase:G,showGrid:Y,chartType:"analog"})})]}),he.length>0&&me.length>0&&e.exports.jsx("div",{className:F.resizableDivider,children:e.exports.jsx("div",{className:F.dividerGrip})}),me.length>0&&e.exports.jsxs("div",{className:F.digitalArea,children:[e.exports.jsxs("div",{className:F.digitalLeftPanel,children:[e.exports.jsxs("div",{className:F.seriesPanelHeader,children:[e.exports.jsxs("div",{className:F.headerLine,children:[e.exports.jsxs(d,{size:200,weight:"semibold",children:[0===fe.length&&((null==(s=n.itemData)?void 0:s.title)||"Trend Monitor")," Digital (",me.length,"/",be.length,")"]}),0===fe.length&&e.exports.jsxs("div",{className:F.dataSourceIndicator,children:["loading"===re&&e.exports.jsx(_,{appearance:"tint",color:"informative",size:"small",children:"Loading..."}),"realtime"===re&&e.exports.jsx(_,{appearance:"filled",color:"success",size:"small",icon:e.exports.jsx(k,{}),children:"Live"}),"api"===re&&e.exports.jsx(_,{appearance:"filled",color:"informative",size:"small",icon:e.exports.jsx(A,{}),children:"Historical"}),"error"===re&&e.exports.jsx(_,{appearance:"filled",color:"danger",size:"small",icon:e.exports.jsx($,{}),children:"Error"})]})]}),0===fe.length&&e.exports.jsxs("div",{className:F.headerControls,children:[e.exports.jsxs("div",{className:F.leftControls,children:[e.exports.jsxs(j,{children:[e.exports.jsx(y,{disableButtonEnhancement:!0,children:e.exports.jsx(x,{size:"small",appearance:"subtle",icon:e.exports.jsx(z,{}),iconPosition:"after",children:"All"})}),e.exports.jsx(C,{children:e.exports.jsxs(N,{children:[e.exports.jsx(S,{onClick:Te,disabled:Ae.allEnabled,children:"Enable All"}),e.exports.jsx(S,{onClick:we,disabled:Ae.allDisabled,children:"Disable All"})]})})]}),e.exports.jsxs(j,{children:[e.exports.jsx(y,{disableButtonEnhancement:!0,children:e.exports.jsx(x,{size:"small",appearance:"subtle",icon:e.exports.jsx(z,{}),iconPosition:"after",children:"By Type"})}),e.exports.jsx(C,{children:e.exports.jsxs(N,{children:[e.exports.jsxs(S,{onClick:()=>_e("Analog"),disabled:0===Ae.analog,children:[Ae.analogEnabled?"Disable":"Enable"," Analog (",Ae.analog,")"]}),e.exports.jsxs(S,{onClick:()=>_e("Digital"),disabled:0===Ae.digital,children:[Ae.digitalEnabled?"Disable":"Enable"," Digital (",Ae.digital,")"]}),e.exports.jsxs(S,{onClick:()=>ke("INPUT"),disabled:0===Ae.input,children:[Ae.inputEnabled?"Disable":"Enable"," Input (",Ae.input,")"]}),e.exports.jsxs(S,{onClick:()=>ke("OUTPUT"),disabled:0===Ae.output,children:[Ae.outputEnabled?"Disable":"Enable"," Output (",Ae.output,")"]}),e.exports.jsxs(S,{onClick:()=>ke("VARIABLE"),disabled:0===Ae.variable,children:[Ae.variableEnabled?"Disable":"Enable"," Variable (",Ae.variable,")"]})]})})]})]}),e.exports.jsxs("div",{className:F.autoScrollToggle,children:[e.exports.jsx(d,{size:100,children:"Auto Scroll:"}),e.exports.jsx(L,{checked:J,onChange:(e,t)=>Z(t.checked)})]})]})]}),e.exports.jsx("div",{className:F.seriesPanel,children:be.map(((t,n)=>{var r;const i=`digital-${t.pointId}-${t.pointIndex}`,s=oe.has(i),a=fe.length+n;return e.exports.jsxs(o.Fragment,{children:[e.exports.jsxs("div",{className:`${F.seriesItem} ${s?F.seriesItemExpanded:""}`,children:[e.exports.jsx("div",{className:F.colorIndicator,style:{"--series-color":t.color},onClick:()=>Se(a)}),e.exports.jsx(D,{content:t.name,relationship:"label",children:e.exports.jsx("div",{className:F.seriesItemContent,onClick:()=>Se(a),children:e.exports.jsxs("div",{className:F.seriesItemInfo,children:[e.exports.jsx(d,{className:F.seriesItemName,children:t.name}),e.exports.jsxs("div",{className:F.seriesItemMeta,children:[(t.prefix||t.pointType)&&e.exports.jsx(X,{size:"extra-small",appearance:"outline",children:je(t.pointType,t.prefix)}),e.exports.jsx(d,{className:F.seriesItemUnit,children:t.unit||"ON/OFF"})]})]})})}),e.exports.jsx(x,{appearance:"subtle",icon:s?e.exports.jsx(E,{}):e.exports.jsx(P,{}),onClick:e=>{e.stopPropagation(),ve(i)},className:F.expandButton,size:"small"})]}),s&&e.exports.jsx("div",{className:F.seriesDetails,children:e.exports.jsxs("div",{className:F.seriesStats,children:[e.exports.jsxs(d,{size:100,children:[e.exports.jsx("strong",{children:"Last:"})," ",t.data&&t.data.length>0?1===t.data[t.data.length-1].value?"ON":"OFF":"N/A"]}),e.exports.jsxs(d,{size:100,children:[e.exports.jsx("strong",{children:"Points:"})," ",(null==(r=t.data)?void 0:r.length)||0]})]})})]},i)}))})]}),e.exports.jsx("div",{className:F.digitalRightPanel,children:me.map((t=>e.exports.jsx("div",{className:F.channelChart,children:e.exports.jsx(ae,{series:[t],timeBase:G,showGrid:Y,chartType:"digital"})},t.name)))})]}),0===H.length&&e.exports.jsxs("div",{className:F.emptyStateCenter,children:[e.exports.jsx(d,{size:500,weight:"semibold",children:"No Data Available"}),e.exports.jsx(d,{size:300,style:{color:a.colorNeutralForeground3},children:"Please select a device and monitor configuration."})]})]})};var xe="_drawerBody_iy5ki_1",ge="_drawer_iy5ki_1",ue="_drawerHeader_iy5ki_25",he="_toolbarContainer_iy5ki_39",me="_toolbarContent_iy5ki_63",fe="_closeButton_iy5ki_169";const be=({isOpen:o,onClose:n,serialNumber:r,panelId:i,trendlogId:s,monitorId:a,itemData:l,monitorInputs:d})=>{const[c,p]=t.exports.useState(null);return e.exports.jsxs(F,{type:"overlay",separator:!0,open:o,onOpenChange:(e,{open:t})=>{},position:"end",size:"full",className:ge,children:[e.exports.jsx("div",{className:ue,children:c&&e.exports.jsxs("div",{className:he,children:[e.exports.jsx("div",{className:me,children:c}),e.exports.jsx(x,{appearance:"subtle","aria-label":"Close",icon:e.exports.jsx(O,{}),onClick:n,className:fe})]})}),e.exports.jsx(B,{className:xe,children:e.exports.jsx(pe,{serialNumber:r,panelId:i,trendlogId:s,monitorId:a,itemData:l,monitorInputs:d,isDrawerMode:!0,onToolbarRender:p})})]})};var ve="_container_ex7df_7",je="_bladeContentContainer_ex7df_19",ye="_bladeContentWrapper_ex7df_27",Ie="_bladeContent_ex7df_19",Ce="_partContent_ex7df_43",Ne="_toolbar_ex7df_52",Se="_toolbarContainer_ex7df_61",Te="_toolbarButton_ex7df_69",we="_toolbarSeparator_ex7df_108",_e="_searchInputWrapper_ex7df_116",ke="_searchIcon_ex7df_123",Ae="_searchInput_ex7df_116",$e="_dockingBody_ex7df_190",ze="_loading_ex7df_199",Le="_noData_ex7df_200",De="_loadingBar_ex7df_209",Ee="_refreshContainer_ex7df_232",Pe="_refreshIconButton_ex7df_327",Fe="_isRefreshing_ex7df_362",Oe="_rotating_ex7df_378",Be="_gridContainer_ex7df_383",Re="_mainGrid_ex7df_389",Me="_subGrid_ex7df_394",Ue="_subGridHeader_ex7df_407",We="_subGridBody_ex7df_421",He="_inputRow_ex7df_441",Ve="_inputNum_ex7df_454",Ge="_inputValue_ex7df_461",qe="_headerCellSort_ex7df_473",Xe="_sortIconFaded_ex7df_486",Ye="_iconSmall_ex7df_490",Je="_errorNotice_ex7df_494",Ze="_iconError_ex7df_504",Qe="_textError_ex7df_510",Ke="_marginLeft8_ex7df_516",et="_rowSelected_ex7df_520",tt="_rowClickable_ex7df_525",ot="_centerPadding_ex7df_529",nt="_centerPaddingMuted_ex7df_538",rt="_scrollContainerAuto_ex7df_565",it="_fullWidth_ex7df_590";const st=()=>{const{selectedDevice:n,treeData:r,selectDevice:s}=l(),[a,c]=t.exports.useState([]),[p,g]=t.exports.useState(!1),[u,h]=t.exports.useState(null),[m,f]=t.exports.useState(!1),[v,j]=t.exports.useState(new Set),[y,C]=t.exports.useState(!1),N=t.exports.useRef(!1),[S,T]=t.exports.useState(null),[k,A]=t.exports.useState([]),[z,L]=t.exports.useState(!1),[E,P]=t.exports.useState(""),[F,O]=t.exports.useState(null),[B,q]=t.exports.useState("ascending"),[X,re]=t.exports.useState(new Set),ie=t.exports.useCallback((e=>`${e.serialNumber}-${e.trendlogId||e.trendlogIndex}-${e._uniqueIndex}`),[]),[se,ae]=t.exports.useState(!1),[le,de]=t.exports.useState({}),ce=t.exports.useCallback((async e=>{var t,o;if(!n)return;console.log("ðŸ“Š [TrendLogsPage] Opening chart drawer - Fetching trendlog config:",{serialNumber:n.serialNumber,panelId:n.panelId,trendlogId:e.trendlogId,monitorIndex:e.trendlogIndex});const r=e.trendlogIndex||"0";try{const s=`${i}/api/t3_device/devices/${n.serialNumber}/trendlogs/${e.trendlogId}`;console.log("ðŸ“¡ [TrendLogsPage] Fetching trendlog from:",s);const a=await fetch(s);if(!a.ok)throw new Error(`Failed to fetch trendlog: ${a.statusText}`);const l=await a.json();console.log("âœ… [TrendLogsPage] Trendlog received:",l);const d=`${i}/api/t3_device/devices/${n.serialNumber}/table/TRENDLOG_INPUTS`;console.log("ðŸ“¡ [TrendLogsPage] Fetching TRENDLOG_INPUTS from:",d);const c=await fetch(d);let p=[],x=[];if(c.ok){const t=await c.json();if(console.log("âœ… [TrendLogsPage] Raw inputs data received:",t),t.data&&Array.isArray(t.data)){const o=t.data.filter((t=>t.trendlogId===e.trendlogId||t.Trendlog_ID===e.trendlogId));console.log("âœ… [TrendLogsPage] Filtered inputs for this trendlog:",o),o.length>0&&(p=o.map((e=>({panel:e.pointPanel||e.point_panel?parseInt(e.pointPanel||e.point_panel):n.panelId,point_number:parseInt(e.pointIndex||e.point_index||"1")-1,point_type:"INPUT"===(e.pointType||e.point_type)?0:"OUTPUT"===(e.pointType||e.point_type)?1:2,network:0,sub_panel:0}))),x=p.map((()=>({digital_analog:0,units:""}))))}}else console.warn("âš ï¸ [TrendLogsPage] Failed to fetch inputs:",c.status,c.statusText);const g={title:(null==(t=null==l?void 0:l.trendlog)?void 0:t.trendlogLabel)||e.trendlogLabel||`Monitor ${r}`,t3Entry:{id:`MON${r}`,pid:n.panelId||1,label:(null==(o=null==l?void 0:l.trendlog)?void 0:o.trendlogLabel)||e.trendlogLabel||`MON${r}`,command:`${n.panelId||1}MON${r}`,input:p.length>0?p:void 0,range:x.length>0?x:void 0}};console.log("âœ… [TrendLogsPage] Opening drawer with itemData:",{title:g.title,hasInputConfig:p.length>0,inputCount:p.length,rangeCount:x.length}),de({serialNumber:n.serialNumber,panelId:n.panelId||1,trendlogId:e.trendlogId||"0",monitorId:r,itemData:g,monitorInputs:k}),ae(!0)}catch(s){console.error("âŒ [TrendLogsPage] Failed to fetch trendlog config:",s);const t={title:e.trendlogLabel||`Monitor ${r}`,t3Entry:{id:`MON${r}`,pid:n.panelId||1,label:e.trendlogLabel||`MON${r}`,command:`${n.panelId||1}MON${r}`}};de({serialNumber:n.serialNumber,panelId:n.panelId||1,trendlogId:e.trendlogId||"0",monitorId:r,itemData:t,monitorInputs:k}),ae(!0)}}),[n,k]);t.exports.useEffect((()=>{console.log("ðŸ” [TrendLogsPage] NEW DataGrid version loaded!",{selectedDevice:null==n?void 0:n.serialNumber,trendLogsCount:a.length})}),[n,a.length]),t.exports.useEffect((()=>{if(!n&&r.length>0){const e=t=>{for(const o of t){if(o.data)return o;if(o.children&&o.children.length>0){const t=e(o.children);if(t)return t}}return null},t=e(r);(null==t?void 0:t.data)&&s(t.data)}}),[n,r,s]);const pe=t.exports.useCallback((async()=>{if(!n)return c([]),T(null),void A([]);g(!0),h(null);try{const e=`${i}/api/t3_device/devices/${n.serialNumber}/trendlogs`,t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch trendlogs: ${t.statusText}`);const o=(await t.json()).trendlogs||[],r=o.reduce(((e,t)=>{const o=t.trendlogId||t.trendlogIndex;return e[o]=(e[o]||0)+1,e}),{}),s=Object.entries(r).filter((([e,t])=>t>1));s.length>0&&(console.warn("âš ï¸ [TrendLogsPage] Duplicate trendlogIds found:",s),console.log("ðŸ“Š [TrendLogsPage] Full trendlog data:",o));const a=o.map(((e,t)=>({...e,_uniqueIndex:t})));if(c(a),a.length>0){console.log("ðŸŽ¯ [TrendLogsPage] Auto-selecting first trendlog:",a[0]);const e=a[0];T(e);const t=`${e.serialNumber}-${e.trendlogId||e.trendlogIndex}-${e._uniqueIndex}`;re(new Set([t])),e.trendlogId&&await xe(e)}}catch(e){const t=e instanceof Error?e.message:"Failed to load trendlogs";h(t),console.error("Error fetching trendlogs:",e)}finally{g(!1)}}),[n]),xe=async e=>{if(n&&e.trendlogId){L(!0);try{const t=`${i}/api/t3_device/devices/${n.serialNumber}/table/TRENDLOG_INPUTS`,o=await fetch(t);if(o.ok){const t=((await o.json()).data||[]).filter((t=>{const o=t.trendlogId===e.trendlogId||t.Trendlog_ID===e.trendlogId,n="MAIN"===t.viewType||"MAIN"===t.view_type||"VIEW"===t.viewType||"VIEW"===t.view_type||!t.viewType;return o&&n})),n=new Map;t.forEach((e=>{const t=`${e.Point_Type||e.pointType}-${e.Point_Index||e.pointIndex}`;if(n.has(t)){const o=n.get(t),r=o.view_type||o.viewType;"MAIN"===(e.view_type||e.viewType)&&"MAIN"!==r&&n.set(t,e)}else n.set(t,e)}));const r=Array.from(n.values()).map((e=>({id:e.id,serialNumber:e.SerialNumber||e.serialNumber,panelId:e.PanelId||e.panelId,trendlogId:e.Trendlog_ID||e.trendlogId,pointType:e.Point_Type||e.pointType,pointIndex:e.Point_Index||e.pointIndex,pointPanel:e.Point_Panel||e.pointPanel,pointLabel:e.Point_Label||e.pointLabel,status:e.Status||e.status,viewType:e.view_type||e.viewType,viewNumber:e.view_number||e.viewNumber,isSelected:e.is_selected||e.isSelected})));A(r)}else A([])}catch(t){console.error("âŒ [TrendLogsPage] Error loading inputs:",t),A([])}finally{L(!1)}}else A([])},ge=t.exports.useCallback((async e=>{if(!n||!e.trendlogId)return console.log("âš ï¸ [TrendLogsPage] Missing device or trendlog ID"),T(e),void A([]);console.log("ðŸ“¡ [TrendLogsPage] Loading inputs for trendlog:",e.trendlogId),T(e),await xe(e)}),[n]);t.exports.useEffect((()=>{pe()}),[pe]),t.exports.useEffect((()=>{if(p||!n||y||N.current)return;(async()=>{N.current=!0;try{console.log("[TrendLogsPage] Auto-refreshing from device...");const e=await ne.refreshAllFromDevice(n.serialNumber);console.log("[TrendLogsPage] Refresh response:",e),await pe(),C(!0)}catch(e){console.error("[TrendLogsPage] Auto-refresh failed:",e),C(!0)}})()}),[p,n,y,pe]);const ue=t.exports.useCallback((async e=>{console.log("ðŸ”µ [TrendLogsPage] handleMonitorSelect called with:",e),console.log("ðŸ”µ [TrendLogsPage] VERSION: 2025-12-12-v2 - Using NEW input loading code");const t=ie(e);re(new Set([t])),await ge(e)}),[ge,ie]),he=e=>{F===e?q("ascending"===B?"descending":"ascending"):(O(e),q("ascending"))},me=o.useMemo((()=>0===a.length?Array(10).fill(null).map(((e,t)=>({serialNumber:(null==n?void 0:n.serialNumber)||0,trendlogId:"",trendlogIndex:"",trendlogLabel:"",intervalSeconds:void 0,bufferSize:void 0,autoManual:"",status:"",_uniqueIndex:t,panelId:null==n?void 0:n.panelId}))):a),[a,n]),fe=e=>!e.trendlogId&&!e.trendlogIndex&&0===a.length,st=[Y({columnId:"trendlogId",compare:(e,t)=>Number(e.trendlogId||e.trendlogIndex||0)-Number(t.trendlogId||t.trendlogIndex||0),renderHeaderCell:()=>e.exports.jsxs("div",{className:qe,onClick:()=>he("trendlogId"),children:[e.exports.jsx("span",{children:"Trendlog ID"}),"trendlogId"===F?"ascending"===B?e.exports.jsx(W,{}):e.exports.jsx(H,{}):e.exports.jsx(V,{className:Xe})]}),renderCell:t=>{const o=t.trendlogId||t.trendlogIndex||"",r=v.has(o);return e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsxs("div",{className:Ee,children:[e.exports.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(!n)return;const t=parseInt(e,10);if(isNaN(t))console.error("[TrendLogsPage] Invalid trendlog index:",e);else{j((t=>new Set(t).add(e)));try{console.log(`[TrendLogsPage] Refreshing trendlog ${t} from device...`);const o=await ne.refreshSingleFromDevice(n.serialNumber,t);console.log("[TrendLogsPage] Refresh response:",o),await pe()}catch(o){console.error(`[TrendLogsPage] Failed to refresh trendlog ${t}:`,o)}finally{j((t=>{const o=new Set(t);return o.delete(e),o}))}}})(o)},className:`${Pe} ${r?Fe:""}`,title:"Refresh this trendlog from device",disabled:r,children:e.exports.jsx(R,{className:`${Ye} ${r?Oe:""}`})}),e.exports.jsx(d,{size:200,weight:"regular",children:o||"---"})]})})}}),Y({columnId:"trendlogLabel",compare:(e,t)=>(e.trendlogLabel||"").localeCompare(t.trendlogLabel||""),renderHeaderCell:()=>e.exports.jsxs("div",{className:qe,onClick:()=>he("trendlogLabel"),children:[e.exports.jsx("span",{children:"Label"}),"trendlogLabel"===F?"ascending"===B?e.exports.jsx(W,{}):e.exports.jsx(H,{}):e.exports.jsx(V,{className:Xe})]}),renderCell:t=>e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsx(d,{size:200,children:t.trendlogLabel||"---"})})}),Y({columnId:"intervalSeconds",renderHeaderCell:()=>e.exports.jsx("span",{children:"Interval (sec)"}),renderCell:t=>{var o;return e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsx(d,{size:200,children:null!=(o=t.intervalSeconds)?o:"---"})})}}),Y({columnId:"bufferSize",renderHeaderCell:()=>e.exports.jsx("span",{children:"Buffer Size"}),renderCell:t=>{var o;return e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsx(d,{size:200,children:null!=(o=t.bufferSize)?o:"---"})})},compare:(e,t)=>(e.bufferSize||0)-(t.bufferSize||0)}),Y({columnId:"autoManual",renderHeaderCell:()=>e.exports.jsx("span",{children:"Auto/Manual"}),renderCell:t=>e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsx(_,{appearance:"1"===t.autoManual?"filled":"outline",color:"informative",children:"1"===t.autoManual?"Auto":"0"===t.autoManual?"Manual":"---"})}),compare:(e,t)=>(e.autoManual||"").localeCompare(t.autoManual||"")}),Y({columnId:"status",renderHeaderCell:()=>e.exports.jsx("span",{children:"Status"}),renderCell:t=>e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsx(_,{appearance:"tint",color:"ON"===t.status?"success":"subtle",children:t.status||"OFF"})}),compare:(e,t)=>(e.status||"").localeCompare(t.status||"")}),Y({columnId:"actions",renderHeaderCell:()=>e.exports.jsx("span",{children:"Actions"}),renderCell:t=>e.exports.jsx(oe,{children:!fe(t)&&e.exports.jsx(x,{size:"small",icon:e.exports.jsx(G,{className:Ye}),onClick:()=>ce(t),title:"View trend chart for this trendlog",children:"View Graphic"})})})];return n?p?(console.log("â³ [TrendLogsPage] Loading state active"),e.exports.jsx("div",{className:ve,children:e.exports.jsx("div",{className:ze,children:e.exports.jsx(w,{size:"medium",label:"Loading trend logs..."})})})):(console.log("âœ… [TrendLogsPage] Rendering full page with toolbar",{trendLogsCount:a.length,refreshing:m,selectedDevice:n.serialNumber}),e.exports.jsxs("div",{className:ve,children:[e.exports.jsx("div",{className:je,children:e.exports.jsx("div",{className:ye,children:e.exports.jsx("div",{className:Ie,children:e.exports.jsxs("div",{className:Ce,children:[u&&e.exports.jsxs("div",{className:Je,children:[e.exports.jsx($,{className:Ze}),e.exports.jsx(d,{className:Qe,children:u})]}),n&&e.exports.jsx("div",{className:Ne,children:e.exports.jsxs("div",{className:Se,children:[e.exports.jsxs("button",{className:Te,onClick:async()=>{if(n){f(!0);try{console.log("[TrendLogsPage] Refreshing all trendlogs from device...");const e=await ne.refreshAllFromDevice(n.serialNumber);console.log("[TrendLogsPage] Refresh response:",e),await pe()}catch(e){console.error("[TrendLogsPage] Failed to refresh from device:",e),h(e instanceof Error?e.message:"Failed to refresh from device")}finally{f(!1)}}},disabled:m,title:"Refresh all trendlogs from device","aria-label":"Refresh from Device",children:[e.exports.jsx(R,{}),e.exports.jsx("span",{children:m?"Refreshing...":"Refresh from Device"})]}),e.exports.jsx("div",{className:we}),e.exports.jsxs("button",{className:Te,onClick:()=>{console.log("Export trendlogs to CSV")},disabled:!n,title:"Export trendlogs to CSV","aria-label":"Export to CSV",children:[e.exports.jsx(I,{}),e.exports.jsx("span",{children:"Export"})]}),e.exports.jsxs("button",{className:Te,onClick:()=>{console.log("Settings clicked")},disabled:!n,title:"Configure trendlog settings","aria-label":"Settings",children:[e.exports.jsx(b,{}),e.exports.jsx("span",{children:"Settings"})]}),e.exports.jsxs("div",{className:_e,children:[e.exports.jsx(M,{className:ke}),e.exports.jsx("input",{className:Ae,type:"text",placeholder:"Search trendlogs...",value:E,onChange:e=>{P(e.target.value)},spellCheck:"false",role:"searchbox","aria-label":"Search trendlogs"})]}),e.exports.jsx(D,{content:`Showing trend log monitors for ${n.nameShowOnTree||n.productName} (SN: ${n.serialNumber}). This table displays all configured trendlog/monitor data collection points. Click the refresh icon next to each trendlog to sync from the device.`,relationship:"description",children:e.exports.jsx("button",{className:`${Te} ${Ke}`,title:"Information","aria-label":"Information about this page",children:e.exports.jsx(U,{})})})]})}),e.exports.jsxs("div",{className:$e,children:[p&&0===a.length&&e.exports.jsxs("div",{className:De,children:[e.exports.jsx(w,{size:"tiny"}),e.exports.jsx(d,{size:200,weight:"regular",children:"Loading trendlogs..."})]}),!n&&!p&&e.exports.jsx("div",{className:Le,children:e.exports.jsxs("div",{style:{textAlign:"center"},children:[e.exports.jsx(d,{size:400,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(d,{size:200,children:"Please select a device from the tree to view trendlogs"})]})}),n&&!p&&!u&&e.exports.jsxs("div",{className:Be,children:[e.exports.jsx("div",{className:`${Re} ${rt}`,children:e.exports.jsxs(J,{items:me,columns:st,sortable:!0,resizableColumns:!0,selectionMode:"single",selectedItems:X,onSelectionChange:(e,t)=>{re(t.selectedItems)},className:it,columnSizingOptions:{__selection__:{idealWidth:"5%",minWidth:44},trendlogId:{idealWidth:"12%",minWidth:95},trendlogLabel:{idealWidth:"26%",minWidth:150},intervalSeconds:{idealWidth:"12%",minWidth:80},bufferSize:{idealWidth:"10%",minWidth:90},autoManual:{idealWidth:"12%",minWidth:90},status:{idealWidth:"8%",minWidth:70},actions:{idealWidth:"15%",minWidth:120}},getRowId:e=>`${e.serialNumber}-${e.trendlogId||e.trendlogIndex}-${e._uniqueIndex}`,children:[e.exports.jsx(Z,{children:e.exports.jsx(Q,{children:({renderHeaderCell:t})=>e.exports.jsx(K,{children:t()})})}),e.exports.jsx(ee,{children:({item:t,rowId:o})=>e.exports.jsx(Q,{onClick:()=>ue(t),className:(null==S?void 0:S.trendlogId)===t.trendlogId?et:tt,children:({renderCell:o})=>e.exports.jsx(te,{children:o(t)})},o)})]},"trendlogs-grid-v5")}),e.exports.jsxs("div",{className:Me,children:[e.exports.jsxs("div",{className:Ue,children:[e.exports.jsxs(d,{size:300,weight:"semibold",children:["Monitor Inputs ",z&&e.exports.jsx(w,{size:"tiny",className:Ke})]}),k.length>0&&e.exports.jsxs(_,{appearance:"filled",color:"informative",size:"small",children:[k.length," inputs"]})]}),e.exports.jsx("div",{className:We,children:z?e.exports.jsx("div",{className:ot,children:e.exports.jsx(w,{size:"small",label:"Loading inputs..."})}):k.length>0?k.map(((t,o)=>{const n="IN"===t.pointType?"IN":"OUT"===t.pointType?"OUT":"VAR"===t.pointType?"VAR":t.pointType,r=t.pointLabel||`${n}${t.pointIndex}`;return e.exports.jsxs("div",{className:He,children:[e.exports.jsx("div",{className:Ve,children:o+1}),e.exports.jsx(D,{content:`${n}${t.pointIndex}: ${t.pointLabel||"No label"}`,relationship:"label",children:e.exports.jsx("div",{className:Ge,children:r})})]},`${t.pointType}-${t.pointIndex}-${o}`)})):e.exports.jsx("div",{className:nt,children:e.exports.jsx(d,{size:200,children:"No inputs configured"})})})]})]})]})]})})})}),e.exports.jsx(be,{isOpen:se,onClose:()=>ae(!1),serialNumber:le.serialNumber,panelId:le.panelId,trendlogId:le.trendlogId,monitorId:le.monitorId,itemData:le.itemData,monitorInputs:le.monitorInputs})]})):(console.log("âš ï¸ [TrendLogsPage] No device selected - showing empty state"),e.exports.jsx("div",{className:ve,children:e.exports.jsx("div",{className:Le,children:e.exports.jsxs("div",{style:{textAlign:"center"},children:[e.exports.jsx(d,{size:400,weight:"semibold",children:"No device selected"}),e.exports.jsx("br",{}),e.exports.jsx(d,{size:200,children:"Please select a device from the tree to view trendlogs"})]})})}))};var at=Object.freeze(Object.defineProperty({__proto__:null,TrendLogsPage:st},Symbol.toStringTag,{value:"Module"}));export{pe as T,st as a,at as b};

import{bE as t,h as e,aZ as o,bi as n,n as l,aT as i,w as a,o as r,f as s,g as c,aS as u,ak as h,bF as d,br as m,ad as f}from"./index.3bd6c859.js";function v(){if(void 0!==window.getSelection){const e=window.getSelection();void 0!==e.empty?e.empty():void 0!==e.removeAllRanges&&(e.removeAllRanges(),!0!==t.is.mobile&&e.addRange(document.createRange()))}else void 0!==document.selection&&document.selection.empty()}const g={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},p={...g,contextMenu:Boolean};function x({showing:t,avoidEmit:h,configureAnchorEl:d}){const{props:m,proxy:f,emit:g}=c(),p=e(null);let x=null;function b(t){return null!==p.value&&(void 0===t||void 0===t.touches||t.touches.length<=1)}const w={};function y(){u(w,"anchor")}function E(){if(!1===m.target||""===m.target||null===f.$el.parentNode)p.value=null;else if(!0===m.target)!function(t){for(p.value=t;p.value.classList.contains("q-anchor--skip");)p.value=p.value.parentNode;d()}(f.$el.parentNode);else{let e=m.target;if("string"==typeof m.target)try{e=document.querySelector(m.target)}catch(t){e=void 0}null!=e?(p.value=e.$el||e,d()):(p.value=null,console.error(`Anchor: target "${m.target}" not found`))}}return void 0===d&&(Object.assign(w,{hide(t){f.hide(t)},toggle(t){f.toggle(t),t.qAnchorHandled=!0},toggleKey(t){!0===o(t,13)&&w.toggle(t)},contextClick(t){f.hide(t),n(t),l((()=>{f.show(t),t.qAnchorHandled=!0}))},prevent:n,mobileTouch(t){if(w.mobileCleanup(t),!0!==b(t))return;f.hide(t),p.value.classList.add("non-selectable");const e=t.target;i(w,"anchor",[[e,"touchmove","mobileCleanup","passive"],[e,"touchend","mobileCleanup","passive"],[e,"touchcancel","mobileCleanup","passive"],[p.value,"contextmenu","prevent","notPassive"]]),x=setTimeout((()=>{x=null,f.show(t),t.qAnchorHandled=!0}),300)},mobileCleanup(e){p.value.classList.remove("non-selectable"),null!==x&&(clearTimeout(x),x=null),!0===t.value&&void 0!==e&&v()}}),d=function(t=m.contextMenu){if(!0===m.noParentEvent||null===p.value)return;let e;e=!0===t?!0===f.$q.platform.is.mobile?[[p.value,"touchstart","mobileTouch","passive"]]:[[p.value,"mousedown","hide","passive"],[p.value,"contextmenu","contextClick","notPassive"]]:[[p.value,"click","toggle","passive"],[p.value,"keyup","toggleKey","passive"]],i(w,"anchor",e)}),a((()=>m.contextMenu),(t=>{null!==p.value&&(y(),d(t))})),a((()=>m.target),(()=>{null!==p.value&&y(),E()})),a((()=>m.noParentEvent),(t=>{null!==p.value&&(!0===t?y():d())})),r((()=>{E(),!0!==h&&!0===m.modelValue&&null===p.value&&g("update:modelValue",!1)})),s((()=>{null!==x&&clearTimeout(x),y()})),{anchorEl:p,canShow:b,anchorEvents:w}}function b(t,o){const n=e(null);let l;function i(t,e){const o=(void 0!==e?"add":"remove")+"EventListener",n=void 0!==e?e:l;t!==window&&t[o]("scroll",n,h.passive),window[o]("scroll",n,h.passive),l=e}function r(){null!==n.value&&(i(n.value),n.value=null)}const c=a((()=>t.noParentEvent),(()=>{null!==n.value&&(r(),o())}));return s(c),{localScrollTarget:n,unconfigureScrollTarget:r,changeScrollEvent:i}}const{notPassiveCapture:w}=h,y=[];function E(t){const e=t.target;if(void 0===e||8===e.nodeType||!0===e.classList.contains("no-pointer-events"))return;let o=d.length-1;for(;o>=0;){const t=d[o].$;if("QTooltip"!==t.type.name){if("QDialog"!==t.type.name)break;if(!0!==t.props.seamless)return;o--}else o--}for(let n=y.length-1;n>=0;n--){const o=y[n];if(null!==o.anchorEl.value&&!1!==o.anchorEl.value.contains(e)||e!==document.body&&(null===o.innerRef.value||!1!==o.innerRef.value.contains(e)))return;t.qClickOutside=!0,o.onClickOutside(t)}}function H(t){y.push(t),1===y.length&&(document.addEventListener("mousedown",E,w),document.addEventListener("touchstart",E,w))}function W(t){const e=y.findIndex((e=>e===t));-1!==e&&(y.splice(e,1),0===y.length&&(document.removeEventListener("mousedown",E,w),document.removeEventListener("touchstart",E,w)))}let M,T;function L(t){const e=t.split(" ");return 2===e.length&&(!0!==["top","center","bottom"].includes(e[0])?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):!0===["left","middle","right","start","end"].includes(e[1])||(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1))}function z(t){return!t||2===t.length&&("number"==typeof t[0]&&"number"==typeof t[1])}const C={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};function S(t,e){const o=t.split(" ");return{vertical:o[0],horizontal:C[`${o[1]}#${!0===e?"rtl":"ltr"}`]}}function $(t,e,o,n){return{top:t[o.vertical]-e[n.vertical],left:t[o.horizontal]-e[n.horizontal]}}function k(t,e=0){if(null===t.targetEl||null===t.anchorEl||e>5)return;if(0===t.targetEl.offsetHeight||0===t.targetEl.offsetWidth)return void setTimeout((()=>{k(t,e+1)}),10);const{targetEl:o,offset:n,anchorEl:l,anchorOrigin:i,selfOrigin:a,absoluteOffset:r,fit:s,cover:c,maxHeight:u,maxWidth:h}=t;if(!0===m.is.ios&&void 0!==window.visualViewport){const t=document.body.style,{offsetLeft:e,offsetTop:o}=window.visualViewport;e!==M&&(t.setProperty("--q-pe-left",e+"px"),M=e),o!==T&&(t.setProperty("--q-pe-top",o+"px"),T=o)}const{scrollLeft:d,scrollTop:f}=o,v=void 0===r?function(t,e){let{top:o,left:n,right:l,bottom:i,width:a,height:r}=t.getBoundingClientRect();return void 0!==e&&(o-=e[1],n-=e[0],i+=e[1],l+=e[0],a+=e[0],r+=e[1]),{top:o,bottom:i,height:r,left:n,right:l,width:a,middle:n+(l-n)/2,center:o+(i-o)/2}}(l,!0===c?[0,0]:n):function(t,e,o){let{top:n,left:l}=t.getBoundingClientRect();return n+=e.top,l+=e.left,void 0!==o&&(n+=o[1],l+=o[0]),{top:n,bottom:n+1,height:1,left:l,right:l+1,width:1,middle:l,center:n}}(l,r,n);Object.assign(o.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:h,maxHeight:u,visibility:"visible"});const{offsetWidth:g,offsetHeight:p}=o,{elWidth:x,elHeight:b}=!0===s||!0===c?{elWidth:Math.max(v.width,g),elHeight:!0===c?Math.max(v.height,p):p}:{elWidth:g,elHeight:p};let w={maxWidth:h,maxHeight:u};!0!==s&&!0!==c||(w.minWidth=v.width+"px",!0===c&&(w.minHeight=v.height+"px")),Object.assign(o.style,w);const y={top:0,center:(H=b)/2,bottom:H,left:0,middle:(E=x)/2,right:E};var E,H;let W=$(v,y,i,a);if(void 0===r||void 0===n)q(W,v,y,i,a);else{const{top:t,left:e}=W;q(W,v,y,i,a);let o=!1;if(W.top!==t){o=!0;const t=2*n[1];v.center=v.top-=t,v.bottom-=t+2}if(W.left!==e){o=!0;const t=2*n[0];v.middle=v.left-=t,v.right-=t+2}!0===o&&(W=$(v,y,i,a),q(W,v,y,i,a))}w={top:W.top+"px",left:W.left+"px"},void 0!==W.maxHeight&&(w.maxHeight=W.maxHeight+"px",v.height>W.maxHeight&&(w.minHeight=w.maxHeight)),void 0!==W.maxWidth&&(w.maxWidth=W.maxWidth+"px",v.width>W.maxWidth&&(w.minWidth=w.maxWidth)),Object.assign(o.style,w),o.scrollTop!==f&&(o.scrollTop=f),o.scrollLeft!==d&&(o.scrollLeft=d)}function q(t,e,o,n,l){const i=o.bottom,a=o.right,r=f(),s=window.innerHeight-r,c=document.body.clientWidth;if(t.top<0||t.top+i>s)if("center"===l.vertical)t.top=e[n.vertical]>s/2?Math.max(0,s-i):0,t.maxHeight=Math.min(i,s);else if(e[n.vertical]>s/2){const o=Math.min(s,"center"===n.vertical?e.center:n.vertical===l.vertical?e.bottom:e.top);t.maxHeight=Math.min(i,o),t.top=Math.max(0,o-i)}else t.top=Math.max(0,"center"===n.vertical?e.center:n.vertical===l.vertical?e.top:e.bottom),t.maxHeight=Math.min(i,s-t.top);if(t.left<0||t.left+a>c)if(t.maxWidth=Math.min(a,c),"middle"===l.horizontal)t.left=e[n.horizontal]>c/2?Math.max(0,c-a):0;else if(e[n.horizontal]>c/2){const o=Math.min(c,"middle"===n.horizontal?e.middle:n.horizontal===l.horizontal?e.right:e.left);t.maxWidth=Math.min(a,o),t.left=Math.max(0,o-t.maxWidth)}else t.left=Math.max(0,"middle"===n.horizontal?e.middle:n.horizontal===l.horizontal?e.left:e.right),t.maxWidth=Math.min(a,c-t.left)}["left","middle","right"].forEach((t=>{C[`${t}#ltr`]=t,C[`${t}#rtl`]=t}));export{z as a,b,x as c,v as d,H as e,p as f,S as p,W as r,k as s,g as u,L as v};

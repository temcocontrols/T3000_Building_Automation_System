import{bF as t,h as e,aZ as n,bi as o,n as l,aT as i,w as a,o as r,f as s,g as c,aS as u,ak as h,bG as d,br as m,ad as f}from"./index.2479820c.js";function v(){if(void 0!==window.getSelection){const e=window.getSelection();void 0!==e.empty?e.empty():void 0!==e.removeAllRanges&&(e.removeAllRanges(),!0!==t.is.mobile&&e.addRange(document.createRange()))}else void 0!==document.selection&&document.selection.empty()}const g={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},p={...g,contextMenu:Boolean};function x({showing:t,avoidEmit:h,configureAnchorEl:d}){const{props:m,proxy:f,emit:g}=c(),p=e(null);let x=null;function b(t){return null!==p.value&&(void 0===t||void 0===t.touches||t.touches.length<=1)}const w={};function y(){u(w,"anchor")}function E(){if(!1===m.target||""===m.target||null===f.$el.parentNode)p.value=null;else if(!0===m.target)!function(t){for(p.value=t;p.value.classList.contains("q-anchor--skip");)p.value=p.value.parentNode;d()}(f.$el.parentNode);else{let e=m.target;if("string"==typeof m.target)try{e=document.querySelector(m.target)}catch(t){e=void 0}null!=e?(p.value=e.$el||e,d()):p.value=null}}return void 0===d&&(Object.assign(w,{hide(t){f.hide(t)},toggle(t){f.toggle(t),t.qAnchorHandled=!0},toggleKey(t){!0===n(t,13)&&w.toggle(t)},contextClick(t){f.hide(t),o(t),l((()=>{f.show(t),t.qAnchorHandled=!0}))},prevent:o,mobileTouch(t){if(w.mobileCleanup(t),!0!==b(t))return;f.hide(t),p.value.classList.add("non-selectable");const e=t.target;i(w,"anchor",[[e,"touchmove","mobileCleanup","passive"],[e,"touchend","mobileCleanup","passive"],[e,"touchcancel","mobileCleanup","passive"],[p.value,"contextmenu","prevent","notPassive"]]),x=setTimeout((()=>{x=null,f.show(t),t.qAnchorHandled=!0}),300)},mobileCleanup(e){p.value.classList.remove("non-selectable"),null!==x&&(clearTimeout(x),x=null),!0===t.value&&void 0!==e&&v()}}),d=function(t=m.contextMenu){if(!0===m.noParentEvent||null===p.value)return;let e;e=!0===t?!0===f.$q.platform.is.mobile?[[p.value,"touchstart","mobileTouch","passive"]]:[[p.value,"mousedown","hide","passive"],[p.value,"contextmenu","contextClick","notPassive"]]:[[p.value,"click","toggle","passive"],[p.value,"keyup","toggleKey","passive"]],i(w,"anchor",e)}),a((()=>m.contextMenu),(t=>{null!==p.value&&(y(),d(t))})),a((()=>m.target),(()=>{null!==p.value&&y(),E()})),a((()=>m.noParentEvent),(t=>{null!==p.value&&(!0===t?y():d())})),r((()=>{E(),!0!==h&&!0===m.modelValue&&null===p.value&&g("update:modelValue",!1)})),s((()=>{null!==x&&clearTimeout(x),y()})),{anchorEl:p,canShow:b,anchorEvents:w}}function b(t,n){const o=e(null);let l;function i(t,e){const n=(void 0!==e?"add":"remove")+"EventListener",o=void 0!==e?e:l;t!==window&&t[n]("scroll",o,h.passive),window[n]("scroll",o,h.passive),l=e}function r(){null!==o.value&&(i(o.value),o.value=null)}const c=a((()=>t.noParentEvent),(()=>{null!==o.value&&(r(),n())}));return s(c),{localScrollTarget:o,unconfigureScrollTarget:r,changeScrollEvent:i}}const{notPassiveCapture:w}=h,y=[];function E(t){const e=t.target;if(void 0===e||8===e.nodeType||!0===e.classList.contains("no-pointer-events"))return;let n=d.length-1;for(;n>=0;){const t=d[n].$;if("QTooltip"!==t.type.name){if("QDialog"!==t.type.name)break;if(!0!==t.props.seamless)return;n--}else n--}for(let o=y.length-1;o>=0;o--){const n=y[o];if(null!==n.anchorEl.value&&!1!==n.anchorEl.value.contains(e)||e!==document.body&&(null===n.innerRef.value||!1!==n.innerRef.value.contains(e)))return;t.qClickOutside=!0,n.onClickOutside(t)}}function H(t){y.push(t),1===y.length&&(document.addEventListener("mousedown",E,w),document.addEventListener("touchstart",E,w))}function W(t){const e=y.findIndex((e=>e===t));-1!==e&&(y.splice(e,1),0===y.length&&(document.removeEventListener("mousedown",E,w),document.removeEventListener("touchstart",E,w)))}let M,T;function L(t){const e=t.split(" ");return 2===e.length&&(!0===["top","center","bottom"].includes(e[0])&&!0===["left","middle","right","start","end"].includes(e[1]))}function z(t){return!t||2===t.length&&("number"==typeof t[0]&&"number"==typeof t[1])}const C={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};function k(t,e){const n=t.split(" ");return{vertical:n[0],horizontal:C[`${n[1]}#${!0===e?"rtl":"ltr"}`]}}function q(t,e,n,o){return{top:t[n.vertical]-e[o.vertical],left:t[n.horizontal]-e[o.horizontal]}}function O(t,e=0){if(null===t.targetEl||null===t.anchorEl||e>5)return;if(0===t.targetEl.offsetHeight||0===t.targetEl.offsetWidth)return void setTimeout((()=>{O(t,e+1)}),10);const{targetEl:n,offset:o,anchorEl:l,anchorOrigin:i,selfOrigin:a,absoluteOffset:r,fit:s,cover:c,maxHeight:u,maxWidth:h}=t;if(!0===m.is.ios&&void 0!==window.visualViewport){const t=document.body.style,{offsetLeft:e,offsetTop:n}=window.visualViewport;e!==M&&(t.setProperty("--q-pe-left",e+"px"),M=e),n!==T&&(t.setProperty("--q-pe-top",n+"px"),T=n)}const{scrollLeft:d,scrollTop:f}=n,v=void 0===r?function(t,e){let{top:n,left:o,right:l,bottom:i,width:a,height:r}=t.getBoundingClientRect();return void 0!==e&&(n-=e[1],o-=e[0],i+=e[1],l+=e[0],a+=e[0],r+=e[1]),{top:n,bottom:i,height:r,left:o,right:l,width:a,middle:o+(l-o)/2,center:n+(i-n)/2}}(l,!0===c?[0,0]:o):function(t,e,n){let{top:o,left:l}=t.getBoundingClientRect();return o+=e.top,l+=e.left,void 0!==n&&(o+=n[1],l+=n[0]),{top:o,bottom:o+1,height:1,left:l,right:l+1,width:1,middle:l,center:o}}(l,r,o);Object.assign(n.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:h,maxHeight:u,visibility:"visible"});const{offsetWidth:g,offsetHeight:p}=n,{elWidth:x,elHeight:b}=!0===s||!0===c?{elWidth:Math.max(v.width,g),elHeight:!0===c?Math.max(v.height,p):p}:{elWidth:g,elHeight:p};let w={maxWidth:h,maxHeight:u};!0!==s&&!0!==c||(w.minWidth=v.width+"px",!0===c&&(w.minHeight=v.height+"px")),Object.assign(n.style,w);const y={top:0,center:(H=b)/2,bottom:H,left:0,middle:(E=x)/2,right:E};var E,H;let W=q(v,y,i,a);if(void 0===r||void 0===o)P(W,v,y,i,a);else{const{top:t,left:e}=W;P(W,v,y,i,a);let n=!1;if(W.top!==t){n=!0;const t=2*o[1];v.center=v.top-=t,v.bottom-=t+2}if(W.left!==e){n=!0;const t=2*o[0];v.middle=v.left-=t,v.right-=t+2}!0===n&&(W=q(v,y,i,a),P(W,v,y,i,a))}w={top:W.top+"px",left:W.left+"px"},void 0!==W.maxHeight&&(w.maxHeight=W.maxHeight+"px",v.height>W.maxHeight&&(w.minHeight=w.maxHeight)),void 0!==W.maxWidth&&(w.maxWidth=W.maxWidth+"px",v.width>W.maxWidth&&(w.minWidth=w.maxWidth)),Object.assign(n.style,w),n.scrollTop!==f&&(n.scrollTop=f),n.scrollLeft!==d&&(n.scrollLeft=d)}function P(t,e,n,o,l){const i=n.bottom,a=n.right,r=f(),s=window.innerHeight-r,c=document.body.clientWidth;if(t.top<0||t.top+i>s)if("center"===l.vertical)t.top=e[o.vertical]>s/2?Math.max(0,s-i):0,t.maxHeight=Math.min(i,s);else if(e[o.vertical]>s/2){const n=Math.min(s,"center"===o.vertical?e.center:o.vertical===l.vertical?e.bottom:e.top);t.maxHeight=Math.min(i,n),t.top=Math.max(0,n-i)}else t.top=Math.max(0,"center"===o.vertical?e.center:o.vertical===l.vertical?e.top:e.bottom),t.maxHeight=Math.min(i,s-t.top);if(t.left<0||t.left+a>c)if(t.maxWidth=Math.min(a,c),"middle"===l.horizontal)t.left=e[o.horizontal]>c/2?Math.max(0,c-a):0;else if(e[o.horizontal]>c/2){const n=Math.min(c,"middle"===o.horizontal?e.middle:o.horizontal===l.horizontal?e.right:e.left);t.maxWidth=Math.min(a,n),t.left=Math.max(0,n-t.maxWidth)}else t.left=Math.max(0,"middle"===o.horizontal?e.middle:o.horizontal===l.horizontal?e.left:e.right),t.maxWidth=Math.min(a,c-t.left)}["left","middle","right"].forEach((t=>{C[`${t}#ltr`]=t,C[`${t}#rtl`]=t}));export{z as a,b,x as c,v as d,H as e,p as f,k as p,W as r,O as s,g as u,L as v};
